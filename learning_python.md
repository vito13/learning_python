---
é˜…è¯»è¿›åº¦
Pythonç¼–ç¨‹ï¼šä»å…¥é—¨åˆ°å®è·µï¼ˆç¬¬2ç‰ˆï¼‰		ç»§ç»­ç¬¬12ç« ï¼Œåé¢éƒ½æ˜¯ä¸œæ‹¼è¥¿å‡‘å…ˆä¸ç”¨çœ‹äº†

pythonåŸºç¡€æ•™ç¨‹ï¼ˆç¬¬ä¸‰ç‰ˆï¼‰				ç»§ç»­ç¬¬12ç« ï¼Œåé¢éƒ½æ˜¯ä¸œæ‹¼è¥¿å‡‘å…ˆä¸ç”¨çœ‹äº†

pythonè¯­è¨€åŠå…¶åº”ç”¨						ç»§ç»­ç¬¬11ç« ï¼Œåé¢éƒ½æ˜¯ä¸œæ‹¼è¥¿å‡‘å…ˆä¸ç”¨çœ‹äº†

æµç•…çš„Python							ç»§ç»­ç¬¬16ç« ï¼ˆæš‚æœªçœ‹10-13ï¼‰

Python Cookbookï¼ˆç¬¬3ç‰ˆï¼‰

çœ‹æ¼«ç”»å­¦Python							åŸºæœ¬å®Œæ¯•

http://www.ityouknow.com/python.html    åŸºæœ¬å®Œæ¯•

Pythonç½‘ç»œæ•°æ®é‡‡é›†                      ç»§ç»­ç¬¬4ç« 

Pythonç¼–ç¨‹å¿«é€Ÿä¸Šæ‰‹                      åŸºæœ¬å®Œæ¯•

Python Linuxç³»ç»Ÿç®¡ç†ä¸è‡ªåŠ¨åŒ–è¿ç»´        ç»§ç»­ç¬¬3.2ç« 

---
# åŸºç¡€çŸ¥è¯†

> Python æ˜¯ä¸€é—¨é¢å‘å¯¹è±¡è¯­è¨€ï¼Œåœ¨ Python çš„ä¸–ç•Œä¸€åˆ‡çš†å¯¹è±¡ã€‚æ‰€ä»¥ä¸€åˆ‡å˜é‡çš„æœ¬è´¨éƒ½æ˜¯å¯¹è±¡çš„ä¸€ä¸ªæŒ‡é’ˆè€Œå·²ã€‚
> Python æœ€åº•å±‚çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼šå¸ƒå°”å‹ã€æ•´å‹ã€æµ®ç‚¹å‹ä»¥åŠå­—ç¬¦ä¸²å‹ã€‚

## æ•°æ®ç±»å‹
- åœ¨Pythonä¸­æ‰€æœ‰çš„æ•°æ®ç±»å‹éƒ½æ˜¯ç±»ï¼Œæ¯ä¸ªæ•°æ®å€¼éƒ½æ˜¯ç±»çš„â€œå®ä¾‹â€ã€‚
- åœ¨Pythonä¸­æœ‰6ç§ä¸»è¦çš„å†…ç½®æ•°æ®ç±»å‹ï¼šæ•°å­—ã€å­—ç¬¦ä¸²ã€åˆ—è¡¨ã€å…ƒç»„ã€é›†åˆå’Œå­—å…¸ã€‚
- åˆ—è¡¨ã€å…ƒç»„ã€é›†åˆå’Œå­—å…¸å¯ä»¥å®¹çº³å¤šé¡¹æ•°æ®ï¼Œç»Ÿç§°ä¸ºå®¹å™¨ç±»å‹çš„æ•°æ®ã€‚
- Pythonä¸­çš„æ•°å­—ç±»å‹æœ‰4ç§ï¼šæ•´æ•°ç±»å‹ã€æµ®ç‚¹ç±»å‹ã€å¤æ•°ç±»å‹å’Œå¸ƒå°”ç±»å‹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¸ƒå°”ç±»å‹ä¹Ÿæ˜¯æ•°å­—ç±»å‹ï¼Œå®ƒäº‹å®ä¸Šæ˜¯æ•´æ•°ç±»å‹çš„ä¸€ç§ã€‚

å¦‚æœæŠŠæœ€åº•å±‚çš„åŸºæœ¬æ•°æ®ç±»å‹çœ‹ä½œç»„æˆ Python çš„åŸå­ï¼Œæ•°æ®ç»“æ„å°±åƒåˆ†å­ä¸€æ ·ã€‚åœ¨ç¼–ç¨‹ä¸­ï¼Œæœ€å¸¸è§çš„å·¥ä½œå°±æ˜¯å°†æ•°æ®è¿›è¡Œæ‹†åˆ†æˆ–åˆå¹¶ï¼Œå°†å…¶åŠ å·¥ä¸ºç‰¹å®šçš„å½¢å¼ï¼Œè€Œæ•°æ®ç»“æ„å°±æ˜¯ç”¨ä»¥åˆ‡åˆ†æ•°æ®çš„é’¢é”¯ä»¥åŠåˆå¹¶æ•°æ®çš„ç²˜åˆæªã€‚
## å˜é‡
- ä¸ºäº†ç†è§£ Python ä¸­çš„èµ‹å€¼è¯­å¥ï¼Œåº”è¯¥å§‹ç»ˆå…ˆè¯»å³è¾¹ã€‚å¯¹è±¡åœ¨å³è¾¹åˆ›å»ºæˆ–è·å–ï¼Œåœ¨æ­¤ä¹‹åå·¦è¾¹çš„å˜é‡æ‰ä¼šç»‘å®šåˆ°å¯¹è±¡ä¸Šï¼Œè¿™å°±åƒä¸ºå¯¹è±¡è´´ä¸Šæ ‡æ³¨ã€‚å› ä¸ºå˜é‡åªä¸è¿‡æ˜¯æ ‡æ³¨ï¼Œæ‰€ä»¥æ— æ³•é˜»æ­¢ä¸ºå¯¹è±¡è´´ä¸Šå¤šä¸ªæ ‡æ³¨ã€‚è´´çš„å¤šä¸ªæ ‡æ³¨ï¼Œå°±æ˜¯åˆ«åã€‚
- æ¯ä¸ªå˜é‡éƒ½æœ‰æ ‡è¯†ã€ç±»å‹å’Œå€¼ã€‚å¯¹è±¡ä¸€æ—¦åˆ›å»ºï¼Œå®ƒçš„æ ‡è¯†ç»ä¸ä¼šå˜ï¼›ä½ å¯ä»¥æŠŠæ ‡è¯†ç†è§£ä¸ºå¯¹è±¡åœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚is è¿ç®—ç¬¦æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„æ ‡è¯†ï¼›id() å‡½æ•°è¿”å›å¯¹è±¡æ ‡è¯†çš„æ•´æ•°è¡¨ç¤ºã€‚
- å¯¹ Python æ¥è¯´ï¼Œå˜é‡å°±ä¸å†æ˜¯ä¸€æ®µå›ºå®šçš„åœ°å€ï¼Œè€Œåªæ˜¯ Python ä¸­å„ä¸ªå¯¹è±¡æ‰€é™„ç€çš„æ ‡ç­¾ï¼ˆå¯ä»¥ç†è§£ä¸ºä½¿ç”¨idæ‰“å°åŒä¸€å˜é‡å¤šæ¬¡èµ‹å€¼æ¯æ¬¡åçš„åœ°å€ï¼Œä¼šå‘ç°éƒ½ä¸ä¸€æ ·ï¼‰ã€‚ç†è§£è¿™ä¸€ç‚¹å¯¹äºç†è§£ Python çš„å¾ˆå¤šç‰¹æ€§ååˆ†é‡è¦ã€‚(å¯ä»¥è®¤ä¸ºæ™®é€šå˜é‡éƒ½æ˜¯å¼•ç”¨ï¼Œå…¶ä½™ä¸ºæµ‹è¯•ï¼Œè¯¦è§ http://www.ityouknow.com/python/2019/09/12/python-reference-012.html)

```
a=100
print(id(a))
a=200
print(id(a))

[huawei@n161 ccc]$ python3 1.py
139721664918528
139721664921728
```

## æ•°å€¼
- æ•´å‹ï¼ˆæ•´æ•°ï¼Œä¾‹å¦‚ 42ã€100000000ï¼‰
- æµ®ç‚¹å‹ï¼ˆå°æ•°ï¼Œä¾‹å¦‚ 3.14159ï¼Œæˆ–ç”¨ç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºçš„æ•°å­—ï¼Œä¾‹å¦‚ 1.0e8ï¼Œå®ƒè¡¨ç¤º1ä¹˜ä»¥10çš„8æ¬¡æ–¹ï¼Œä¹Ÿå¯å†™ä½œ100000000.0ï¼‰
- æ— è®ºæ˜¯å“ªç§è¿ç®—ï¼Œåªè¦æœ‰æ“ä½œæ•°æ˜¯æµ®ç‚¹æ•°ï¼ŒPythoné»˜è®¤å¾—åˆ°çš„æ€»æ˜¯æµ®ç‚¹æ•°ï¼Œå³ä¾¿ç»“æœåŸæœ¬ä¸ºæ•´æ•°ä¹Ÿæ˜¯å¦‚æ­¤ã€‚
- ä¹¦å†™å¾ˆå¤§çš„æ•°æ—¶ï¼Œå¯ä½¿ç”¨ä¸‹åˆ’çº¿å°†å…¶ä¸­çš„æ•°å­—åˆ†ç»„ï¼Œå¦‚ universe_age = 14_000_000_000
- å¯ä»¥åŒæ—¶èµ‹å€¼å¤šä¸ªå˜é‡ x, y, z = 0, 0, 0
## bool
è¡¨ç¤ºçœŸå‡çš„ç±»å‹ï¼Œä»…åŒ…å« True å’Œ False ä¸¤ç§å–å€¼
- bool()
- True
- False
```
print(bool('I think, therefore I am'))
print(bool(42))
print(bool(''))
print(True)
print(False)

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
True
True
False
True
False
```

## ä¹˜æ–¹
print(3 ** 2)
## å¸¸é‡
Pythonæ²¡æœ‰å†…ç½®çš„å¸¸é‡ç±»å‹ï¼Œé€šå¸¸ä½¿ç”¨å…¨å¤§å†™å°†æŸä¸ªå˜é‡è§†ä¸ºå¸¸é‡ï¼Œå¦‚MAX_CONNECTIONS = 5000
## æ³¨é‡Š
ç”¨ä¸€ä¸ªâ€œ#â€
## minã€maxã€sumã€len

è¿™å‡ ä¸ªå‡½æ•°å¯ä»¥ç›´æ¥å†…å»ºå®¹å™¨ï¼Œå¦‚å…ƒç¥–ã€åˆ—è¡¨ç­‰

```
even_numbers = list(range(2, 11, 2))	# å¯ä»¥æŒ‡å®šæ­¥é•¿
print(min(even_numbers))
print(max(even_numbers))
print(sum(even_numbers))
print(len(even_numbers))

```
## inputã€intã€float
- int()å¯ä»¥å–å€¼
- int(False)ä¹Ÿå¯ä»¥è½¬æ¢boolå¾—åˆ°1å’Œ0
- float()å¯ä»¥å°†å…¶ä»–æ•°å­—ç±»å‹è½¬æ¢ä¸ºæµ®ç‚¹å‹
```
#!/usr/bin/python3
height = input("How tall are you, in inches? ")
height = int(height)
if height >= 48:
 print("\nYou're tall enough to ride!")
else:
 print("\nYou'll be able to ride when you're a little older.")

```
## æ‰“å°ã€æ¼‚äº®æ‰“å°ã€‚ã€‚ã€‚
```
print('Age:', 42) 
name = 'Gumby' 
salutation = 'Mr.' 
greeting = 'Hello,' 
print(greeting, salutation, name) 	# å¤šä¸ªå˜é‡é—´é»˜è®¤æ˜¯ç©ºæ ¼ï¼Œä¹Ÿå¯ä»¥è®¾ç½®é—´éš”ç¬¦ï¼Œè§ä¸‹é¢
print(greeting, ',', salutation, name) 
print(greeting + ',', salutation, name)  # å°†ç¬¬ä¸€ä¸ªå˜é‡ä¸é€—å·è¿æ¥çš„ç»“æœä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°
print("I", "wish", "to", "register", "a", "complaint", sep="_")  # è®¾ç½®é—´éš”ç¬¦å· 
print('Hello,', end='\n\n\n') # è®¾ç½®æ‰“å°çš„ç»“æŸç¬¦å·
print('world!')


[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
Age: 42
Hello, Mr. Gumby
Hello, , Mr. Gumby
Hello,, Mr. Gumby
I_wish_to_register_a_complaint
Hello,


world!
```
å¦‚æœè¦æ‰“å°çš„æ•°æ®ç»“æ„å¤ªå¤§ï¼Œä¸€è¡Œå®¹çº³ä¸ä¸‹ï¼Œå¯ä½¿ç”¨æ¨¡å—pprintä¸­çš„å‡½æ•°pprintï¼ˆè€Œä¸æ˜¯æ™®é€šprintè¯­å¥ï¼‰ã€‚pprintæ˜¯ä¸ªå“è¶Šçš„æ‰“å°å‡½æ•°ï¼Œèƒ½å¤Ÿæ›´å¦¥å–„åœ°æ‰“å°è¾“å‡ºã€‚

```
#!/usr/bin/python3
import sys, pprint 
pprint.pprint(sys.path) 

[huawei@n148 pytest]$ python3 pyth.py 
['/home/huawei/hwwork/doc/md/aaa/pytest',
 '/usr/local/lib/python3.6/site-packages/setuptools-19.6-py3.6.egg',
 '/usr/lib64/python36.zip',
 '/usr/lib64/python3.6',
 '/usr/lib64/python3.6/lib-dynload',
 '/usr/local/lib64/python3.6/site-packages',
 '/usr/local/lib/python3.6/site-packages',
 '/usr/lib64/python3.6/site-packages',
 '/usr/lib/python3.6/site-packages']
```

## ä¼ªéšæœºæ•°
- random()å‡½æ•°å¯ä»¥éšæœºç”Ÿæˆä¸€ä¸ª[0,1)çš„æµ®ç‚¹æ•°ã€‚
- randint(a,b)å‡½æ•°å¯ä»¥åœ¨æŒ‡å®šèŒƒå›´å†…éšæœºç”Ÿæˆä¸€ä¸ªæ•´æ•°ï¼Œå…¶ä¸­å‚æ•°aæ˜¯ä¸‹é™ï¼Œå‚æ•° b æ˜¯ä¸Šé™ï¼Œç”Ÿæˆçš„éšæœºæ•°nï¼ša <= n <= bã€‚
- uniform(a,b)å‡½æ•°å¯ä»¥åœ¨æŒ‡å®šèŒƒå›´å†…éšæœºç”Ÿæˆä¸€ä¸ªæµ®ç‚¹æ•°ï¼Œä¸¤ä¸ªå‚æ•°å…¶ä¸­ä¸€ä¸ªæ˜¯ä¸Šé™ï¼Œä¸€ä¸ªæ˜¯ä¸‹é™ã€‚å¦‚æœa > bï¼Œåˆ™ç”Ÿæˆçš„éšæœºæ•°n: b <= n <= aã€‚å¦‚æœ a <bï¼Œ åˆ™ a <= n <= bã€‚
- sample(sequence, k)å‡½æ•°å¯ä»¥è·å–ä»æ€»ä½“åºåˆ—æˆ–é›†åˆä¸­é€‰æ‹©çš„å”¯ä¸€å…ƒç´ çš„ké•¿åº¦åˆ—è¡¨ã€‚sample()å‡½æ•°ä¸ä¼šä¿®æ”¹åŸæœ‰åºåˆ—ï¼Œå®ƒä¸»è¦ç”¨åœ¨æ— é‡å¤çš„éšæœºæŠ½æ ·åœºæ™¯ï¼Œå®ç°ä»å¤§é‡æ ·æœ¬ä¸­å¿«é€Ÿè¿›è¡ŒæŠ½æ ·
- randrange()å‡½æ•°ä¸»è¦ç”¨äºè¿”å›ä¸€ä¸ªéšæœºæ•°ï¼Œå®ƒæœ‰ä¸‰ä¸ªå‚æ•°ï¼Œå…¶ä¸­ç¬¬ä¸‰ä¸ªå‚æ•°stepæ˜¯å¯é€‰å‚æ•°ã€‚å…·ä½“åŒºåˆ«å¦‚ä¸‹ï¼š
    - randrange([start], stop)å¯ä»¥åœ¨æŒ‡å®šèŒƒå›´å†…éšæœºç”Ÿæˆä¸€ä¸ªæ•´æ•°ï¼Œç”Ÿæˆçš„éšæœºæ•°nï¼ša <= n <= bã€‚å…¶ä¸­ï¼Œå‚æ•°startå’Œå‚æ•°stopæ˜¯æœ‰è¦æ±‚çš„ï¼Œå¿…é¡»å°æ•°åœ¨å‰å¤§æ•°åœ¨åï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚
    - randrange([start], stop[, step])å‡½æ•°å¯ä»¥å…ˆä»1åˆ°10ä¸­äº§ç”Ÿä¸€ä¸ªé—´éš”æ˜¯2çš„ç­‰å·®æ•°åˆ—[1,3,5,7,9]ï¼Œå†ä»ä¸­éšæœºè·å–ä¸€ä¸ªéšæœºæ•°ã€‚
- choice(sequence)å‡½æ•°å¯ä»¥ä»éç©ºåºåˆ— sequence ä¸­éšæœºè¿”å›ä¸€ä¸ªæ•°ï¼Œå‚æ•° sequence è¡¨ç¤ºä¸€ä¸ªæœ‰åºç±»å‹ï¼Œå¯ä»¥åŒ…å« listã€tuple ç­‰
- shuffle(x[, random])å‡½æ•°å¯ä»¥å°†ä¸€ä¸ªæœ‰åºåˆ—è¡¨ä¸­çš„å…ƒç´ æ‰“ä¹±ï¼Œå†é‡æ–°æ’åº

```
import random
print(random.random())
print(random.randint(5,50)) 
print(random.uniform(2,5))
print(random.uniform(5,2))
lst = [1,2,3,4,5]  
print(random.sample(lst,4))  
print(lst) 
print(random.randrange(1,10,2))
strlist = ['C++','C#','Java','Python']  
strtemp = ('Do you love python')  
print(random.choice(strlist))
print(random.choice(strtemp))  
lst = ['A' , 'B', 'C', 'D', 'E' ]
random.shuffle(lst)  
print (lst)  

[huawei@n161 ccc]$ python3 1.py
0.9216266647181643
41
3.428690309360838
4.214136072878796
[1, 3, 2, 4]
[1, 2, 3, 4, 5]
7
Python
y
['E', 'A', 'B', 'D', 'C']
```

## æ•°å­—å››èˆäº”å…¥ round

```
import time
now = time.time()
print(now)
print(round(now, 2))
print(round(now, 4))
print(round(now))


[huawei@n161 ccc]$ python 1.py
1666249651.4505882
1666249651.45
1666249651.4506
1666249651
```
## pass

é˜²æ­¢åœ¨ifé‡Œä»€ä¹ˆéƒ½ä¸å†™æ— æ³•è¿è¡Œï¼Œå¯æš‚æ—¶ç”¨passå ä½
```
#!/usr/bin/python3
name = "Enid"
if name == 'Ralph Auldus Melish': 
	print('Welcome!') 
elif name == 'Enid': 
	# è¿˜æœªå®Œæˆâ€¦â€¦
	pass 
elif name == 'Bill Gates': 
	print('Access Denied')

```
åœ¨å¼‚å¸¸å¤„ç†ä¸­å¦‚æœæ²¡æ‰¾åˆ°æ–‡ä»¶ä¹Ÿå°±ä»€ä¹ˆéƒ½ä¸åšäº†
```
def count_words(filename):
	try:
		with open(filename, encoding='utf-8') as f:
			contents = f.read()
	except FileNotFoundError:
		pass
	else:
		words = contents.split()
		num_words = len(words)
		print(f"The file {filename} has about {num_words} words.")


filenames = ['alice.txt', 'siddhartha.txt', 'moby_dick.txt', 'little_women.txt']
for filename in filenames:
	count_words(filename)

[huawei@n148 pytest]$ python3 pyth.py 
The file alice.txt has about 29465 words.
```
## del
ä¸ä»…ä¼šåˆ é™¤åˆ°å¯¹è±¡çš„å¼•ç”¨ï¼Œè¿˜ä¼šåˆ é™¤åç§°æœ¬èº«
## execã€eval
## å‘½åç©ºé—´

![](å‘½åç©ºé—´.png)

- å‘½åç©ºé—´å®šä¹‰äº†åœ¨æŸä¸ªä½œç”¨åŸŸå†…å˜é‡åå’Œç»‘å®šå€¼ä¹‹é—´çš„å¯¹åº”å…³ç³»ï¼Œå‘½åç©ºé—´æ˜¯é”®å€¼å¯¹çš„é›†åˆï¼Œå˜é‡åä¸å€¼æ˜¯ä¸€ä¸€å¯¹åº”å…³ç³»ã€‚ä½œç”¨åŸŸå®šä¹‰äº†å‘½åç©ºé—´ä¸­çš„å˜é‡èƒ½å¤Ÿåœ¨å¤šå¤§èŒƒå›´å†…èµ·ä½œç”¨ã€‚
- å‘½åç©ºé—´åœ¨ Python è§£é‡Šå™¨ä¸­æ˜¯ä»¥å­—å…¸çš„å½¢å¼å­˜åœ¨çš„ï¼Œæ˜¯ä»¥ä¸€ç§å¯ä»¥çœ‹å¾—è§æ‘¸å¾—ç€çš„å®ä½“å­˜åœ¨çš„ã€‚ä½œç”¨åŸŸæ˜¯ Python è§£é‡Šå™¨å®šä¹‰çš„ä¸€ç§è§„åˆ™ï¼Œè¯¥è§„åˆ™ç¡®å®šäº†è¿è¡Œæ—¶å˜é‡æŸ¥æ‰¾çš„é¡ºåºï¼Œæ˜¯ä¸€ç§å½¢è€Œä¸Šçš„è™šçš„è§„å®šã€‚
- å‘½åç©ºé—´çš„ç§ç±»åˆ†ä¸º 3 ç±»ï¼Œå‘½åç©ºé—´çš„ç§ç±»ä¹Ÿä½“ç°äº†å‘½åç©ºé—´çš„ç”Ÿå‘½å‘¨æœŸã€‚ä¸‰ä¸ªç§ç±»åŠç”Ÿå‘½å‘¨æœŸæè¿°å¦‚ä¸‹ï¼š
   
    - å†…ç½®åç§°ï¼ˆbuilt-in namesï¼‰ Python è¯­è¨€å†…ç½®çš„åç§°ï¼Œæ¯”å¦‚å‡½æ•°å absã€char å’Œå¼‚å¸¸åç§° BaseExceptionã€Exception ç­‰ç­‰ã€‚ç”Ÿå‘½å‘¨æœŸï¼šå¯¹äº Python built-in names ç»„æˆçš„å‘½åç©ºé—´ï¼Œå®ƒåœ¨ Python è§£é‡Šå™¨å¯åŠ¨çš„æ—¶å€™è¢«åˆ›å»ºï¼Œåœ¨è§£é‡Šå™¨é€€å‡ºçš„æ—¶å€™æ‰è¢«åˆ é™¤ï¼›

    - å…¨å±€åç§°ï¼ˆglobal namesï¼‰æ¨¡å—ä¸­å®šä¹‰çš„åç§°ï¼Œè®°å½•äº†æ¨¡å—çš„å˜é‡ï¼ŒåŒ…æ‹¬å‡½æ•°ã€ç±»ã€å…¶å®ƒå¯¼å…¥çš„æ¨¡å—ã€æ¨¡å—çº§çš„å˜é‡å’Œå¸¸é‡ã€‚ç”Ÿå‘½å‘¨æœŸï¼šå¯¹äºä¸€ä¸ª Python æ¨¡å—çš„ global namespaceï¼Œå®ƒåœ¨è¿™ä¸ª module è¢« import çš„æ—¶å€™åˆ›å»ºï¼Œåœ¨è§£é‡Šå™¨é€€å‡ºçš„æ—¶å€™é€€å‡ºï¼›

    - å±€éƒ¨åç§°ï¼ˆlocal namesï¼‰å‡½æ•°ä¸­å®šä¹‰çš„åç§°ï¼Œè®°å½•äº†å‡½æ•°çš„å˜é‡ï¼ŒåŒ…æ‹¬å‡½æ•°çš„å‚æ•°å’Œå±€éƒ¨å®šä¹‰çš„å˜é‡ã€‚ï¼ˆç±»ä¸­å®šä¹‰çš„ä¹Ÿæ˜¯ï¼‰ç”Ÿå‘½å‘¨æœŸï¼šå¯¹äºä¸€ä¸ªå‡½æ•°çš„ local namespaceï¼Œå®ƒåœ¨å‡½æ•°æ¯æ¬¡è¢«è°ƒç”¨çš„æ—¶å€™åˆ›å»ºï¼Œå‡½æ•°è¿”å›çš„æ—¶å€™è¢«åˆ é™¤ã€‚

    - å‘½åç©ºé—´çš„ç”Ÿå‘½å‘¨æœŸå–å†³äºå¯¹è±¡çš„ä½œç”¨åŸŸï¼Œå¦‚æœå¯¹è±¡æ‰§è¡Œå®Œæˆï¼Œåˆ™è¯¥å‘½åç©ºé—´çš„ç”Ÿå‘½å‘¨æœŸå°±ç»“æŸã€‚ å› æ­¤ï¼Œæˆ‘ä»¬æ— æ³•ä»å¤–éƒ¨å‘½åç©ºé—´è®¿é—®å†…éƒ¨å‘½åç©ºé—´çš„å¯¹è±¡ã€‚

- æŸ¥æ‰¾å˜é‡é¡ºåºä¸ºï¼šå±€éƒ¨çš„å‘½åç©ºé—´ -> å…¨å±€å‘½åç©ºé—´ -> å†…ç½®å‘½åç©ºé—´
- å„å‘½åç©ºé—´åˆ›å»ºé¡ºåºï¼šPython è§£é‡Šå™¨å¯åŠ¨ ->åˆ›å»ºå†…å»ºå‘½åç©ºé—´ -> åŠ è½½æ¨¡å— -> åˆ›å»ºå…¨å±€å‘½åç©ºé—´ ->å‡½æ•°è¢«è°ƒç”¨ ->åˆ›å»ºå±€éƒ¨å‘½åç©ºé—´
- å„å‘½åç©ºé—´é”€æ¯é¡ºåºï¼šå‡½æ•°è°ƒç”¨ç»“æŸ -> é”€æ¯å‡½æ•°å¯¹åº”çš„å±€éƒ¨å‘½åç©ºé—´ -> Python è™šæ‹Ÿæœºï¼ˆè§£é‡Šå™¨ï¼‰é€€å‡º ->é”€æ¯å…¨å±€å‘½åç©ºé—´ ->é”€æ¯å†…å»ºå‘½åç©ºé—´

- æ€»ç»“: ä¸€ä¸ªæ¨¡å—çš„å¼•å…¥ï¼Œå‡½æ•°çš„è°ƒç”¨ï¼Œç±»çš„å®šä¹‰éƒ½ä¼šå¼•å…¥å‘½åç©ºé—´ï¼Œå‡½æ•°ä¸­çš„å†å®šä¹‰å‡½æ•°ï¼Œç±»ä¸­çš„æˆå‘˜å‡½æ•°å®šä¹‰ä¼šåœ¨å±€éƒ¨ namespace ä¸­å†æ¬¡å¼•å…¥å±€éƒ¨ namespaceã€‚


Python æä¾›äº†ä¸¤ä¸ªè·å–å‘½åç©ºé—´å†…å®¹çš„å‡½æ•°ï¼š
- locals() è¿”å›ä¸€ä¸ªå±€éƒ¨å‘½åç©ºé—´å†…å®¹çš„å­—å…¸ï¼›
- globals() è¿”å›ä¸€ä¸ªå…¨å±€å‘½åç©ºé—´å†…å®¹çš„å­—å…¸ã€‚

```
animal = 'fruitbat'
def change_local():
	animal = 'wombat'
	print('locals:',locals())


print(animal)
change_local()
print('globals:', globals())
print(animal)

[huawei@n148 doc]$ python -u "/home/huawei/hwwork/doc/md/aaa/pltest/pyth.py"
fruitbat
('locals:', {'animal': 'wombat'})
('globals:', {'__builtins__': <module '__builtin__' (built-in)>, '__file__': '/home/huawei/hwwork/doc/md/aaa/pltest/pyth.py', '__package__': None, 'change_local': <function change_local at 0x7f9b8b392758>, 'animal': 'fruitbat', '__name__': '__main__', '__doc__': None})
fruitbat
```

## ä½œç”¨åŸŸ

- ä½œç”¨åŸŸå°±æ˜¯ä¸€ä¸ª Python ç¨‹åºå¯ä»¥ç›´æ¥è®¿é—®å‘½åç©ºé—´çš„æ­£æ–‡åŒºåŸŸã€‚
- ç›´æ¥è®¿é—®ä¸€ä¸ªå˜é‡ï¼Œä¼šä»å†…åˆ°å¤–ä¾æ¬¡è®¿é—®æ‰€æœ‰çš„ä½œç”¨åŸŸç›´åˆ°æ‰¾åˆ°ï¼Œå¦åˆ™ä¼šæŠ¥æœªå®šä¹‰çš„é”™è¯¯ã€‚
- ç¨‹åºçš„å˜é‡å¹¶ä¸æ˜¯åœ¨å“ªä¸ªä½ç½®éƒ½å¯ä»¥è®¿é—®çš„ï¼Œè®¿é—®æƒé™å†³å®šäºè¿™ä¸ªå˜é‡æ˜¯åœ¨å“ªé‡Œèµ‹å€¼çš„ã€‚
- å˜é‡çš„ä½œç”¨åŸŸå†³å®šäº†åœ¨å“ªä¸€éƒ¨åˆ†ç¨‹åºå¯ä»¥è®¿é—®å“ªä¸ªç‰¹å®šçš„å˜é‡åç§°


ä½œç”¨åŸŸåˆ†ä¸º4ç±»ï¼Œåˆ†åˆ«å¦‚ä¸‹ï¼š
- Lï¼ˆLocalï¼‰ï¼šæœ€å†…å±‚ï¼ŒåŒ…å«å±€éƒ¨å˜é‡ï¼Œæ¯”å¦‚ä¸€ä¸ªå‡½æ•°/æ–¹æ³•å†…éƒ¨ã€‚
- Eï¼ˆEnclosingï¼‰ï¼šåŒ…å«äº†éå±€éƒ¨(non-local)ä¹Ÿéå…¨å±€(non-global)çš„å˜é‡ã€‚æ¯”å¦‚ä¸¤ä¸ªåµŒå¥—å‡½æ•°ï¼Œä¸€ä¸ªå‡½æ•°ï¼ˆæˆ–ç±»ï¼‰ A é‡Œé¢åˆåŒ…å«äº†ä¸€ä¸ªå‡½æ•° B ï¼Œé‚£ä¹ˆå¯¹äº B ä¸­çš„åç§°æ¥è¯´ A ä¸­çš„ä½œç”¨åŸŸå°±ä¸º nonlocalã€‚
- Gï¼ˆGlobalï¼‰ï¼šå½“å‰è„šæœ¬çš„æœ€å¤–å±‚ï¼Œæ¯”å¦‚å½“å‰æ¨¡å—çš„å…¨å±€å˜é‡ã€‚
- Bï¼ˆBuilt-inï¼‰ï¼š åŒ…å«äº†å†…å»ºçš„å˜é‡/å…³é”®å­—ç­‰ï¼Œæœ€åè¢«æœç´¢ã€‚


ä½œç”¨åŸŸè§„åˆ™é¡ºåºä¸ºï¼šL->E->G->Bã€‚å¦‚æœå˜é‡åœ¨å±€éƒ¨å†…æ‰¾ä¸åˆ°ï¼Œä¾¿ä¼šå»å±€éƒ¨å¤–çš„å±€éƒ¨æ‰¾ï¼ˆä¾‹å¦‚é—­åŒ…ï¼‰ï¼Œå†æ‰¾ä¸åˆ°å°±ä¼šå»å…¨å±€æ‰¾ï¼Œå†æ‰¾ä¸åˆ°å°±å»å†…ç½®ä¸­æ‰¾ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š  
![](ä½œç”¨åŸŸ.png)

### å…¨å±€ä½œç”¨åŸŸå’Œå±€éƒ¨ä½œç”¨åŸŸ
å±€éƒ¨ä½œç”¨åŸŸï¼ˆLocalï¼‰æ˜¯è„šæœ¬ä¸­çš„æœ€å†…å±‚ï¼ŒåŒ…å«å±€éƒ¨å˜é‡ï¼Œæ¯”å¦‚ä¸€ä¸ªå‡½æ•°æˆ–æ–¹æ³•å†…éƒ¨ã€‚ é—­åŒ…å‡½æ•°å¤–å‡½æ•°ï¼ˆEnclosingï¼‰åŒ…å«äº†éå±€éƒ¨ (non-local) ä¹Ÿéå…¨å±€ (non-global) çš„å˜é‡ã€‚ å…¨å±€ä½œç”¨åŸŸï¼ˆGlobalï¼‰æ˜¯å½“å‰è„šæœ¬çš„æœ€å¤–å±‚ï¼Œå¦‚å½“å‰æ¨¡å—çš„å…¨å±€å˜é‡ï¼Œå®ä¾‹å¦‚ä¸‹ï¼š

```
global_scope = 0  # å…¨å±€ä½œç”¨åŸŸ
# å®šä¹‰é—­åŒ…å‡½æ•°ä¸­çš„å±€éƒ¨ä½œç”¨åŸŸ
def outer():
    o_count = 1  # é—­åŒ…å‡½æ•°å¤–çš„å‡½æ•°ä¸­ï¼Œç›¸å¯¹äºå‡½æ•° inner() æ¥è¯´ ä½œç”¨åŸŸéå±€éƒ¨
    def inner():
       local_scope = 2  # å±€éƒ¨ä½œç”¨åŸŸ
```
ä»¥ä¸Šå®ä¾‹å±•ç¤ºçš„æ˜¯å…¨å±€ä½œç”¨åŸŸå’Œé—­åŒ…å‡½æ•°ä¸­çš„å‡½æ•°ï¼Œä»¥åŠå‡½æ•°ä¸­çš„å±€éƒ¨ä½œç”¨åŸŸï¼Œå¯¹äºå‡½æ•° inner() æ¥è¯´ï¼Œouter() ä¸­çš„ä½œç”¨åŸŸä¸º non-local

### å†…å»ºä½œç”¨åŸŸ

Python ä¸­çš„å†…å»ºä½œç”¨åŸŸï¼ˆBuilt-inï¼‰ï¼š åŒ…å«äº†å†…å»ºçš„å˜é‡/å…³é”®å­—ç­‰ï¼Œæœ€åè¢«æœç´¢ã€‚å†…å»ºä½œç”¨åŸŸæ˜¯é€šè¿‡ä¸€ä¸ªåä¸º builtin çš„æ ‡å‡†æ¨¡å—æ¥å®ç°çš„ï¼Œä½†æ˜¯è¿™ä¸ªå˜é‡åè‡ªèº«å¹¶æ²¡æœ‰æ”¾å…¥å†…ç½®ä½œç”¨åŸŸå†…ï¼Œæ‰€ä»¥å¿…é¡»å¯¼å…¥è¿™ä¸ªæ–‡ä»¶æ‰èƒ½å¤Ÿä½¿ç”¨å®ƒã€‚åœ¨ Python3.0 ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹çš„ä»£ç æ¥æŸ¥çœ‹åˆ°åº•é¢„å®šä¹‰äº†å“ªäº›å˜é‡:
```
import builtins
dir(builtins)
['ArithmeticError', 'AssertionError', 'AttributeError', 'BaseException', 'BlockingIOError', 'BrokenPipeError', 'BufferError', 'BytesWarning', 'ChildProcessError', 'ConnectionAbortedError', 'ConnectionError', 'ConnectionRefusedError'...]
```
Python ä¸­åªæœ‰æ¨¡å—ï¼ˆmoduleï¼‰ï¼Œç±»ï¼ˆclassï¼‰ä»¥åŠå‡½æ•°ï¼ˆdefã€lambdaï¼‰æ‰ä¼šå¼•å…¥æ–°çš„ä½œç”¨åŸŸï¼Œå…¶å®ƒçš„ä»£ç å—ï¼ˆå¦‚ if/elif/else/ã€try/exceptã€for/while ç­‰ï¼‰æ˜¯ä¸ä¼šå¼•å…¥æ–°çš„ä½œç”¨åŸŸçš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™äº›è¯­å¥å†…å®šä¹‰çš„å˜é‡ï¼Œå¤–éƒ¨ä¹Ÿå¯ä»¥è®¿é—®

### å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡
- å…¨å±€å˜é‡ï¼šå®šä¹‰åœ¨å‡½æ•°å¤–éƒ¨æ‹¥æœ‰å…¨å±€ä½œç”¨åŸŸçš„å˜é‡
- å±€éƒ¨å˜é‡ï¼šå®šä¹‰åœ¨å‡½æ•°å†…éƒ¨æ‹¥æœ‰å±€éƒ¨ä½œç”¨åŸŸçš„å˜é‡

å±€éƒ¨å˜é‡åªèƒ½åœ¨å…¶è¢«å£°æ˜çš„å‡½æ•°å†…éƒ¨è®¿é—®ï¼Œè€Œå…¨å±€å˜é‡å¯ä»¥åœ¨æ•´ä¸ªç¨‹åºèŒƒå›´å†…è®¿é—®ã€‚è°ƒç”¨å‡½æ•°æ—¶ï¼Œæ‰€æœ‰åœ¨å‡½æ•°å†…å£°æ˜çš„å˜é‡åç§°éƒ½å°†è¢«åŠ å…¥åˆ°ä½œç”¨åŸŸä¸­ã€‚å¦‚ä¸‹å®ä¾‹ï¼š
```
# å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡
total = 0  # è¿™æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡
# å‡½æ•°è¯´æ˜
def sum(arg1, arg2):
    # è¿”å›2ä¸ªå‚æ•°çš„å’Œ."
    total = arg1 + arg2  # totalåœ¨è¿™é‡Œæ˜¯å±€éƒ¨å˜é‡.
    print("å‡½æ•°å†…æ˜¯å±€éƒ¨å˜é‡ : ", total)
    return total

# è°ƒç”¨sumå‡½æ•°ï¼Œä¼ å…¥å‚æ•°çš„è®¡ç®—ç»“æœæ˜¾ç¤ºå±€éƒ¨å˜é‡
sum(10, 20)
print("å‡½æ•°å¤–æ˜¯å…¨å±€å˜é‡ : ", total)

# è¾“å‡ºç»“æœä¸ºï¼š
å‡½æ•°å†…æ˜¯å±€éƒ¨å˜é‡ :  30
å‡½æ•°å¤–æ˜¯å…¨å±€å˜é‡ :  0
```

### global å’Œ nonlocal å…³é”®å­—

å½“å†…éƒ¨ä½œç”¨åŸŸæƒ³ä¿®æ”¹å¤–éƒ¨ä½œç”¨åŸŸçš„å˜é‡æ—¶ï¼Œå°±è¦ç”¨åˆ° global å’Œ nonlocal å…³é”®å­—äº†ã€‚å˜é‡è®¿é—®é¡ºåºï¼š  
å½“å‰ä½œç”¨åŸŸå±€éƒ¨å˜é‡ -> å¤–å±‚ä½œç”¨åŸŸå˜é‡ -> å†å¤–å±‚ä½œç”¨åŸŸå˜é‡ -> â€¦â€¦ -> å½“å‰æ¨¡å—å…¨å±€å˜é‡ -> pyhton å†…ç½®å˜é‡
- global: å…¨å±€å˜é‡,å½“å±€éƒ¨ä½œç”¨åŸŸæ”¹å˜å…¨å±€å˜é‡ç”¨ globalï¼ŒåŒæ—¶ global è¿˜å¯ä»¥å®šä¹‰æ–°çš„å…¨å±€å˜é‡
- nonlocal: å¤–å±‚åµŒå¥—å‡½æ•°çš„å˜é‡, nonlocal ä¸èƒ½å®šä¹‰æ–°çš„å¤–å±‚å‡½æ•°å˜é‡ï¼Œåªèƒ½æ”¹å˜å·²æœ‰çš„å¤–å±‚å‡½æ•°å˜é‡,åŒæ—¶ nonlocal ä¸èƒ½æ”¹å˜å…¨å±€å˜é‡

Pythonä¸è¦æ±‚å£°æ˜å˜é‡ï¼Œä½†æ˜¯å‡å®šåœ¨å‡½æ•°å®šä¹‰ä½“ä¸­èµ‹å€¼çš„å˜é‡æ˜¯å±€éƒ¨å˜é‡ï¼Œä¸‹ä¸ªæ¡ˆä¾‹ä¼šerr
```
b = 6
def f3(a):
	# global b		æ²¡æœ‰è¿™è¡Œä¼šè®¤ä¸ºbæ˜¯ä¸‹é¢çš„bï¼Œæ˜¯æœªå®šä¹‰çš„å±€éƒ¨å˜é‡
	print(a)
	print(b)
	b = 9

f3(3)
```
- å¯ä½¿ç”¨å‡½æ•°globalsæ¥è®¿é—®å…¨å±€å˜é‡ï¼Œè¿”å›ä¸€ä¸ªåŒ…å«å…¨å±€å˜é‡çš„å­—å…¸
```
def combine(parameter): # ä¸å…¨å±€å˜é‡åŒåçš„å‚æ•°
	print(parameter + globals()['parameter']) 

parameter = 'berry' 	# å…¨å±€å˜é‡
combine('Shrub') 

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
Shrubberry
```

å‡½æ•°å†…éƒ¨ä½¿ç”¨globalå£°æ˜ä¸€ä¸‹å³å¯
```
animal = 'fruitbat'
def change_and_print_global():
	global animal
	animal = 'wombat'
	print('inside change_and_print_global:', animal)

print(animal)
change_and_print_global()
print(animal)

[huawei@n148 doc]$ python -u "/home/huawei/hwwork/doc/md/aaa/pltest/pyth.py"
fruitbat
('inside change_and_print_global:', 'wombat')
wombat
```


- åœ¨å‡½æ•°å†…éƒ¨ç»™å˜é‡èµ‹å€¼æ—¶ï¼Œè¯¥å˜é‡é»˜è®¤ä¸ºå±€éƒ¨å˜é‡ï¼Œé™¤éæ˜ç¡®è¯´æ˜å®ƒæ˜¯å…¨å±€å˜é‡ã€‚
```
x = 1 
def change_global(): 
	global x 
	x = x + 1 

change_global() 
print(x)

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
2
```
global å’Œ nonlocal çš„åŒºåˆ«: 
- ä¸¤è€…çš„åŠŸèƒ½ä¸åŒã€‚global å…³é”®å­—ä¿®é¥°å˜é‡åæ ‡è¯†è¯¥å˜é‡æ˜¯å…¨å±€å˜é‡ï¼Œå¯¹è¯¥å˜é‡è¿›è¡Œä¿®æ”¹å°±æ˜¯ä¿®æ”¹å…¨å±€å˜é‡ï¼Œè€Œ nonlocal å…³é”®å­—ä¿®é¥°å˜é‡åæ ‡è¯†è¯¥å˜é‡æ˜¯ä¸Šä¸€çº§å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡ï¼Œå¦‚æœä¸Šä¸€çº§å‡½æ•°ä¸­ä¸å­˜åœ¨è¯¥å±€éƒ¨å˜é‡ï¼Œnonlocal ä½ç½®ä¼šå‘ç”Ÿé”™è¯¯ï¼ˆæœ€ä¸Šå±‚çš„å‡½æ•°ä½¿ç”¨ nonlocal ä¿®é¥°å˜é‡å¿…å®šä¼šæŠ¥é”™ï¼‰ã€‚
- ä¸¤è€…ä½¿ç”¨çš„èŒƒå›´ä¸åŒã€‚global å…³é”®å­—å¯ä»¥ç”¨åœ¨ä»»ä½•åœ°æ–¹ï¼ŒåŒ…æ‹¬æœ€ä¸Šå±‚å‡½æ•°ä¸­å’ŒåµŒå¥—å‡½æ•°ä¸­ï¼Œå³ä½¿ä¹‹å‰æœªå®šä¹‰è¯¥å˜é‡ï¼Œglobal ä¿®é¥°åä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œè€Œ nonlocal å…³é”®å­—åªèƒ½ç”¨äºåµŒå¥—å‡½æ•°ä¸­ï¼Œå¹¶ä¸”å¤–å±‚å‡½æ•°ä¸­å®šä¹‰äº†ç›¸åº”çš„å±€éƒ¨å˜é‡ï¼Œå¦åˆ™ä¼šå‘ç”Ÿé”™è¯¯

## å¼•ç”¨è®¡æ•° getrefcount
http://www.ityouknow.com/python/2020/01/06/python-gc-111.html

sys.getrefcount(object)ï¼Œè¿”å›å€¼æ˜¯ä¼ å…¥å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ã€‚ç”±äºä½œä¸ºå‚æ•°ä¼ å…¥getrefcount()çš„æ—¶å€™äº§ç”Ÿäº†ä¸€æ¬¡ä¸´æ—¶å¼•ç”¨ï¼Œå› æ­¤è¿”å›çš„è®¡æ•°å€¼ä¸€èˆ¬è¦æ¯”é¢„æœŸå¤š1ã€‚

## rangeè‡ªç„¶æ•°åºåˆ—
- range() å‡½æ•°çš„ç”¨æ³•ç±»ä¼¼äºä½¿ç”¨åˆ‡ç‰‡
- range(startï¼Œstopï¼Œstep)
- start çš„é»˜è®¤å€¼ä¸º 0ã€‚å”¯ä¸€è¦æ±‚çš„å‚æ•°å€¼æ˜¯ stopï¼Œäº§ç”Ÿçš„æœ€åä¸€ä¸ªæ•°çš„å€¼æ˜¯ stop çš„å‰ä¸€ä¸ª
- step çš„é»˜è®¤å€¼æ˜¯1ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥åå‘åˆ›å»ºè‡ªç„¶æ•°åºåˆ—ï¼Œè¿™æ—¶ step çš„å€¼ä¸º -1ã€‚
```
å¦‚ï¼š
list( range(0, 11, 2) )
for x in range(2, -1, -1):
for x in range(0,3):
list( range(0, 3) )
```

## exit é€€å‡ºç¨‹åº

```
import sys
while True:
    print('Type exit to exit.')
    response = input()
    if response == 'exit':
        sys.exit()
    print('You typed ' + response + '.')

```

# å‘½ä»¤è¡Œ

## å‚æ•°sys.argv
æ˜¯ä¸ªåˆ—è¡¨
```
import sys

print ('å‚æ•°ä¸ªæ•°ä¸º:', len(sys.argv), 'ä¸ªå‚æ•°ã€‚')
print ('å‚æ•°åˆ—è¡¨:', str(sys.argv))
print ('è„šæœ¬å:', str(sys.argv[0]))

[huawei@n161 pl]$ python3 61-buildpdf2bbb.py arg1 arg2 arg3
å‚æ•°ä¸ªæ•°ä¸º: 4 ä¸ªå‚æ•°ã€‚
å‚æ•°åˆ—è¡¨: ['61-buildpdf2bbb.py', 'arg1', 'arg2', 'arg3']
è„šæœ¬å: 61-buildpdf2bbb.py
```

å°†æ‰€æœ‰å‚æ•°ç»ƒæˆjoinèµ·æ¥

```
import webbrowser, sys
if len(sys.argv) > 1:
    address = ' '.join(sys.argv[1:])
    print(address)
```

# åºåˆ—çš„åˆ†ç±»

## æ‰å¹³åºåˆ—
æ˜¯ä¸€æ®µè¿ç»­çš„å†…å­˜ç©ºé—´ã€‚å­˜æ”¾å¦‚å­—ç¬¦ã€å­—èŠ‚å’Œæ•°å€¼è¿™ç§åŸºç¡€ç±»å‹ï¼Œå­˜å‚¨çš„æ˜¯å€¼è€Œä¸æ˜¯å¼•ç”¨ã€‚ä½“ç§¯æ›´å°ã€é€Ÿåº¦æ›´å¿«è€Œä¸”ç”¨èµ·æ¥æ›´ç®€å•ï¼Œä½†æ˜¯å®ƒåªèƒ½ä¿å­˜ä¸€äº›åŸå­æ€§çš„æ•°æ®ï¼Œæ¯”å¦‚æ•°å­—ã€å­—ç¬¦å’Œå­—èŠ‚ã€‚æ‰å¹³åºåˆ—å› ä¸ºåªèƒ½åŒ…å«åŸå­æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚æ•´æ•°ã€æµ®ç‚¹æ•°æˆ–å­—ç¬¦ï¼Œæ‰€ä»¥ä¸èƒ½åµŒå¥—ä½¿ç”¨ã€‚

- str
- bytes
- bytearray
- memoryview
- array.array

## å®¹å™¨åºåˆ—
å¯ä»¥å­˜æ”¾ä»»æ„ç±»å‹çš„å¯¹è±¡çš„å¼•ç”¨ã€‚å®¹å™¨åºåˆ—åˆ™æ¯”è¾ƒçµæ´»ï¼Œä½†æ˜¯å½“å®¹å™¨åºåˆ—é‡åˆ°å¯å˜å¯¹è±¡æ—¶ï¼Œç”¨æˆ·å°±éœ€è¦æ ¼å¤–å°å¿ƒäº†ï¼Œå› ä¸ºè¿™ç§ç»„åˆæ—¶å¸¸ä¼šæå‡ºä¸€äº›â€œæ„å¤–â€ï¼Œç‰¹åˆ«æ˜¯å¸¦åµŒå¥—çš„æ•°æ®ç»“æ„å‡ºç°æ—¶ï¼Œç”¨æˆ·è¦å¤šè´¹ä¸€äº›å¿ƒæ€æ¥ä¿è¯ä»£ç çš„æ­£ç¡®ã€‚


- list
- tuple
- collections.deque

## éå®¹å™¨åºåˆ—
- æ˜ å°„å…³ç³»çš„å®¹å™¨dict
- åªæœ‰keyçš„å®¹å™¨set
## å¯å˜åºåˆ—

listã€bytearrayã€array.arrayã€collections.deque å’Œ memoryviewã€‚

## ä¸å¯å˜åºåˆ—

tupleã€str å’Œ bytesã€‚


# æ¨å¯¼å’Œç”Ÿæˆå™¨è¡¨è¾¾å¼
åˆ—è¡¨æ¨å¯¼å’Œç”Ÿæˆå™¨è¡¨è¾¾å¼åˆ™æä¾›äº†çµæ´»æ„å»ºå’Œåˆå§‹åŒ–åºåˆ—çš„æ–¹å¼ï¼Œè¿™ä¸¤ä¸ªå·¥å…·éƒ½å¼‚å¸¸å¼ºå¤§ã€‚
## åˆ—è¡¨æ¨å¯¼
## å­—å…¸æ¨å¯¼
å°†å…ƒç¥–çš„åˆ—è¡¨æ¨å¯¼ä¸ºå­—å…¸
```
DIAL_CODES = [
	(86, 'China'),
	(91, 'India'),
	(1, 'United States'),
	(62, 'Indonesia'),
	(55, 'Brazil'),
	(92, 'Pakistan'),
	(880, 'Bangladesh'),
	(234, 'Nigeria'),
	(7, 'Russia'),
	(81, 'Japan'),
]

# è¿­ä»£åˆ—è¡¨ï¼Œå°†itemæ‹†åŒ…ä¸ºcodeä¸countryï¼Œå¹¶ä½¿ç”¨æ­¤2æ„å»ºå­—å…¸
country_code = {country: code for code, country in DIAL_CODES}
print(country_code)
country_code = {code: country.upper() for country, code in country_code.items() if code < 66}
print(country_code)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/bbb/src/pyth.py"
{'China': 86, 'India': 91, 'United States': 1, 'Indonesia': 62, 'Brazil': 55, 'Pakistan': 92, 'Bangladesh': 880, 'Nigeria': 234, 'Russia': 7, 'Japan': 81}
{1: 'UNITED STATES', 62: 'INDONESIA', 55: 'BRAZIL', 7: 'RUSSIA'}
```

## é›†åˆæ¨å¯¼
```
ä¸€ä¸ªLatin-1 å­—ç¬¦é›†åˆï¼Œè¯¥é›†åˆé‡Œçš„æ¯ä¸ªå­—ç¬¦çš„ Unicode åå­—é‡Œéƒ½æœ‰â€œSIGNâ€è¿™ä¸ªå•è¯
# ä» unicodedata æ¨¡å—é‡Œå¯¼å…¥ name å‡½æ•°ï¼Œç”¨ä»¥è·å–å­—ç¬¦çš„åå­—ã€‚
from unicodedata import name
# æŠŠç¼–ç åœ¨ 32~255 ä¹‹é—´çš„å­—ç¬¦çš„åå­—é‡Œæœ‰â€œSIGNâ€å•è¯çš„æŒ‘å‡ºæ¥ï¼Œæ”¾åˆ°ä¸€ä¸ªé›†åˆé‡Œ
s = {chr(i) for i in range(32, 256) if 'SIGN' in name(chr(i),'')}
print(s)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/bbb/src/pyth.py"
{'Â®', 'Â§', 'Â±', '<', '%', 'Â°', 'Â©', 'Â¥', 'Â¶', '+', 'Â¤', '#', 'Â¬', 'Ã·', '$', '=', 'Â£', '>', 'Â¢', 'Âµ', 'Ã—'}
```

# å­—ç¬¦ä¸² str
- å­—ç¬¦ç»„æˆçš„åºåˆ—
- å­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„ï¼Œå› æ­¤æ‰€æœ‰çš„å…ƒç´ èµ‹å€¼å’Œåˆ‡ç‰‡èµ‹å€¼éƒ½æ˜¯éæ³•çš„ã€‚
- å¤šè¡Œçš„ä½¿ç”¨ä¸‰ä¸ªå•å¼•å·
- Python3ä¸­çš„å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ä½¿ç”¨Unicodeç¼–ç æ–¹å¼ï¼Œä¸æ˜¯å­—èŠ‚æ•°ç»„

## ä¸‰ç§è¡¨ç¤ºæ–¹å¼
å­—ç¬¦ä¸²æœ‰ä¸‰ç§è¡¨ç¤ºæ–¹å¼ï¼š
- æ™®é€šå­—ç¬¦ä¸²  
æ™®é€šå­—ç¬¦ä¸²æŒ‡ç”¨å•å¼•å·ï¼ˆ'ï¼‰æˆ–åŒå¼•å·ï¼ˆï¼‚ï¼‰æ‹¬èµ·æ¥çš„å­—ç¬¦ä¸²ã€‚è½¬ä¹‰å­—ç¬¦èµ·ä½œç”¨ã€‚

 
- åŸå§‹å­—ç¬¦ä¸² raw string  
ç”¨rå‰ç¼€çš„å­—ç¬¦ä¸²å†…å®¹ä¸ä¼šè½¬ä¹‰
```
s2=r"hello\nworld"
print(s2)

[huawei@n161 ccc]$ python3 1.py
hello\nworld
```

- å¤šè¡Œå­—ç¬¦ä¸²  
ä½¿ç”¨3ä¸ªå¼•å·ï¼ˆå•åŒéƒ½å¯ä»¥ï¼‰åŒ…å›´çš„å­—ç¬¦ä¸²ï¼Œä¼šåŒ…å«æ¢è¡Œã€æ’ç‰ˆã€ç¼©è¿›ç­‰


è¿˜æœ‰å›¾æ ‡çš„ï¼Œè§ä¸‹ä¾‹æœ€åã€‚
```
#!/usr/bin/python3
print('''This is a very long string. It continues here. 
And it's not over yet. "Hello, world!" 
Still here.''')
print(r'C:\Program Files\fnord\foo\bar\baz\frozz\bozz')
print(r'Let\'s go!') 
print('C:\\nowhere') 
print(r'C:\Program Files\foo\bar' '\\') 
print("This is a cat: \N{Cat}")

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
This is a very long string. It continues here. 
And it's not over yet. "Hello, world!" 
Still here.
C:\Program Files\fnord\foo\bar\baz\frozz\bozz
Let\'s go!
C:\nowhere
C:\Program Files\foo\bar\
This is a cat: ğŸˆ
```
## è¡Œè¿æ¥ç¬¦ \
```

alphabet = 'abcdefg' + \
'hijklmnop' + \
'qrstuv' + \
'wxyz'

print(alphabet)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pytest/pyth.py"
abcdefghijklmnopqrstuvwxyz
```
## å¤§å†™ã€å°å†™ã€é¦–å­—æ¯å¤§å°
```
#!/usr/bin/python3
name = "ada lovelace"
print(name.title())
print(name.upper())
print(name.lower())

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
Ada Lovelace
ADA LOVELACE
ada lovelace
```
## strè½¬intã€float
```
print(int('80'))
print(float('80.0'))
print(int('AB', 16))	# æŒ‡å®š16è¿›åˆ¶å¯ä»¥è½¬æ¢
# print(int('AB'))	# é»˜è®¤å°†å‚æ•°è¿›è¡Œåè¿›åˆ¶è½¬æ¢ï¼Œä¼šå¤±è´¥
# print(int('80.0'))	# å‚æ•°éåè¿›åˆ¶ï¼Œæµ®ç‚¹ä¹Ÿå¤±è´¥

[huawei@n161 ccc]$ python3 1.py
80
80.0
171
```

## intã€floatã€boolè½¬str

```
print(str(321))
print(str(123.321))
print(str(True))

[huawei@n161 ccc]$ python3 1.py
321
123.321
True
```
## å­—ç¬¦æ•°é‡ len
å­—ç¬¦ä¸²å‡½æ•° len å¯ä»¥è®¡ç®—å­—ç¬¦ä¸²ä¸­ Unicode å­—ç¬¦çš„ä¸ªæ•°ï¼Œè€Œä¸æ˜¯å­—èŠ‚æ•°

```
letters = 'abcdefghijklmnopqrstuvwxyz'
print(len(letters))
```

## å­—èŠ‚æ•°é‡
å–å­—èŠ‚æ•°è§ç¼–ç encodeæ¡ˆä¾‹
## åˆ¤æ–­å¼€å¤´ã€ç»“å°¾
```
letters = 'abcdefghijklmnopqrstuvwxyz'
print(letters.startswith('abc'))
print(letters.endswith('abc'))
[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pytest/pyth.py"
True
False
```
è·å–æŒ‡å®šæ‰©å±•åæ–‡ä»¶åˆ—è¡¨
```
filenames = [ 'Makefile', 'foo.c', 'bar.py', 'spam.c', 'spam.h' ] 
print([name for name in filenames if name.endswith(('.c', '.h')) ])

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pyth.py"
['foo.c', 'spam.c', 'spam.h']
```
## åˆ¤æ–­éƒ½æ˜¯å­—æ¯æ•°å­—
poem.isalnum()
## é¦–å­—æ¯å˜å¤§å†™
setup.capitalize()
## æ‰€æœ‰å•è¯çš„å¼€å¤´å­—æ¯å˜å¤§å†™
setup.title()

## æ‰€æœ‰å­—æ¯éƒ½å¤§å†™
setup.upper()

## æ‰€æœ‰å­—æ¯éƒ½å°å†™
setup.lower()

## æ‰€æœ‰å­—æ¯å¤§å°å†™äº’æ¢
setup.swapcase()
## å·¦å¯¹é½ã€å³å¯¹é½ã€å±…ä¸­

print('Hello'.rjust(10))
print('Hello'.ljust(10))
print('Hello'.center(10))


## å–å­—ç¬¦
å½“åšæ•°æ®è¿›è¡Œç´¢å¼•å³å¯
```
letters = 'abcdefghijklmnopqrstuvwxyz'
print(letters[0])
print(letters[1])
print(letters[2])
print(letters[-1])
print(letters[-2])

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pytest/pyth.py"
a
b
c
z
y
```
## æ ¼å¼åŒ–
- cé£æ ¼%æ–¹å¼
- shellé£æ ¼
- formatæ–¹æ³•ï¼Œå…³äºæ›´å¤šformatæ§åˆ¶ç¬¦å·å‚è§ã€ŠpythonåŸºç¡€ç»§æ‰¿ç¬¬äºŒç‰ˆ 3.3ã€‹
	- è¦å¯¹å­—å…¸æ‰§è¡Œå­—ç¬¦ä¸²æ ¼å¼è®¾ç½®æ“ä½œï¼Œä¸èƒ½ä½¿ç”¨formatå’Œå‘½åå‚æ•°ï¼Œè€Œå¿…é¡»ä½¿ç”¨format_mapã€‚è§å­—å…¸çš„formatéƒ¨åˆ†æ¡ˆä¾‹
- fæ–¹å¼ï¼Œæ˜¯Python 3.6å¼•å…¥çš„ï¼Œç”¨äºç®€åŒ–format

è¯¦ç»†å±…å·¦ä¿ç•™æ•°ä½ç­‰å‚åŠ pythonè¯­è¨€åŠå…¶åº”ç”¨7.1.2 æ ¼å¼åŒ–

```
#!/usr/bin/python3
from math import pi
from string import Template
from math import e
import math 

# cé£æ ¼
format = "Hello, %s. %s enough for ya?"
values = ('world', 'Hot') 
sss = format % values
print(sss)	# Hello, world. Hot enough for ya?

# shellé£æ ¼
tmpl = Template("Hello, $who! $what enough for ya?") 
sss = tmpl.substitute(who="Mars", what="Dusty")
print(sss)	# Hello, Mars! Dusty enough for ya?

# formaté£æ ¼ï¼Œ{}é‡Œä½¿ç”¨éœ€è¦åˆ™ä»0å¼€å§‹
sss = "{}, {} and {}".format("first", "second", "third") 
print(sss)	# first, second and third
print("{0}, {1} and {2}".format("first", "second", "third"))	# first, second and third
print("{3} {0} {2} {1} {3} {0}".format("be", "not", "or", "to"))	# to be or not to be
print("{name} is approximately {value:2f}".format(value=pi, name="Ï€"))	# Ï€ is approximately 3.141593
print("{name} is approximately {value}.".format(value=pi, name="Ï€")) 	# Ï€ is approximately 3.141592653589793.
print("{{ceci n'est pas une replacement field}}".format()) # {ceci n'est pas une replacement field}, åŒ…å«{}çš„å­—ç¬¦ä¸²
print("{foo} {} {bar} {}".format(1, 2, bar=4, foo=3))	# 3 1 4 2
print("{foo} {1} {bar} {0}".format(1, 2, bar=4, foo=3))	# 3 2 4 1

print("Euler's constant is roughly {e}.".format(e=e))	# Euler's constant is roughly 2.718281828459045.
print(f"Euler's constant is roughly {e}.") # python3.6ä¹‹åä½¿ç”¨ç®€å†™fï¼Œæ•ˆæœä¸ä¸Šä¸€å¥ç­‰ä»·
first_name = "ada"
last_name = "lovelace"
full_name = f"{first_name} {last_name}"
print(full_name)	# ada lovelace
message = f"Hello, {full_name.title()}!"
print(message)	# Hello, Ada Lovelace!

fullname = ["Alfred", "Smoketoomuch"] 
print("Mr {name[1]}".format(name=fullname))	# Mr Smoketoomuchï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åˆ—è¡¨å…ƒç´ 

tmpl = "The {mod.__name__} module defines the value {mod.pi} for Ï€" 
sss = tmpl.format(mod=math)	# è¿˜å¯ä»¥ä½¿ç”¨åŒ…ï¼ˆåŒ…åï¼šmod.__name__ã€åŒ…é‡Œçš„å˜é‡ï¼šmod.piï¼‰
print(sss)	# The math module defines the value 3.141592653589793 for Ï€
```
## å±…ä¸­
ç”¨æŒ‡å®šå­—ç¬¦å¡«å……ä¸¤è¾¹
```
print("The Middle by Jimmy Eat World".center(39, "*")) 

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
*****The Middle by Jimmy Eat World*****
```
## åˆ ä¸¤ç«¯ç©ºç™½æˆ–å­—ç¬¦
- lstrip
- strip
	åˆ é™¤ä¸¤ç«¯ç©ºæ ¼ï¼Œä¹Ÿå¯åˆ é™¤é€šè¿‡å‚æ•°æŒ‡å®šçš„å­—ç¬¦ä»¬ï¼Œè§ä¸‹ä¾‹
- rstrip
	å¯ç”¨äºåœ¨readæ–‡ä»¶åå»é™¤æ–‡ä»¶æœ«å°¾å¤šä½™çš„ç©ºç™½æˆ–æ¢è¡Œï¼Œè§æ–‡ä»¶è¯»å–æ¡ˆä¾‹
```
åˆ é™¤å¼€å¤´æˆ–æœ«å°¾çš„æŒ‡å®šå­—ç¬¦ï¼Œå› æ­¤ä¸­é—´çš„æ˜Ÿå·æœªè¢«åˆ é™¤ã€‚
print('*** SPAM * for * everyone!!! ***'.strip(' *!'))

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
SPAM * for * everyone
```
ä½¿ç”¨stripåˆ é™¤æ¯è¡Œçš„ä¸¤è¾¹ç©ºç™½
```
with open('pi_digits.txt') as file_object:
    lines = file_object.readlines()
pi_string = ''
for line in lines:
	pi_string += line.strip()
print(pi_string)
print(len(pi_string))

[huawei@n148 pytest]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pytest/pyth.py"
3.141592653589793238462643383279
32

[huawei@n148 pytest]$ cat pi_digits.txt 
3.1415926535 
  8979323846 
  2643383279
```
## æ¯”è¾ƒ
ä¾ç„¶ä½¿ç”¨==ä¸!=
```
#!/usr/bin/python3
requested_topping = 'mushrooms'
if requested_topping != 'anchovies':
	print("Hold the anchovies!")
car = 'Audi'
print(car.lower() == 'audi')

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
Hold the anchovies!
True
```
## nå€å­—ç¬¦ä¸²
ä½¿ç”¨ä¹˜æ³•*ï¼Œæ•ˆæœåŒperl
```
print('python ' * 5) # python python python python python 
```
## æ£€æµ‹åŒ…å«å­—ç¬¦
```
permissions = 'rw' 
print('w' in permissions)	# True
subject = '$$$ Get rich now!!! $$$' 
print('$$$' in subject)		# True
```
## æŸ¥æ‰¾ findã€rfind
rfindæ˜¯ä»åå‘å‰æ‰¾ï¼Œä½†è¿”å›çš„indexè¿˜æ˜¯ä»å‰å‘åçš„æ•°çš„
```
# è¿”å›indexï¼Œå¦åˆ™è¿”å›-1ã€‚èµ·ç‚¹å’Œç»ˆç‚¹å€¼ï¼ˆç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°ï¼‰æŒ‡å®šçš„æœç´¢èŒƒå›´åŒ…å«èµ·ç‚¹ï¼Œä½†ä¸åŒ…å«ç»ˆç‚¹ã€‚
subject = "$$$ Get rich now!!! $$$"
print(subject.find('$$$')) 
print(subject.find('$$$', 1)) # åªæŒ‡å®šäº†èµ·ç‚¹
print(subject.find('!!!'))
print(subject.find('!!!', 0, 16)) # åŒæ—¶æŒ‡å®šäº†èµ·ç‚¹å’Œç»ˆç‚¹

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
0
20
16
-1
```
## joinã€split
splitè¿”å›åˆ—è¡¨
```
#!/usr/bin/python3
seq = ['1', '2', '3', '4', '5'] 
sep = '-'
print(sep.join(seq)) # 1-2-3-4-5ï¼Œ åˆå¹¶ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨
dirs = '', 'usr', 'bin', 'env' # è¿™æ˜¯ä¸ªå…ƒç¥–ï¼Œé¦–å…ƒç´ ä¸ºç©ºç”¨äºjoinåå¼€å¤´çš„â€œ/â€
print(dirs)
print('/'.join(dirs)) 	#  /usr/bin/env
print('C:' + '\\'.join(dirs))  # C:\usr\bin\env



print('1+2+3+4+5'.split('+'))	# ['1', '2', '3', '4', '5']
```
## å‡ºç°çš„æ¬¡æ•° count
```
line = "Row, row, row your boat"
print(line.count('row'))
print(line.lower().count('row'))

[huawei@n148 pytest]$ python3 pyth.py 
2
3
```
## ç»Ÿè®¡å•è¯æ•°é‡
ä½¿ç”¨äº†å¼‚å¸¸å¤„ç†ï¼Œå¹¶ä¸”å¯ä»¥ç»Ÿè®¡å¤šæœ¬ä¹¦çš„è¯æ•°
```
def count_words(filename):
	try:
		with open(filename, encoding='utf-8') as f:
			contents = f.read()
	except FileNotFoundError:
		print(f"Sorry, the file {filename} does not exist.")
	else:
		words = contents.split()
		num_words = len(words)
		print(f"The file {filename} has about {num_words} words.")


filenames = ['alice.txt', 'siddhartha.txt', 'moby_dick.txt', 'little_women.txt']
for filename in filenames:
	count_words(filename)

[huawei@n148 pytest]$ python3 pyth.py 
The file alice.txt has about 29465 words.
Sorry, the file siddhartha.txt does not exist.
Sorry, the file moby_dick.txt does not exist.
Sorry, the file little_women.txt does not exist.
```
## æ›¿æ¢å­—ç¬¦
ç”±äºå­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„ï¼Œå› æ­¤æ— æ³•ç›´æ¥æ’å…¥å­—ç¬¦æˆ–æ”¹å˜æŒ‡å®šä½ç½®çš„å­—ç¬¦ã€‚ä¸‹é¢æ–¹å¼æ˜¯éæ³•çš„
```
name = 'Henny'
name[0] = 'P'
```
å¯ä»¥ä½¿ç”¨replaceæˆ–åˆ‡ç‰‡è¾¾åˆ°æ›¿æ¢çš„æ•ˆæœ
```
name = 'Henny'
print(name.replace('H', 'P'))
print('P' + name[1:])

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pytest/pyth.py"
Penny
Penny
```
## æ›¿æ¢ replace
å‚æ•°ï¼š
- éœ€è¦è¢«æ›¿æ¢çš„å­ä¸²
- ç”¨äºæ›¿æ¢çš„æ–°å­ä¸²
- ä»¥åŠéœ€è¦æ›¿æ¢å¤šå°‘å¤„ï¼Œçœç•¥æ­¤å‚æ•°å°†æ›¿æ¢æ‰€æœ‰
```
s1 = 'This is a test';
s2 = s1.replace('is', 'eez');	# æ›¿æ¢äº†ä¸¤å¤„
print(s1)
print(s2)

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
This is a test
Theez eez a test
```
## ä½¿ç”¨ã€start:end:stepã€‘åˆ‡ç‰‡
- ã€:ã€‘ æå–ä»å¼€å¤´åˆ°ç»“å°¾çš„æ•´ä¸ªå­—ç¬¦ä¸²
- ã€start:ã€‘ ä» start æå–åˆ°ç»“å°¾
- ã€:endã€‘ ä»å¼€å¤´æå–åˆ° end - 1
- ã€start:endã€‘ ä» start æå–åˆ° end - 1
- ã€start:end:stepã€‘ ä» start æå–åˆ° end - 1ï¼Œæ¯ stepä¸ªå­—ç¬¦æå–ä¸€ä¸ª
- åç§»é‡ä»å·¦è‡³å³ä» 0ã€1 å¼€å§‹ï¼Œä¾æ¬¡å¢åŠ 
- ä»å³è‡³å·¦ä»-1ã€-2 å¼€å§‹ï¼Œä¾æ¬¡å‡å°
- å¦‚æœçœç•¥ startï¼Œåˆ†ç‰‡ä¼šé»˜è®¤ä½¿ç”¨åç§»é‡0ï¼ˆå¼€å¤´ï¼‰
- å¦‚æœçœç•¥ endï¼Œåˆ†ç‰‡ä¼šé»˜è®¤ä½¿ç”¨åç§»é‡ -1ï¼ˆç»“å°¾ï¼‰
```

letters = 'abcdefghijklmnopqrstuvwxyz'
print(letters[:])	# abcdefghijklmnopqrstuvwxyz	æå–æ•´ä¸ªå­—ç¬¦ä¸²
print(letters[20:])	 # uvwxyz 	ä»åç§»é‡ 20 æå–åˆ°å­—ç¬¦ä¸²ç»“å°¾
print(letters[10:])	# klmnopqrstuvwxyz ä»åç§»é‡ 10 æå–åˆ°ç»“å°¾
print(letters[12:15]) # mno  ä» 12 åˆ° 14 çš„å­—ç¬¦
print(letters[-3:])	# xyz æå–æœ€åä¸‰ä¸ªå­—ç¬¦
print(letters[18:-3]) # stuvw	ä»åç§»é‡ä¸º 18 çš„å­—ç¬¦åˆ°å€’æ•°ç¬¬ 4 ä¸ªå­—ç¬¦, æ³¨æ„ä¸ä¸Šä¸€ä¸ª
ä¾‹å­çš„åŒºåˆ«ï¼šå½“åç§»é‡ -3 ä½œä¸ºå¼€å§‹ä½ç½®æ—¶ï¼Œå°†è·å¾—å­—ç¬¦xï¼›è€Œå½“å®ƒä½œä¸ºç»ˆæ­¢ä½ç½®æ—¶ï¼Œåˆ†ç‰‡å®é™…
ä¸Šä¼šåœ¨åç§»é‡ -4 å¤„åœæ­¢ï¼Œä¹Ÿå°±æ˜¯æå–åˆ°å­—ç¬¦ w

print(letters[-6:-2]) # uvwx	ä»å€’æ•°ç¬¬ 6 ä¸ªå­—ç¬¦åˆ°å€’æ•°ç¬¬ 3 ä¸ªå­—ç¬¦
print(letters[::7])	# ahov	ä»å¼€å¤´æå–åˆ°ç»“å°¾ï¼Œæ­¥é•¿è®¾ä¸º 7
print(letters[4:20:3]) # ehknqt	ä»åç§»é‡ 4 æå–åˆ°åç§»é‡ 19ï¼Œæ­¥é•¿è®¾ä¸º 3
print(letters[19::4]) # tx	ä»åç§»é‡ 19 æå–åˆ°ç»“å°¾ï¼Œæ­¥é•¿è®¾ä¸º 4
print(letters[:21:5]) # afkpu	ä»å¼€å¤´æå–åˆ°åç§»é‡ 20ï¼Œæ­¥é•¿è®¾ä¸º 5,è®°ä½ï¼Œåˆ†ç‰‡
ä¸­ end çš„åç§»é‡éœ€è¦æ¯”å®é™…æå–çš„æœ€åä¸€ä¸ªå­—ç¬¦çš„åç§»é‡å¤š 1

# å¦‚æœæŒ‡å®šçš„æ­¥é•¿ä¸ºè´Ÿæ•°ä¼šä»å³åˆ°å·¦åå‘è¿›è¡Œæå–æ“ä½œã€‚
print(letters[-1::-1]) # zyxwvutsrqponmlkjihgfedcba   ä»å³åˆ°å·¦ä»¥æ­¥é•¿ä¸º 1 è¿›è¡Œæå–ï¼Œä¸‹é¢çš„
æ•ˆæœä¸€æ ·ä¹Ÿæ›´ç®€å•
print(letters[::-1]) # zyxwvutsrqponmlkjihgfedcba æ•ˆæœåŒä¸Š

# åœ¨åˆ†ç‰‡ä¸­ï¼Œå°äºèµ·å§‹ä½ç½®çš„åç§»é‡ä¼šè¢«å½“ä½œ 0ï¼Œå¤§äºç»ˆæ­¢ä½ç½®çš„åç§»é‡ä¼šè¢«å½“ä½œ -1ï¼Œ
print(letters[-50:]) # abcdefghijklmnopqrstuvwxyz æå–å€’æ•° 50 ä¸ªå­—ç¬¦
print(letters[-50:-51]) # å¾—åˆ°ç©ºï¼Œæå–ä»å€’æ•°ç¬¬ 51 åˆ°å€’æ•°ç¬¬ 50 ä¸ªå­—ç¬¦
print(letters[:70])	# abcdefghijklmnopqrstuvwxyz  ä»å¼€å¤´æå–åˆ°åç§»é‡ä¸º 69 çš„å­—ç¬¦
print(letters[70:71])  # å¾—åˆ°ç©ºï¼Œ ä»åç§»é‡ä¸º 70 çš„å­—ç¬¦æå–åˆ°åç§»é‡ä¸º 71 çš„å­—ç¬¦
```
## å–å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†
å…¶å®å°±æ˜¯åˆ‡ç‰‡æ“ä½œ...
```
with open('pi_digits.txt') as file_object:
    lines = file_object.readlines()
pi_string = ''
for line in lines:
	pi_string += line.strip()
print(pi_string)
print(f"{pi_string[:20]}...")
print(len(pi_string))

[huawei@n148 pytest]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pytest/pyth.py"
3.141592653589793238462643383279
3.141592653589793238...
32
```


## ç¼–ç  encode
- å­—ç¬¦çš„æ ‡è¯†ï¼Œå³ç ä½ï¼Œæ˜¯ 0~1 114 111 çš„æ•°å­—ï¼ˆåè¿›åˆ¶ï¼‰ï¼Œåœ¨ Unicode æ ‡å‡†ä¸­ä»¥ 4~6 ä¸ªåå…­è¿›åˆ¶æ•°å­—è¡¨ç¤ºï¼Œè€Œä¸”åŠ å‰ç¼€â€œU+â€ã€‚çº¦ 10% çš„æœ‰æ•ˆç ä½æœ‰å¯¹åº”çš„å­—ç¬¦ã€‚
- å­—ç¬¦çš„å…·ä½“è¡¨è¿°å–å†³äºæ‰€ç”¨çš„ç¼–ç ï¼ˆå¦‚utf8ï¼‰ã€‚ç¼–ç æ˜¯åœ¨ç ä½å’Œå­—èŠ‚åºåˆ—ä¹‹é—´è½¬æ¢æ—¶ä½¿ç”¨çš„ç®—æ³•ã€‚
- ç¼–ç æ˜¯å°†ç ä½è½¬æ¢æˆå­—èŠ‚åºåˆ—çš„è¿‡ç¨‹
- encodeæ”¯æŒç¬¬äºŒä¸ªå‚æ•°ç”¨äºæŒ‡å®šå½“ç›®æ ‡ç¼–ç æ— æ­¤å­—ç¬¦æ—¶æ˜¯å¼‚å¸¸è¿˜æ˜¯å¿½ç•¥çš„æ“ä½œ

	å¦‚æœä½ æƒ³è¦ä½¿ç”¨ ascii æ–¹å¼è¿›è¡Œç¼–ç ï¼Œå¿…é¡»ä¿è¯å¾…ç¼–ç çš„å­—ç¬¦ä¸²ä»…åŒ…å« ASCII å­—ç¬¦é›†é‡Œçš„å­—ç¬¦ï¼Œä¸å«æœ‰ä»»ä½•å…¶ä»–çš„ Unicode å­—ç¬¦ï¼Œå¦åˆ™ä¼šå‡ºç°é”™è¯¯
- å°½å¯èƒ½ç»Ÿä¸€ä½¿ç”¨ UTF-8 ç¼–ç ã€‚å‡ºé”™ç‡ä½ï¼Œå…¼å®¹æ€§å¥½ï¼Œå¯ä»¥è¡¨è¾¾æ‰€æœ‰çš„ Unicode å­—ç¬¦ï¼Œç¼–ç å’Œè§£ç çš„é€Ÿåº¦åˆå¿«
- å¯ä»¥æŠŠå­—èŠ‚åºåˆ—æƒ³æˆæ™¦æ¶©éš¾æ‡‚çš„æœºå™¨ç£èŠ¯è½¬å‚¨ï¼ŒæŠŠ Unicode å­—ç¬¦ä¸²æƒ³æˆâ€œäººç±»å¯è¯»â€çš„æ–‡æœ¬ã€‚é‚£ä¹ˆï¼ŒæŠŠå­—èŠ‚åºåˆ—å˜æˆäººç±»å¯è¯»çš„æ–‡æœ¬å­—ç¬¦ä¸²å°±æ˜¯è§£ç ï¼Œè€ŒæŠŠå­—ç¬¦ä¸²å˜æˆç”¨äºå­˜å‚¨æˆ–ä¼ è¾“çš„å­—èŠ‚åºåˆ—å°±æ˜¯ç¼–ç ã€‚

```
snowman = '\u2603'	# å°†Unicode å­—ç¬¦ä¸² '\u2603' èµ‹å€¼ç»™ snowmanã€‚
print(snowman)
print(len(snowman))	# snowman æ˜¯ä¸€ä¸ªä»…åŒ…å«ä¸€ä¸ªå­—ç¬¦çš„ Unicode å­—ç¬¦ä¸²ï¼Œè¿™ä¸å®ƒå­˜å‚¨æ‰€éœ€çš„å­—èŠ‚æ•°æ²¡æœ‰ä»»ä½•å…³ç³»
ds = snowman.encode('utf-8')	# å°†Unicodeå­—ç¬¦ç¼–ç ä¸ºå­—èŠ‚åºåˆ—ã€‚UTF-8 æ˜¯ä¸€ç§å˜é•¿ç¼–ç æ–¹å¼ï¼Œdsæ˜¯ä¸€ä¸ªbytesç±»å‹çš„å˜é‡
print(len(ds))	# å ç”¨äº† 3 å­—èŠ‚çš„ç©ºé—´ï¼Œæ³¨æ„ä¸æ˜¯æ‰€æœ‰å•ä¸ª Unicodeå­—ç¬¦éƒ½æ˜¯3
print(ds)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pyth.py"
â˜ƒ
1
3
b'\xe2\x98\x83'
```
## è§£ç  decode

- è§£ç æ˜¯å°†å­—èŠ‚åºåˆ—è½¬æ¢æˆç ä½çš„è¿‡ç¨‹
```
place = 'caf\u00e9'	# unicodeå­—ç¬¦ä¸²
print(place)
print(len(place))
print(type(place))
place_bytes = place.encode('utf-8')	# å°†å®ƒä»¥ UTF-8 æ ¼å¼ç¼–ç ä¸º bytes å‹å˜é‡
print(place_bytes)
print(len(place_bytes))
print(type(place_bytes))
place2 = place_bytes.decode('utf-8') # å†è§£å›æ¥
print(place2)
print(len(place2))
print(type(place2))

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pyth.py"
cafÃ©
4
<class 'str'>
b'caf\xc3\xa9'
5
<class 'bytes'>
cafÃ©
4
<class 'str'>
```
## ç»Ÿä¸€å­—ç¬¦ç¼–ç ä¾¦æµ‹åŒ… Chardet
èƒ½è¯†åˆ«æ‰€æ”¯æŒçš„ 30 ç§ç¼–ç  https://pypi.python.org/pypi/chardet

# åˆ—è¡¨ã€ã€‘ list
- åˆ—è¡¨éå¸¸é€‚åˆåˆ©ç”¨é¡ºåºå’Œä½ç½®å®šä½æŸä¸€å…ƒç´ 
- åˆ—è¡¨å…ƒç´ æ˜¯å¯å˜çš„
- ä½¿ç”¨ä¸­æ‹¬å·å®šä¹‰
- åœ¨åˆ—è¡¨ä¸­ï¼Œå…·æœ‰ç›¸åŒå€¼çš„å…ƒç´ å…è®¸å‡ºç°å¤šæ¬¡
- å¯ä»¥åŒæ—¶å®¹çº³ä¸åŒç±»å‹çš„å…ƒç´ ï¼Œä½†æ˜¯å®é™…ä¸Šè¿™æ ·åšå¹¶æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„å¥½å¤„ï¼Œæ¯”å¦‚ä¸èƒ½å¯¹åˆ—è¡¨è¿›è¡Œæ’åºã€‚å…ƒç»„åˆ™æ°æ°ç›¸åï¼Œå®ƒç»å¸¸ç”¨æ¥å­˜æ”¾ä¸åŒç±»å‹çš„çš„å…ƒç´ ã€‚è¿™ä¹Ÿç¬¦åˆå®ƒçš„æœ¬è´¨ï¼Œå…ƒç»„å°±æ˜¯ç”¨ä½œå­˜æ”¾å½¼æ­¤ä¹‹é—´æ²¡æœ‰å…³ç³»çš„æ•°æ®çš„è®°å½•ã€‚


## åˆ›å»ºä¸è®¿é—®å…ƒç´ 
### æ‰‹åŠ¨åˆå§‹åŒ–æ•°æ®
- [å…ƒç´ 1ï¼Œå…ƒç´ 2ï¼Œå…ƒç´ 3ï¼Œâ‹¯]ï¼šæŒ‡å®šå…·ä½“çš„åˆ—è¡¨å…ƒç´ ï¼Œå…ƒç´ ä¹‹é—´ä»¥é€—å·åˆ†éš”ï¼Œåˆ—è¡¨å…ƒç´ éœ€è¦ä½¿ç”¨ä¸­æ‹¬å·æ‹¬èµ·æ¥ã€‚
- ç´¢å¼•-1æŒ‡å‘æœ€åä¸€ä¸ªï¼Œ-2åˆ™æ˜¯å€’æ•°ç¬¬äºŒä¸ªï¼Œä»¥æ­¤ç±»æ¨
```
#!/usr/bin/python3
bicycles = ['trek', 'cannondale', 'redline', 'specialized']
print(bicycles)
print(bicycles[0])
print(bicycles[0].title())
print(bicycles[-1])
print(bicycles[-2])

message = f"My first bicycle was a {bicycles[0].title()}."
print(message)
[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
['trek', 'cannondale', 'redline', 'specialized']
trek
Trek
specialized
redline
My first bicycle was a Trek.
```
### ä½¿ç”¨rangeåˆå§‹åŒ–
```
#!/usr/bin/python3
for value in range(1, 6):	# äº§ç”Ÿåˆ—è¡¨[1,2,3,4,5]ï¼Œæ³¨æ„æ²¡æœ‰6
	print(value)
numbers = list(range(1, 6))	# äº§ç”Ÿåˆ—è¡¨èµ‹å€¼
print(numbers)
even_numbers = list(range(2, 11, 2))	# å¯ä»¥æŒ‡å®šæ­¥é•¿
print(min(even_numbers))
print(max(even_numbers))
print(sum(even_numbers))

squares = [value**2 for value in range(1, 11)] # ç±»ä¼¼perl mapæ–¹æ³•
print(squares)

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
1
2
3
4
5
[1, 2, 3, 4, 5]
2
10
30
[1, 4, 9, 16, 25, 36, 49, 64, 81, 100]
```
### ä½¿ç”¨*åˆå§‹åŒ–
ç”ŸæˆåŒ…å«nä¸ªæŒ‡å®šåˆå€¼å…ƒç´ çš„åˆ—è¡¨
```
sequence = [None] * 10  # [None, None, None, None, None, None, None, None, None, None]
```
### ä½¿ç”¨liståˆå§‹åŒ–
ä½¿ç”¨list(iterable)å°†å…¶ä»–æ•°æ®ç±»å‹è½¬æ¢æˆåˆ—è¡¨ï¼Œå‡½æ•°çš„å‚æ•°iterableæ˜¯å¯è¿­ä»£å¯¹è±¡ï¼ˆå­—ç¬¦ä¸²ã€åˆ—è¡¨ã€å…ƒç»„ã€é›†åˆå’Œå­—å…¸ç­‰ï¼‰ã€‚

- å­—ç¬¦ä¸²è½¬å­—ç¬¦åˆ—è¡¨
```
arr = list('Hello')
print(arr)	# ['H', 'e', 'l', 'l', 'o']

å¯ä»¥ä½¿ç”¨ ''.join(somelist) å†è¿èµ·æ¥
```
- åˆ›å»ºç©ºçš„åˆ—è¡¨
```
another_empty_list = list()
```
- å…ƒç¥–è½¬åˆ—è¡¨
```
a_tuple = ('ready', 'fire', 'aim')
print(list(a_tuple))
```
## ä½¿ç”¨=èµ‹å€¼ï¼ˆç±»ä¼¼å¼•ç”¨ï¼‰ï¼Œä½¿ç”¨copy()å¤åˆ¶
- å¦‚æœå°†ä¸€ä¸ªåˆ—è¡¨èµ‹å€¼ç»™äº†å¤šä¸ªå˜é‡ï¼Œæ”¹å˜å…¶ä¸­çš„ä»»ä½•ä¸€å¤„ä¼šé€ æˆå…¶ä»–å˜é‡å¯¹åº”çš„å€¼ä¹Ÿè¢«ä¿®æ”¹ï¼Œå³ä¸èƒ½ä½¿ç”¨ç­‰å·è¿›è¡Œå¤åˆ¶ï¼Œè§ä¸‹ä¾‹ï¼Œè¿™é‡Œçš„ç»“æœç±»ä¼¼å¼•ç”¨
```
#!/usr/bin/python3
my_foods = ['pizza', 'falafel', 'carrot cake']
friend_foods = my_foods
my_foods.append('cannoli')
print(my_foods)
print(friend_foods)

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
['pizza', 'falafel', 'carrot cake', 'cannoli']
['pizza', 'falafel', 'carrot cake', 'cannoli']
```
- ä½¿ç”¨åˆ‡ç‰‡æ–¹å¼[:]ä¸listæ–¹æ³•å¾—åˆ°çš„ä¹Ÿå“Ÿå¯èƒ½è¿˜æ˜¯æµ…æ‹·è´ï¼Œå–å†³äºåˆ—è¡¨æ˜¯å¦åµŒå¥—
- ä½¿ç”¨copyã€deepcopyè¿›è¡Œæ·±æ‹·è´è§£å†³é—®é¢˜
```
#!/usr/bin/python3
my_foods = ['pizza', 'falafel', 'carrot cake']

æ–¹æ³•1æœ‰å¯èƒ½è¿˜æ˜¯æµ…æ‹·è´ï¼š	friend_foods = my_foods[:]
æ–¹æ³•2ï¼š	friend_foods = my_foods.copy()
æ–¹æ³•3æœ‰å¯èƒ½è¿˜æ˜¯æµ…æ‹·è´ï¼š	friend_foods = list(my_foods)

my_foods.append('cannoli')
print(my_foods)
print(friend_foods)

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
['pizza', 'falafel', 'carrot cake', 'cannoli']
['pizza', 'falafel', 'carrot cake']
```
## åˆå¹¶ extend
- ä½¿ç”¨åŠ å·è¿æ¥ï¼Œäº§ç”Ÿæ–°çš„åˆ—è¡¨ï¼ŒåŸæœ‰åˆ—è¡¨ä¸å˜
- ä½¿ç”¨extendä¼šæ›´æ–°åŸæœ‰åˆ—è¡¨ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ +=
```
a = [1, 2, 3] 
b = [4, 5, 6] 
a.extend(b) # ç­‰äº a = a + bï¼Œä½†extendæ•ˆç‡é«˜ï¼Œä¹Ÿå¯ä»¥ a[len(a):] = b ï¼ˆä½†å¯è¯»æ€§å·®ï¼‰
print(a)	# [1, 2, 3, 4, 5, 6]
print(b)	# [4, 5, 6]
c = [7, 8, 9] 
d = b + c
print(b)	# [4, 5, 6]
print(c)	# [7, 8, 9]
print(d)	# [4, 5, 6, 7, 8, 9]
```
## å¢åˆ æ”¹æŸ¥
- append	æ·»åŠ å…ƒç´ è‡³å°¾éƒ¨
- insert	åœ¨æŒ‡å®šä½ç½®æ’å…¥å…ƒç´ 
- del	åˆ é™¤æŒ‡å®šä½ç½®çš„å…ƒç´ 
- remove	åˆ é™¤å…·æœ‰æŒ‡å®šå€¼çš„å…ƒç´ 
- pop	è·å–å¹¶åˆ é™¤æŒ‡å®šä½ç½®çš„å…ƒç´ 
```
#!/usr/bin/python3
motorcycles = []	# ç©ºåˆ—è¡¨
motorcycles.append('honda')	# æ·»åŠ åˆ°åˆ—è¡¨æœ«å°¾
motorcycles.append('yamaha')
motorcycles.append('suzuki')
print(motorcycles)
motorcycles[0] = 'ducati'	# ä¿®æ”¹å…ƒç´ 
print(motorcycles)
motorcycles.insert(1, 'aaa')	# æ’å…¥åˆ°æŒ‡å®šä½ç½®ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åˆ‡ç‰‡çš„æ’å…¥æ–¹å¼ï¼ˆå‚è€ƒåˆ‡ç‰‡æ“ä½œï¼‰
print(motorcycles)
del motorcycles[1]	# åˆ é™¤æŒ‡å®šç´¢å¼•çš„å…ƒç´ ï¼Œä½¿ç”¨popå¯ä»¥å¾—åˆ°åˆ é™¤çš„å€¼
print(motorcycles)
popped_motorcycle = motorcycles.pop()	# åˆ é™¤å¹¶è¿”å›æœ«å°¾å…ƒç´ ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šä½ç½®ï¼Œå¦‚ä¸‹
print(motorcycles)
print(popped_motorcycle)
first_owned = motorcycles.pop(0)
print(f"The first motorcycle I owned was a {first_owned.title()}.")

print("----------------")
motorcycles = ['honda', 'yamaha', 'suzuki', 'ducati']
motorcycles.remove('ducati')	# åˆ é™¤æŒ‡å®šå†…å®¹ï¼Œé»˜è®¤ä»…å»é™¤ç¬¬ä¸€ä¸ªï¼Œå…¨éƒ¨å»é™¤éœ€è¦å¾ªç¯ï¼Œå‚è€ƒä¸‹é¢
print(motorcycles)
```
å¾ªç¯å»é™¤æŒ‡å®šå…ƒç´ 
```
#!/usr/bin/python3
pets = ['dog', 'cat', 'dog', 'goldfish', 'cat', 'rabbit', 'cat']
print(pets)
while 'cat' in pets:
	pets.remove('cat')
print(pets)

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
['dog', 'cat', 'dog', 'goldfish', 'cat', 'rabbit', 'cat']
['dog', 'dog', 'goldfish', 'rabbit']
```
## æ¸…é™¤
```
numbers.clear() 
```
## æ’åºsortã€sorted
- åˆ—è¡¨æ–¹æ³• sort() ä¼šå¯¹åŸåˆ—è¡¨è¿›è¡Œæ’åºï¼Œæ”¹å˜åŸåˆ—è¡¨å†…å®¹
- é€šç”¨å‡½æ•° sorted() åˆ™ä¼šè¿”å›æ’å¥½åºçš„åˆ—è¡¨å‰¯æœ¬ï¼ŒåŸåˆ—è¡¨å†…å®¹ä¸å˜
- å‚æ•°reverseä¸ºtæ˜¯é™åºï¼Œé»˜è®¤f
- è¿˜æ”¯æŒä¸€ä¸ªkeyå›è°ƒç”¨äºè‡ªå®šä¹‰æ¯”è¾ƒæ–¹æ³•
```

fruits = ['grape', 'raspberry', 'apple', 'banana']
print(sorted(fruits))
print(fruits)
print(sorted(fruits, reverse=True))
print(sorted(fruits, key=len))	æ­¤å¤„ä½¿ç”¨é•¿åº¦è¿›è¡Œæ’åº
print(sorted(fruits, key=len, reverse=True))
print(fruits)
fruits.sort()
print(fruits)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/bbb/src/pyth.py"
['apple', 'banana', 'grape', 'raspberry']
['grape', 'raspberry', 'apple', 'banana']
['raspberry', 'grape', 'banana', 'apple']
['grape', 'apple', 'banana', 'raspberry']
['raspberry', 'banana', 'grape', 'apple']
['grape', 'raspberry', 'apple', 'banana']
['apple', 'banana', 'grape', 'raspberry']
```
## é¢ å€’ reversed
- reverseå°†æ‰€æœ‰å…ƒç´ ååºï¼ˆç›´æ¥ä¿®æ”¹åˆ—è¡¨ï¼‰
- reversed
```
#!/usr/bin/python3
cars = ['bmw', 'audi', 'toyota', 'subaru']
cars.reverse()
print(cars)
[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
['subaru', 'toyota', 'audi', 'bmw']
```

```
s = [4, 3, 6, 8, 3]
s2 = sorted(s)	# è¿”å›ä¸€ä¸ªåˆ—è¡¨
print(s)
print(s2)
s = 'Hello, world!'
s2 = sorted(s)
print(s)
print(s2)

s3 = list(reversed(s)) # reversedè¿”å›å¯è¿­ä»£å¯¹è±¡
print(s3)

s4 = ''.join(reversed(s)) 
print(s4)

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
[4, 3, 6, 8, 3]
[3, 3, 4, 6, 8]
Hello, world!
[' ', '!', ',', 'H', 'd', 'e', 'l', 'l', 'l', 'o', 'o', 'r', 'w']
['!', 'd', 'l', 'r', 'o', 'w', ' ', ',', 'o', 'l', 'l', 'e', 'H']
!dlrow ,olleH
```
## åˆ¤æ–­ç©ºåˆ—è¡¨
```
#!/usr/bin/python3
requested_toppings = []
if requested_toppings:
	for requested_topping in requested_toppings:
 		print(f"Adding {requested_topping}.")
else:
	print("Are you sure you want a plain pizza?")
```
## é•¿åº¦ len
```
cars = ['bmw', 'audi', 'toyota', 'subaru']
print(len(cars))
```
## ç»Ÿè®¡å‡ºç°æ¬¡æ•° count
è®¡ç®—æŒ‡å®šçš„å…ƒç´ åœ¨åˆ—è¡¨ä¸­å‡ºç°äº†å¤šå°‘æ¬¡
```
print(['to', 'be', 'or', 'not', 'to', 'be'].count('to'))
x = [[1, 2], 1, 1, [2, 1, [1, 2]]] 
print(x.count(1))
print(x.count([1, 2]))

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
2
2
1
```
## æˆå‘˜æµ‹è¯• inã€not in
è¡¨è¾¾å¼v in lï¼ˆå…¶ä¸­læ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼‰æŸ¥æ‰¾çš„æ˜¯å€¼è€Œä¸æ˜¯ç´¢å¼•
```
#!/usr/bin/python3
magicians = ['alice', 'david', 'carolina']
print('david' in magicians)
if 'xxx' not in magicians:
	print("not in")
```
åªè¦å…ƒç´ ç±»å‹ä¸€è‡´å³å¯è¿›è¡Œæ£€æµ‹
```
database = [ 
 ['albert', '1234'], 
 ['dilbert', '4242'], 
 ['smith', '7524'], 
 ['jones', '9843'] 
] 
username = 'smith'
pin = '7524'
if [username, pin] in database: print('Access granted')
```
## æŸ¥æ‰¾ index
åœ¨åˆ—è¡¨ä¸­æŸ¥æ‰¾æŒ‡å®šå€¼ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œä½†æ‰¾ä¸åˆ°åˆ™erräº†...éœ€è¦tryæ‰è¡Œ
```
knights = ['We', 'are', 'the', 'knights', 'who', 'say', 'ni'] 
print(knights.index('who')) 	# 4
knights.index('herring')	# err
```
## è½¬å­—ç¬¦ä¸²
```
marxes = ['Groucho', 'Chico', 'Harpo']
print(', '.join(marxes))

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pytest/pyth.py"
Groucho, Chico, Harpo
```
## éå†
- foreachå½¢å¼
```
#!/usr/bin/python3
magicians = ['alice', 'david', 'carolina']
for magician in magicians:
	print(f"{magician.title()}, that was a great trick!")
	print(f"I can't wait to see your next trick, {magician.title()}.\n")

print("Thank you, everyone. That was a great magic show!")


words = ['this', 'is', 'an', 'ex', 'parrot'] 
for word in words:
    print(word) 
for word in [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]:
 	print(word) 
for number in range(1,11):
    print(number) 
```
- enumerate  
  å³å¯ä»¥è·å¾—idxä¹Ÿèƒ½è·å¾—å…ƒç´ å†…å®¹ï¼Œæœ‰äº›æ—¶å€™å¯ä»¥ä»£æ›¿ä¸‹é¢çš„for
```
strings = "abcdefg"
for index, string in enumerate(strings): 
	print(index, string)

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
0 a
1 b
2 c
3 d
4 e
5 f
6 g
```
- forå½¢å¼
```
names = ['anne', 'beth', 'george', 'damon'] 
ages = [12, 45, 32, 102] 
for i in range(len(names)): 
	print(names[i], 'is', ages[i], 'years old') 
```
- whileå½¢å¼
```
#!/usr/bin/python3
# é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªå¾…éªŒè¯ç”¨æˆ·åˆ—è¡¨
 # å’Œä¸€ä¸ªç”¨äºå­˜å‚¨å·²éªŒè¯ç”¨æˆ·çš„ç©ºåˆ—è¡¨ã€‚
unconfirmed_users = ['alice', 'brian', 'candace']
confirmed_users = []
 # éªŒè¯æ¯ä¸ªç”¨æˆ·ï¼Œç›´åˆ°æ²¡æœ‰æœªéªŒè¯ç”¨æˆ·ä¸ºæ­¢ã€‚
 # å°†æ¯ä¸ªç»è¿‡éªŒè¯çš„ç”¨æˆ·éƒ½ç§»åˆ°å·²éªŒè¯ç”¨æˆ·åˆ—è¡¨ä¸­ã€‚
while unconfirmed_users:
	current_user = unconfirmed_users.pop()
	print(f"Verifying user: {current_user.title()}")
	confirmed_users.append(current_user)
# æ˜¾ç¤ºæ‰€æœ‰å·²éªŒè¯çš„ç”¨æˆ·ã€‚
print("\nThe following users have been confirmed:")
for confirmed_user in confirmed_users:
	print(confirmed_user.title())
```
## åˆ›å»ºåˆ‡ç‰‡
- ä½¿ç”¨åˆ‡ç‰‡ï¼ˆslicingï¼‰æ¥è®¿é—®ç‰¹å®šèŒƒå›´å†…çš„å…ƒç´ ã€‚ä¸¤ä¸ªç´¢å¼•æ¥æŒ‡å®šåˆ‡ç‰‡çš„è¾¹ç•Œ
- ç¬¬ä¸€ä¸ªç´¢å¼•æŒ‡å®šçš„å…ƒç´ åŒ…å«åœ¨åˆ‡ç‰‡å†…ï¼Œä½†ç¬¬äºŒä¸ªç´¢å¼•æŒ‡å®šçš„å…ƒç´ ä¸åŒ…å«åœ¨åˆ‡ç‰‡å†…ã€‚
- åˆ‡ç‰‡çš„æ­¥é•¿é»˜è®¤ä¸º1ï¼Œä½†ä¹Ÿå¯ä»¥è®¾ç½®
- åˆ‡ç‰‡éƒ½æ˜¯å‰¯æœ¬ï¼Œä¸åŸåˆ—è¡¨æ˜¯ä¸åŒå†…å­˜ï¼Œäº’ä¸å¹²æ¶‰
- åˆ—è¡¨çš„åˆ‡ç‰‡ä»ç„¶æ˜¯ä¸€ä¸ªåˆ—è¡¨

```
#!/usr/bin/python3
players = ['charles', 'martina', 'michael', 'florence', 'eli']
print(players[0:3])	# 0ã€1ã€2
print(players[1:4])	# 1ã€2ã€3
print(players[:4])	# å‰4ä¸ªï¼Œ0ã€1ã€2ã€3
print(players[2:])	# ä»ç¬¬3ä¸ªåˆ°æœ€åï¼Œä¸å«0ã€1çš„å…¶ä½™
print(players[-3:]) # æœ€å3ä¸ª

for player in players[:3]:	# éå†åˆ‡ç‰‡
	print(player.title())

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
['charles', 'martina', 'michael']
['martina', 'michael', 'florence']
['charles', 'martina', 'michael', 'florence']
['michael', 'florence', 'eli']
['michael', 'florence', 'eli']
Charles
Martina
Michael
```
## åˆ‡ç‰‡çš„æ­¥é•¿
```
#!/usr/bin/python3
numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] 
print(numbers)
print(numbers[0:10:2])	# ä»èµ·ç‚¹å’Œç»ˆç‚¹ä¹‹é—´æ¯éš”ä¸€ä¸ªå…ƒç´ æå–ä¸€ä¸ªå…ƒç´ 
print(numbers[::4])	# ä»åºåˆ—ä¸­æ¯éš”3ä¸ªå…ƒç´ æå–1ä¸ªï¼Œåªéœ€æä¾›æ­¥é•¿4å³å¯ã€‚
print(numbers[8:3:-1])
print(numbers[10:0:-2]) 
print(numbers[0:10:-2])
print(numbers[::-2])
print(numbers[5::-2]) 
print(numbers[:5:-2])

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
[1, 3, 5, 7, 9]
[1, 5, 9]
[9, 8, 7, 6, 5]
[10, 8, 6, 4, 2]
[]
[10, 8, 6, 4, 2]
[6, 4, 2]
[10, 8]
```
## åˆ‡ç‰‡çš„æ’å…¥ã€åˆ é™¤ã€æ›¿æ¢
- å¦‚æœèµ‹å€¼çš„å¯¹è±¡æ˜¯ä¸€ä¸ªåˆ‡ç‰‡ï¼Œé‚£ä¹ˆèµ‹å€¼è¯­å¥çš„å³ä¾§å¿…é¡»æ˜¯ä¸ªå¯è¿­ä»£å¯¹è±¡ã€‚
- å³ä¾¿åªæœ‰å•ç‹¬ä¸€ä¸ªå€¼ï¼Œä¹Ÿè¦æŠŠå®ƒè½¬æ¢æˆå¯è¿­ä»£çš„åºåˆ—ã€‚
```
#!/usr/bin/python3
name = list('Perl')
name[1:] = list('ython') # ç›¸å½“äºæ›¿æ¢nä¸ªè¿ç»­çš„å…ƒç´ ï¼Œä¸”æ— éœ€æ•°é‡ä¸€è‡´
print(name)	# ['P', 'y', 't', 'h', 'o', 'n']


numbers = [1, 5] 
numbers[1:1] = [2, 3, 4] # ç›¸å½“äºæ’å…¥nä¸ªå…ƒç´ ï¼ˆå¯è¯»æ€§æ¯”ä½¿ç”¨insertå·®å¾ˆå¤šï¼‰
print(numbers) # [1, 2, 3, 4, 5]
numbers[1:4] = []  # ç›¸å½“äºåˆ é™¤è¿ç»­çš„nä¸ªå…ƒç´ ï¼Œè¿™é‡Œè¿˜åŠ å…¥æ­¥é•¿ï¼ˆå¤§äº1æˆ–è´Ÿæ•°çš„æ­¥é•¿ï¼‰ï¼Œé‚£å°±å¯ä»¥è·³è·ƒæ¸…é™¤äº†
print(numbers)	# [1, 5]
```

## maxã€min

è¿”å›åˆ—è¡¨å…ƒç´ æœ€å¤§å€¼ã€æœ€å°å€¼
```
list_num=[2,3,5,6,8,12]
max(list_num)
```

## zip
- ä¾¿äºåŒæ—¶è¿­ä»£nä¸ªåˆ—è¡¨
- è¿”å›ç”±å…ƒç»„ç»„æˆçš„å¯è¿­ä»£åºåˆ—
- å¯ä½¿ç”¨listå°†å…¶è½¬æ¢ä¸ºåˆ—è¡¨
- å¯ä½¿ç”¨dictå°†å…¶è½¬æ¢ä¸ºå­—å…¸

```
names = ['anne', 'beth', 'george', 'damon'] 
ages = [12, 45, 32, 102] 
for name, age in zip(names, ages): 
	print(name, 'is', age, 'years old') 

print(list(zip(range(5), range(100000000))))

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
anne is 12 years old
beth is 45 years old
george is 32 years old
damon is 102 years old
[(0, 0), (1, 1), (2, 2), (3, 3), (4, 4)]
```
```
english = 'Monday', 'Tuesday', 'Wednesday'
french = 'Lundi', 'Mardi', 'Mercredi'
print(list(zip(english, french)))
print(dict(zip(english, french)))

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pytest/pyth.py"
[('Monday', 'Lundi'), ('Tuesday', 'Mardi'), ('Wednesday', 'Mercredi')]
{'Monday': 'Lundi', 'Tuesday': 'Mardi', 'Wednesday': 'Mercredi'}
```
# å…ƒç»„ ( ) tuple
- å…ƒç»„ç»å¸¸ç”¨æ¥å­˜æ”¾ä¸åŒç±»å‹çš„çš„å…ƒç´ ã€‚è¿™ä¹Ÿç¬¦åˆå®ƒçš„æœ¬è´¨ï¼Œå…ƒç»„å°±æ˜¯ç”¨ä½œå­˜æ”¾å½¼æ­¤ä¹‹é—´æ²¡æœ‰å…³ç³»çš„æ•°æ®çš„è®°å½•ã€‚
- ä¸åˆ—è¡¨ç±»ä¼¼ï¼Œå…ƒç»„ä¹Ÿæ˜¯ç”±ä»»æ„ç±»å‹å…ƒç´ ç»„æˆçš„åºåˆ—ã€‚
- ä¸åˆ—è¡¨ä¸åŒçš„æ˜¯ï¼Œå…ƒç»„æ˜¯ä¸å¯å˜çš„ï¼Œè¿™æ„å‘³ç€ä¸€æ—¦å…ƒç»„è¢«å®šä¹‰ï¼Œå°†æ— æ³•å†è¿›è¡Œå¢åŠ ã€åˆ é™¤æˆ–ä¿®æ”¹å…ƒç´ ç­‰æ“ä½œã€‚å› æ­¤ï¼Œå…ƒç»„å°±åƒæ˜¯ä¸€ä¸ªå¸¸é‡åˆ—è¡¨ã€‚
- ä¸è¦æŠŠå¯å˜å¯¹è±¡æ”¾åœ¨å…ƒç»„é‡Œé¢ã€‚
- ä½¿ç”¨åœ†æ‹¬å·å®šä¹‰
- ç©ºå…ƒç»„ç”¨ä¸¤ä¸ªä¸åŒ…å«ä»»ä½•å†…å®¹çš„åœ†æ‹¬å·è¡¨ç¤º
- ä¸€ä¸ªå€¼çš„å…ƒç»„è¦æœ‰é€—å·
- å…ƒç»„çš„åˆ‡ç‰‡è¿˜æ˜¯å…ƒç»„
- å…ƒç»„å ç”¨çš„ç©ºé—´è¾ƒå°
- å¯ä»¥å°†å…ƒç»„ç”¨ä½œå­—å…¸çš„é”®
- å‡½æ•°çš„å‚æ•°æ˜¯ä»¥å…ƒç»„å½¢å¼ä¼ é€’çš„
- å‘½åå…ƒç»„å¯ä»¥ä½œä¸ºå¯¹è±¡çš„æ›¿ä»£
- å…ƒç»„ä¸å¤šæ•° Python é›†åˆï¼ˆåˆ—è¡¨ã€å­—å…¸ã€é›†ï¼Œç­‰ç­‰ï¼‰ä¸€æ ·ï¼Œä¿å­˜çš„æ˜¯å¯¹è±¡çš„å¼•ç”¨ã€‚

```
#!/usr/bin/python3
dimensions = (200, 50)	# å®šä¹‰tuple
print(dimensions[0])	# å–å…ƒç´ 
print(dimensions[1])
# dimensions[0] = 250 	ä¸èƒ½ä¿®æ”¹å…ƒç´ 
dimensions = (400, 100)	# èƒ½é‡æ–°å…¨éƒ¨èµ‹å€¼
print(dimensions)	
for dimension in dimensions:	# éå†
	print(dimension)
```

## ä½¿ç”¨()åˆ›å»ºå…ƒç»„
ï¼ˆå…ƒç´ 1ï¼Œå…ƒç´ 2ï¼Œå…ƒç´ 3ï¼Œâ‹¯ï¼‰ï¼šæŒ‡å®šå…·ä½“çš„å…ƒç»„å…ƒç´ ï¼Œå…ƒç´ ä¹‹é—´ä»¥é€—å·åˆ†éš”ã€‚å¯¹äºå…ƒç»„å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨å°æ‹¬å·æ‹¬èµ·æ¥ï¼Œä¹Ÿå¯ä»¥çœç•¥å°æ‹¬å·ã€‚

```
empty_tuple = ()	# å¯ä»¥ç”¨ () åˆ›å»ºä¸€ä¸ªç©ºå…ƒç»„
print(empty_tuple)
one_marx = 'Groucho',	# åˆ›å»ºåªåŒ…å«ä¸€ä¸ªå…ƒç´ çš„å…ƒç¥–è¦æœ‰é€—å·ã€‚å®šä¹‰å…ƒç»„çœŸæ­£é çš„æ˜¯æ¯ä¸ªå…ƒç´ çš„åç¼€é€—å·ï¼Œè€Œä¸æ˜¯ï¼ˆï¼‰
print(one_marx)
marx_tuple = 'Groucho', 'Chico', 'Harpo'	# åˆ›å»ºçš„å…ƒç»„æ‰€åŒ…å«çš„å…ƒç´ æ•°é‡è¶…è¿‡ 1ï¼Œæœ€åä¸€ä¸ªå…ƒç´ åé¢çš„é€—å·å¯ä»¥çœç•¥
print(marx_tuple)
a, b, c = marx_tuple	# å°†å…ƒç»„èµ‹å€¼ç»™å¤šä¸ªå˜é‡
print(a)
print(b)
print(c)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pytest/pyth.py"
()
('Groucho',)
('Groucho', 'Chico', 'Harpo')
Groucho
Chico
Harpo

```
## æ‰“å°å…ƒç´ 
```
lax_coordinates = (33.9425, -118.408056)
city, year, pop, chg, area = ('Tokyo', 2003, 32450, 0.66, 8014)
traveler_ids = [('USA', '31195855'), ('BRA', 'CE342567'), ('ESP', 'XDA205856')]
for passport in sorted(traveler_ids):
	print('%s/%s' % passport)		# passportä»£è¡¨æ¯ä¸ªå…ƒç»„, %èƒ½åŒ¹é…åˆ°å¯¹åº”çš„å…ƒç»„å…ƒç´ ä¸Š
for country, _ in traveler_ids:		# å…ƒç¥–æ‹†åŒ…åçš„ç¬¬äºŒä¸ªå…ƒç´ æ²¡æœ‰ï¼Œç”¨å ä½ç¬¦ä»£æ›¿
	print(country)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/bbb/src/pyth.py"
BRA/CE342567
ESP/XDA205856
USA/31195855
USA
BRA
ESP
```

## æ‹†åŒ…
å¯è®¤ä¸ºåˆ›å»ºå…ƒç¥–ä¸ºæ‰“åŒ…ï¼Œåæ“ä½œå³ä¸ºæ‹†åŒ…ã€‚å°†å…ƒç¥–è§£åŒ…ï¼Œå¹¶å°†å¾—åˆ°çš„å€¼å­˜å‚¨åˆ°ä¸€ç³»åˆ—å˜é‡ä¸­ã€‚å¯ç”¨äº  
- å¹¶è¡Œèµ‹å€¼
- äº¤æ¢å˜é‡å€¼
- å°†åºåˆ—èµ‹å€¼ç»™å…ƒç¥–values
- è§£å¼€å…ƒç¥–åˆ°å¤šä¸ªå˜é‡
- ä½¿ç”¨*æ¥æ”¶å¤šä¸ªå€¼åˆ°åˆ—è¡¨ä¸­ï¼Œ*å¥æ³•è®©å…ƒç»„æ‹†åŒ…çš„ä¾¿åˆ©æ€§æ›´ä¸Šä¸€å±‚æ¥¼ï¼Œè®©ç”¨æˆ·å¯ä»¥é€‰æ‹©æ€§å¿½ç•¥ä¸éœ€è¦çš„å­—æ®µ
- å‡½æ•°å‚æ•°ä¼ é€’ï¼ˆä¸»è¦æ˜¯ä¸Šä¸€ç§æ–¹å¼ï¼‰
- å‡½æ•°å¯ä»¥ç”¨å…ƒç»„çš„å½¢å¼è¿”å›å¤šä¸ªå€¼

```
x, y, z = 1, 2, 3 # å¹¶è¡Œèµ‹å€¼
print(x, y, z) 
x, y = y, x	# äº¤æ¢å˜é‡å€¼
print(x, y) 
values = 10, 20, 30 # å°†åºåˆ—èµ‹å€¼ç»™å…ƒç¥–values
print(values)
x, y, z = values # è§£å¼€å…ƒç¥–åˆ°å¤šä¸ªå˜é‡
print(x, y, z) 

scoundrel = {'name': 'Robin', 'girlfriend': 'Marion'} 
key, value = scoundrel.popitem() # è¿”å›å…ƒç¥–èµ‹å€¼ç»™kå’Œv
print(key, value)
a, b, *rest = [1, 2, 3, 4] 	# å¯ä½¿ç”¨æ˜Ÿå·è¿ç®—ç¬¦ï¼ˆ*ï¼‰æ¥æ”¶é›†å¤šä½™çš„å€¼ï¼Œè¿™æ ·æ— éœ€ç¡®ä¿å€¼å’Œå˜é‡çš„ä¸ªæ•°ç›¸åŒï¼Œrestä¸ºåˆ—è¡¨
print(rest)

name = "Albus Percival Wulfric Brian Dumbledore" 
first, *middle, last = name.split() # *å˜é‡ä¹Ÿå¯åœ¨å…¶ä»–ä½ç½®
print(middle)

a, *b, c = "abc" # å¸¦æ˜Ÿå·çš„å˜é‡å§‹ç»ˆä¹Ÿæ˜¯åˆ—è¡¨ï¼Œå³ä½¿å…ƒç´ ä»…1ä¸ª
print(a, b, c)

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
1 2 3
2 1
(10, 20, 30)
10 20 30
girlfriend Marion
[3, 4]
['Percival', 'Wulfric', 'Brian']
a ['b'] c
```

## æ‹†åŒ…åµŒå¥—å…ƒç»„

```
metro_areas = [
	('Tokyo','JP',36.933,(35.689722,139.691667)),
	('Delhi NCR', 'IN', 21.935, (28.613889, 77.208889)),
	('Mexico City', 'MX', 20.142, (19.433333, -99.133333)),
	('New York-Newark', 'US', 20.104, (40.808611, -74.020386)),
	('Sao Paulo', 'BR', 19.649, (-23.547778, -46.635833)),
]
print('{:15} | {:^9} | {:^9}'.format('', 'lat.', 'long.'))
fmt = '{:15} | {:9.4f} | {:9.4f}'
for name, cc, pop, (latitude, longitude) in metro_areas:
	if longitude <= 0:
		print(fmt.format(name, latitude, longitude))

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/bbb/src/pyth.py"
                |   lat.    |   long.  
Mexico City     |   19.4333 |  -99.1333
New York-Newark |   40.8086 |  -74.0204
Sao Paulo       |  -23.5478 |  -46.6358

```
## ä½¿ç”¨tuple()åˆ›å»ºå…ƒç»„

å‡½æ•°tupleçš„å·¥ä½œåŸç†ä¸listå¾ˆåƒï¼šå®ƒå°†ä¸€ä¸ªåºåˆ—ï¼ˆå­—ç¬¦ä¸²ã€åˆ—è¡¨ã€å…ƒç»„ã€é›†åˆå’Œå­—å…¸ç­‰ï¼‰ä½œä¸ºå‚æ•°ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºå…ƒç»„ã€‚å¦‚æœå‚æ•°
å·²ç»æ˜¯å…ƒç»„ï¼Œå°±åŸå°ä¸åŠ¨åœ°è¿”å›å®ƒã€‚
```
print(3 * (40 + 2))	# è¿™ä¸ªä¸æ˜¯å…ƒç¥–ï¼Œå› ä¸ºæ²¡æœ‰é€—å·
print(3 * (40 + 2,))
print(tuple([1, 2, 3]))
print(tuple('abc'))
print(tuple((1, 2, 3)))
x = 1, 2, 3
print(x[0:2])

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
126
(42, 42, 42)
(1, 2, 3)
('a', 'b', 'c')
(1, 2, 3)
(1, 2)
```

## å…ƒç»„çš„ç›¸å¯¹ä¸å¯å˜æ€§
- ä¸‹é¢çš„æè¿°è²Œä¼¼çœ¼ç†Ÿï¼Œè¯¦è§ä»£ç è¯´æ˜ï¼Œæ„Ÿè§‰å°±åƒæ˜¯æ”¹å˜å¸¸é‡æŒ‡é’ˆæŒ‡å‘çš„å†…å®¹ã€‚ã€‚ã€‚
- å…ƒç»„ä¸å¤šæ•° Python é›†åˆï¼ˆåˆ—è¡¨ã€å­—å…¸ã€é›†ï¼Œç­‰ç­‰ï¼‰ä¸€æ ·ï¼Œä¿å­˜çš„æ˜¯å¯¹è±¡çš„å¼•ç”¨ã€‚1 å¦‚æœå¼•ç”¨çš„å…ƒç´ æ˜¯å¯å˜çš„ï¼Œå³ä¾¿å…ƒç»„æœ¬èº«ä¸å¯å˜ï¼Œå…ƒç´ ä¾ç„¶å¯å˜ã€‚
```
t1 = (1, 2, [30, 40])
t2 = (1, 2, [30, 40])
print(t1 == t2)		# è™½ç„¶ t1 å’Œ t2 æ˜¯ä¸åŒçš„å¯¹è±¡ï¼Œä½†æ˜¯äºŒè€…ç›¸ç­‰ï¼Œå› ä¸º==æ¯”å€¼
print(id(t1[-1]))
t1[-1].append(99)	# é‡ç‚¹åœ¨æ­¤ï¼Œt1 ä¸å¯å˜ï¼Œä½†æ˜¯ t1[-1] å¯å˜ã€‚å³t1[-1] çš„æ ‡è¯†æ²¡å˜ï¼Œåªæ˜¯å€¼å˜äº†ã€‚ï¼ˆå¯ä»¥ç†è§£ä¸ºæ ˆä¸Šçš„æŒ‡é’ˆæ²¡æŒ‡å‘åˆ«å¤„ï¼Œä½†æ˜¯å †ä¸Šçš„æ•°æ®å˜äº†ï¼‰
print(t1)
print(id(t1[-1]))
print(t1 == t2)

[huawei@n161 aaa]$ python3 test.py 
True
140324783818056
(1, 2, [30, 40, 99])
140324783818056
False
```
## del åˆ é™¤

ç”±äºå…ƒç»„çš„ä¸å¯ä¿®æ”¹æ€§ï¼Œæ‰€ä»¥å…ƒç»„ä¸­çš„å…ƒç´ å€¼æ˜¯ä¸å…è®¸åˆ é™¤çš„ï¼Œä½†å¯ä»¥ä½¿ç”¨ del è¯­å¥æ¥åˆ é™¤æ•´ä¸ªå…ƒç»„

```
tup1 = ('baidu', 'google',1,2)
print(tup1)
del tup1;
print("åˆ é™¤åçš„å…ƒç»„ tup : ")
print(tup1)

[huawei@n161 ccc]$ python3 1.py
('baidu', 'google', 1, 2)
åˆ é™¤åçš„å…ƒç»„ tup : 
Traceback (most recent call last):
  File "1.py", line 9, in <module>
```

# å­—å…¸ { } dict
- å­—å…¸ç”±é”®åŠå…¶ç›¸åº”çš„å€¼ç»„æˆï¼Œè¿™ç§é”®å€¼å¯¹ç§°ä¸ºé¡¹ï¼ˆitemï¼‰ã€‚
- æ¯ä¸ªé”®ä¸å…¶å€¼ä¹‹é—´éƒ½ç”¨å†’å·ï¼ˆ:ï¼‰åˆ†éš”ï¼Œé¡¹ä¹‹é—´ç”¨é€—å·åˆ†éš”ï¼Œè€Œæ•´ä¸ªå­—å…¸æ”¾åœ¨èŠ±æ‹¬å·å†…ã€‚
- ç©ºå­—å…¸ï¼ˆæ²¡æœ‰ä»»ä½•é¡¹ï¼‰ç”¨ä¸¤ä¸ªèŠ±æ‹¬å·è¡¨ç¤ºï¼Œç±»ä¼¼äºä¸‹é¢è¿™æ ·ï¼š{}ã€‚
- åœ¨å­—å…¸ï¼ˆä»¥åŠå…¶ä»–æ˜ å°„ç±»å‹ï¼‰ä¸­ï¼Œé”®å¿…é¡»æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œè€Œå­—å…¸ä¸­çš„å€¼æ— éœ€å¦‚æ­¤ã€‚
- å­—å…¸çš„é”®å¿…é¡»ä¸ºä¸å¯å˜å¯¹è±¡ï¼Œå› æ­¤åˆ—è¡¨ã€å­—å…¸ä»¥åŠé›†åˆéƒ½ä¸èƒ½ä½œä¸ºå­—å…¸çš„é”®ï¼Œä½†å…ƒç»„å¯ä»¥ä½œä¸ºå­—å…¸çš„é”®
- å­—å…¸æ˜¯Pythonä¸­å”¯ä¸€çš„å†…ç½®æ˜ å°„ç±»å‹ï¼Œå…¶ä¸­çš„å€¼ä¸æŒ‰é¡ºåºæ’åˆ—ï¼Œè€Œæ˜¯å­˜å‚¨åœ¨é”®ä¸‹ã€‚é”®å¯èƒ½æ˜¯æ•°ã€å­—ç¬¦ä¸²æˆ–å…ƒç»„ï¼ˆå³kå¾—æ˜¯ä¸å¯å˜çš„ç±»å‹ï¼‰ã€‚
- æ‰€æœ‰çš„å­—å…¸æ–¹æ³•è§æµç¨‹çš„python3.3
## æ„å»ºæ–¹æ³•
- ä½¿ç”¨dictæ–¹æ³•
- {key1ï¼švalue1ï¼Œkey2ï¼švalue2ï¼Œ...ï¼Œkey_nï¼švalue_n}ï¼šæŒ‡å®šå…·ä½“çš„å­—å…¸é”®å€¼å¯¹ï¼Œé”®å€¼å¯¹ä¹‹é—´ä»¥é€—å·åˆ†éš”ï¼Œæœ€åç”¨å¤§æ‹¬å·æ‹¬èµ·æ¥ã€‚
- ä½¿ç”¨dict.fromkeysæ„å»ºæ‰€æœ‰véƒ½ä¸€æ ·çš„å­—å…¸
```
# dictï¼ˆtupleåˆ—è¡¨å½¢å¼ï¼‰,tupleå¿…é¡»2ä¸ªå…ƒç´ ï¼Œå¦åˆ™å¤±è´¥
items = [('name', 'Gumby'), ('age', 42)] 
d = dict(items)  
print(d)	# {'name': 'Gumby', 'age': 42}
print(d['name'])	# Gumby

# dictï¼ˆåµŒå¥—åˆ—è¡¨å½¢å¼ï¼‰,å†…éƒ¨åˆ—è¡¨åªèƒ½2ä¸ªå…ƒç´ ï¼Œå¦åˆ™å¤±è´¥
lol = [ ['a', 'b'], ['c', 'd'], ['e', 'f'] ] 
m = dict(lol)
print(m)	# {'a': 'b', 'c': 'd', 'e': 'f'}

# ä½¿ç”¨dictæ–¹æ³•æ„å»ºï¼Œkvå½¢å¼ï¼Œkvè¦é½å…¨ï¼Œå¦åˆ™å¤±è´¥
d = dict(name='Gumby', age=42) 	
print(d) # {'name': 'Gumby', 'age': 42}

empty_dict = {} # ç©ºå­—å…¸

# ä½¿ç”¨é”®å€¼å¯¹æ–¹å¼æ„å»ºï¼Œkvè¦é½å…¨ï¼Œå¦åˆ™å‡ºé”™
phonebook = {'Alice': '2341', 'Beth': '9102', 'Cecil': '3258'}
print(phonebook)	# {'Alice': '2341', 'Beth': '9102', 'Cecil': '3258'}


# åŒå­—ç¬¦çš„å­—ç¬¦ä¸²ç»„æˆçš„åˆ—è¡¨ï¼Œåªèƒ½2ä¸ªå­—ç¬¦ï¼Œå¦åˆ™å‡ºé”™
m = [ 'ab', 'cd', 'ef' ]
print(dict(m))	# {'a': 'b', 'c': 'd', 'e': 'f'}

# åŒå­—ç¬¦çš„å­—ç¬¦ä¸²ç»„æˆçš„å…ƒç»„ï¼Œåªèƒ½2ä¸ªå­—ç¬¦ï¼Œå¦åˆ™å‡ºé”™
m = ( 'ab', 'cd', 'ef' )
print(dict(m))	# {'a': 'b', 'c': 'd', 'e': 'f'}


# ä½¿ç”¨dict.fromkeys
print(dict.fromkeys(['name', 'age']))	# {'name': None, 'age': None}
print(dict.fromkeys(['name', 'age'], '(unknown)'))	# {'name': '(unknown)', 'age': '(unknown)'}
```
## è®¿é—®ã€ã€‘ã€get
- [ ]
	è®¿é—®ä¸å­˜åœ¨çš„å…ƒç´ ä¼šerror
- get
	å®‰å…¨çš„è·å–å…ƒç´ æ–¹å¼ï¼Œæ²¡æœ‰åˆ™è¿”å›æŒ‡å®šçš„å­—ç¬¦ä¸²
- setdefault
	è·å–ä¸æŒ‡å®šé”®ç›¸å…³è”çš„å€¼ï¼Œå­—å…¸ä¸åŒ…å«æŒ‡å®šçš„é”®æ—¶ï¼Œåœ¨å­—å…¸ä¸­æ·»åŠ æŒ‡å®šçš„é”®å€¼å¯¹ã€‚ä¹Ÿå¯æŒ‡å®šé»˜è®¤çš„å­—ç¬¦ä¸²ä½œä¸ºvï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œé»˜è®¤vä¸ºNoneã€‚
```
#!/usr/bin/python3
alien_0 = {'color': 'green', 'points': 5}		# å®šä¹‰å­—å…¸
print(alien_0['color'])		# green,	è®¿é—®å…ƒç´ 
# print(alien_0['color1'])	è®¿é—®ä¸å­˜åœ¨çš„å…ƒç´ ä¼šerrorï¼Œä¸‹å¥ä½¿ç”¨getè¿›è¡Œå®‰å…¨è®¿é—®
point_value = alien_0.get('not', 'No point value assigned.') # å®‰å…¨çš„è·å–å…ƒç´ æ–¹å¼ï¼Œæ²¡æœ‰åˆ™è¿”å›ç¬¬äºŒä¸ªå­—ç¬¦ä¸²
print(point_value)	# No point value assigned.		
print(alien_0)	# {'color': 'green', 'points': 5}
point_value  = alien_0.setdefault('not')	# æ²¡æœ‰æ‰¾åˆ°å°±æ·»åŠ åˆ°å­—å…¸ä¸­
print(point_value)	# None
print(alien_0)	# {'color': 'green', 'points': 5, 'not': None}
```
## å¢åˆ æ”¹æŸ¥
- del	åˆ é™¤å…·æœ‰æŒ‡å®šé”®çš„å…ƒç´ 

```
#!/usr/bin/python3
alien_0 = {'color': 'green', 'points': 5}		# å®šä¹‰å­—å…¸
print(alien_0)
alien_0['x_position'] = 0		# æ·»åŠ å…ƒç´ 
alien_0['y_position'] = 25
print(alien_0)

alien_0 = {}			# åˆ›å»ºç©ºå­—å…¸ï¼Œè¿™é‡Œå…¶å®æ˜¯æŠŠä¸Šé¢çš„å­—å…¸æ¸…äº†
alien_0['color'] = 'green'
alien_0['points'] = 5
print(alien_0)
alien_0['color'] = 'yellow'		# ä¿®æ”¹å…ƒç´ 
print(f"The alien is now {alien_0['color']}.")
del alien_0['points']		# åˆ é™¤å…ƒç´ ï¼Œåˆ é™¤è¿˜æœ‰pop
print(alien_0)


[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
{'color': 'green', 'points': 5}
{'color': 'green', 'points': 5, 'x_position': 0, 'y_position': 25}
{'color': 'green', 'points': 5}
The alien is now yellow.
{'color': 'yellow'}
```
## åˆå¹¶ update
å¯ä»¥å°†ä¸€ä¸ªå­—å…¸çš„é”®å€¼å¯¹å¤åˆ¶åˆ°å¦ä¸€ä¸ªå­—å…¸ä¸­å»ã€‚å­—å…¸æœ‰æ­¤kåˆ™æ›´æ–°vï¼Œæ²¡æœ‰kåˆ™æ·»åŠ åˆ°å­—å…¸é‡Œ
```
d = { 
'title': 'Python Web Site', 
'url': 'http://www.python.org', 
'changed': 'Mar 14 22:09:15 MET 2016' 
} 

x = {'title': 'Python Language Website'} 
d.update(x)
print(d);

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
{'title': 'Python Language Website', 'url': 'http://www.python.org', 'changed': 'Mar 14 22:09:15 MET 2016'}
```
## popã€popitem
```
phonebook = {'Alice': '2341', 'Beth': '9102', 'Cecil': '3258'}
print(phonebook.pop('Beth'))	# 9102	è¿”å›æŒ‡å®škè¿›è¡Œpopçš„v
print(phonebook)	# {'Alice': '2341', 'Cecil': '3258'}	å‰©ä½™2ä¸ªkv
print(phonebook.popitem())	# ('Cecil', '3258')	è¿”å›éšæœºpopçš„kvï¼Œè¿”å›å€¼æ˜¯å…ƒç¥–ï¼Œä½†æµ‹è¯•æ¯æ¬¡éƒ½ç›¸åŒ
print(phonebook)	# {'Alice': '2341'}		å‰©ä½™1ä¸ªkv
key, value = phonebook.popitem() # å°†popçš„å…ƒç¥–èµ‹å€¼ç»™kå’Œv
print(key, value)

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
{'Alice': '2341', 'Cecil': '3258'}
('Cecil', '3258')
{'Alice': '2341'}
Alice 2341
```

## å­—å…¸è§†å›¾ items
-	è¿”å›å€¼å±äºä¸€ç§åä¸ºå­—å…¸è§†å›¾çš„ç‰¹æ®Šç±»å‹ã€‚å­—å…¸è§†å›¾å¯ç”¨äºè¿­ä»£ï¼Œè¿˜å¯æ‰§è¡Œlenä¸inæ£€æµ‹ã€‚å…¶ä¸­æ¯ä¸ªå…ƒç´ éƒ½ä¸ºé”®å€¼å¯¹ï¼Œä¸”é¡ºåºä¸ç¡®å®šã€‚
-	ä¿®æ”¹å­—å…¸åè§†å›¾ä¼šåŒæ­¥ï¼Œä½†è§†å›¾æ˜¯åªè¯»çš„ä¸å…è®¸ä¿®æ”¹
```
phonebook = {'Alice': '2341', 'Beth': '9102', 'Cecil': '3258'}
pairs = phonebook.items() 
print("ä¿®æ”¹å‰")
print(pairs)
print(len(pairs))
print(phonebook)
print(('Beth', '9102') in pairs)
print(phonebook.get('Beth', "not find") == '9102');


print("ä¿®æ”¹å­—å…¸å")
phonebook['Beth'] = '9999'
print(pairs)
print(phonebook)
print(('Beth', '9102') in pairs)
print(phonebook.get('Beth', "not find") == '9102');

print("ä¿®æ”¹è§†å›¾å")
pairs[1] = ('Beth', '0000')  ä¸æ”¯æŒèµ‹å€¼
print(pairs)
print(phonebook)

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
ä¿®æ”¹å‰
dict_items([('Alice', '2341'), ('Beth', '9102'), ('Cecil', '3258')])
3
{'Alice': '2341', 'Beth': '9102', 'Cecil': '3258'}
True
True
ä¿®æ”¹å­—å…¸å
dict_items([('Alice', '2341'), ('Beth', '9999'), ('Cecil', '3258')])
{'Alice': '2341', 'Beth': '9999', 'Cecil': '3258'}
False
False
ä¿®æ”¹è§†å›¾å
Traceback (most recent call last):
  File "/home/huawei/playground/pythontest/pyth.py", line 20, in <module>
    pairs[1] = ('Beth', '0000')
TypeError: 'dict_items' object does not support item assignment
```
## éå† keysã€valuesã€itemsã€sortã€set
- keys
  	è·å–ä»…åŒ…å«å­—å…¸ä¸­çš„é”®çš„è§†å›¾ï¼ˆdict_keys()ï¼Œå®ƒæ˜¯é”®çš„è¿­ä»£å½¢å¼ï¼‰
- values
	è¿”å›ä¸€ä¸ªç”±å­—å…¸ä¸­çš„å€¼ç»„æˆçš„å­—å…¸è§†å›¾ï¼Œå¦‚æœå­—å…¸ä¸­æœ‰é‡å¤çš„våˆ™è§†å›¾ä¸­ä¹ŸåŒ…å«è¿™äº›é‡å¤å†…å®¹ã€‚
- items
  	å‡½æ•°å¯ä»¥è·å–å­—å…¸ä¸­æ‰€æœ‰çš„é”®å€¼å¯¹
- keysã€valuesã€itemsçš„è¿”å›ç»“æœå‡å¯ä½œä¸ºlist()æ–¹æ³•çš„å‚æ•°ï¼Œè¿”å›åˆ—è¡¨

```
d = {'x': 1, 'y': 2, 'z': 3} 
for key in d: 
	print(key, 'corresponds to', d[key]) 
for key, value in d.items(): 
	print(key, 'corresponds to', value) 

```

```
#!/usr/bin/python3
favorite_languages = {
	'jen': 'python',
	'sarah': 'c',
	'edward': 'ruby',
	'phil': 'python',
}
for name, language in favorite_languages.items():	# éå†kv
	print(f"{name.title()}'s favorite language is {language.title()}.")
for name in favorite_languages.keys():		# éå†k
	print(name.title())
for name in sorted(favorite_languages.keys()):	# å¯¹è¿”å›çš„keysæ’åºåå†éå†
 	print(f"{name.title()}, thank you for taking the poll.") 
if 'erin' not in favorite_languages.keys():	# åˆ¤æ–­å­˜åœ¨kï¼Œæ­¤å¤„æ˜¯æ£€æµ‹ä¸€ä¸ªå€¼åœ¨ä¸åœ¨åˆ—è¡¨é‡Œï¼Œéæ£€æµ‹k in d
	print("Erin, please take our poll!")

for language in favorite_languages.values():	# éå†values
	print(language.title())
for language in set(favorite_languages.values()):	# å¯¹è¿”å›çš„valuesé›†åˆè¿›è¡Œå»é‡åå†éå†
	print(language.title())


```


## æ£€æµ‹Kã€vå­˜åœ¨ in
è¡¨è¾¾å¼k in dï¼ˆå…¶ä¸­dæ˜¯ä¸€ä¸ªå­—å…¸ï¼‰æŸ¥æ‰¾çš„æ˜¯é”®è€Œä¸æ˜¯å€¼ï¼Œå¦‚ä¸‹é¢çš„æ£€æµ‹kã€væ–¹å¼

- 'name' in spam.keys()
- 'Zophie' in spam.values()

```
phonebook = {'Alice': '2341', 'Beth': '9102', 'Cecil': '3258'}	# ä½¿ç”¨é”®å€¼å¯¹æ–¹å¼æ„å»º
print(phonebook)	# {'Alice': '2341', 'Beth': '9102', 'Cecil': '3258'}
print('Beth' in phonebook);	# True
```

## æ ¼å¼åŒ–format
åªè¦åœ¨å­—å…¸ä¸­æœ‰æ­¤kvåˆ™å°±å¯ä»¥æ›¿æ¢åˆ°formatçš„å‚æ•°é‡Œ
```
#!/usr/bin/python3
template = '''<html> 
<head><title>{title}</title></head> 
<body> 
<h1>{title}</h1> 
<p>{text}</p> 
</body>''' 
data = {'title': 'My Home Page', 'text': 'Welcome to my home page!'} 
print(template.format_map(data)) 


print("Cecil's phone number is {Cecil}.".format_map({'Beth': '9102', 'Alice': '2341', 'Cecil': '3258'}))


[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
<html> 
<head><title>My Home Page</title></head> 
<body> 
<h1>My Home Page</h1> 
<p>Welcome to my home page!</p> 
</body>
Cecil's phone number is 3258.
```
## æ¸…é™¤ clear
```
x.clear() 
```
## ä½¿ç”¨=èµ‹å€¼ï¼Œä½¿ç”¨copy()å¤åˆ¶
- ç­‰å·ä¾ç„¶ä»…æ˜¯å¼•ç”¨ï¼Œä¸æ˜¯å¤åˆ¶......
- æµ…æ‹·è´
  
  2ä¸ªå­—å…¸ä¸­machinesçš„vï¼ˆå€¼æ˜¯åˆ—è¡¨ï¼‰yä¿®æ”¹åxçš„ä¹Ÿè·Ÿç€å˜äº†ï¼Œè¯´æ˜æŒ‡å‘åŒä¸€ä¸ªå †åœ°å€
```
x = {'username': 'admin', 'machines': ['foo', 'bar', 'baz']} 
y = x.copy() 
y['username'] = 'mlh' 
y['machines'].remove('bar') 
print(x)
print(y)

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
{'username': 'admin', 'machines': ['foo', 'baz']}
{'username': 'mlh', 'machines': ['foo', 'baz']}
```
- æ·±æ‹·è´
	- ä½¿ç”¨copy
	- ä½¿ç”¨å‡½æ•°deepcopyè¿›è¡Œæ‹·è´
```
signals = {'green': 'go', 'yellow': 'go faster', 'red': 'smilefor the camera'}
original_signals = signals.copy()
signals['blue'] = 'confuse everyone'
print(signals)
print(original_signals)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pytest/pyth.py"
{'green': 'go', 'yellow': 'go faster', 'red': 'smilefor the camera', 'blue': 'confuse everyone'}
{'green': 'go', 'yellow': 'go faster', 'red': 'smilefor the camera'}
```  
```
#!/usr/bin/python3
from copy import deepcopy
x = {'username': 'admin', 'machines': ['foo', 'bar', 'baz']} 
y = deepcopy(x)  
y['username'] = 'mlh' 
y['machines'].remove('bar') 
print(x)
print(y)

d = {} 
d['names'] = ['Alfred', 'Bertrand'] 
c = d.copy() 
dc = deepcopy(d) 
d['names'].append('Clive') 
print(c)
print(dc)

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
{'username': 'admin', 'machines': ['foo', 'bar', 'baz']}
{'username': 'mlh', 'machines': ['foo', 'baz']}
{'names': ['Alfred', 'Bertrand', 'Clive']}
{'names': ['Alfred', 'Bertrand']}
```
# é›†åˆ set
- é›†åˆï¼ˆsetï¼‰æ˜¯ä¸€ç§å¯è¿­ä»£çš„ã€æ— åºçš„ã€ä¸èƒ½åŒ…å«é‡å¤å…ƒç´ çš„å®¹å™¨ç±»å‹çš„æ•°æ®ã€‚
- å°½ç®¡éƒ½ç”±èŠ±æ‹¬å·åŒ…è£¹ï¼Œé›†åˆä»…ä»…æ˜¯ä¸€ç³»åˆ—å€¼ç»„æˆçš„åºåˆ—ï¼Œè€Œå­—å…¸æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªé”®å€¼å¯¹ç»„æˆçš„åºåˆ—ã€‚
- æ‰€æœ‰æ–¹æ³•è§æµç¨‹çš„python3.8.3
  
## åˆ›å»º
- {å…ƒç´ 1ï¼Œå…ƒç´ 2ï¼Œå…ƒç´ 3ï¼Œâ‹¯}ï¼šæŒ‡å®šå…·ä½“çš„é›†åˆå…ƒç´ ï¼Œå…ƒç´ ä¹‹é—´ä»¥é€—å·åˆ†éš”ã€‚å¯¹äºé›†åˆå…ƒç´ ï¼Œéœ€è¦ä½¿ç”¨å¤§æ‹¬å·æ‹¬èµ·æ¥ã€‚
- ä½¿ç”¨set()åˆ›å»ºç©ºé›†åˆ
- ä½¿ç”¨set(iterable)å°†å…¶ä»–ç±»å‹è½¬æ¢ä¸ºé›†åˆï¼Œå‚æ•°iterableæ˜¯å¯è¿­ä»£å¯¹è±¡ï¼ˆå­—ç¬¦ä¸²ã€åˆ—è¡¨ã€å…ƒç»„ã€é›†åˆå’Œå­—å…¸ç­‰ï¼‰ã€‚
```
empty_set = set()	# ç©ºset
print(empty_set)
even_numbers = {0, 2, 4, 6, 8}	# æ™®é€šæ„å»ºæ–¹å¼
print(even_numbers)
print(set('letters'))	# åŸºäºå­—ç¬¦ä¸²
print(set(['Dasher', 'Dancer', 'Prancer', 'Mason-Dixon']))	# åŸºäºåˆ—è¡¨
print(set(('Ummagumma', 'Echoes', 'Atom Heart Mother')))	# åŸºäºå…ƒç»„
print(set({'apple': 'red', 'orange': 'orange', 'cherry': 'red'}))	# åŸºäºå­—å…¸ï¼Œä»…ä½¿ç”¨k

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pytest/pyth.py"
set()
{0, 2, 4, 6, 8}
{'s', 'l', 'e', 't', 'r'}
{'Dancer', 'Dasher', 'Prancer', 'Mason-Dixon'}
{'Atom Heart Mother', 'Echoes', 'Ummagumma'}
{'orange', 'cherry', 'apple'}
```
## å¢åˆ æŸ¥ã€clearã€lenã€copy
- add
- update
- remove
- discard
- pop
- len
- clear
- copy
- 
```
set1 = {'pear', 'banana', 'orange', 'apple'}
set1.add('kkk')	# æ·»åŠ ä¸€ä¸ªå…ƒç´ 
print(set1)
set1.update({'kkk', 'ppp'})	# æ·»åŠ å¤šä¸ªå…ƒç´ 
print(set1)

# æ–¹æ³•remove()å’Œæ–¹æ³•discard()çš„åŒºåˆ«åœ¨äºï¼Œæ–¹æ³•remove()åœ¨ç§»é™¤å…ƒç´ æ—¶ï¼Œå¦‚æœå…ƒç´ ä¸å­˜åœ¨ï¼Œä¼šæŠ¥é”™ï¼Œä¸­æ­¢ç¨‹åºè¿è¡Œï¼Œè€Œæ–¹æ³•discard()ä¸ä¼šã€‚
set1.remove('pear')	# å°†æŒ‡å®šå…ƒç´ ä»é›†åˆä¸­ç§»é™¤
print(set1)
set1.pop()	# éšæœºåˆ é™¤é›†åˆä¸­çš„ä¸€ä¸ªå…ƒç´ 
print(set1)
print(len(set1))	# å¾—åˆ°é›†åˆä¸­å…ƒç´ çš„ä¸ªæ•°
set1.clear()	# æ¸…ç©ºé›†åˆ
print(set1)	
set1 = {'pear', 'banana', 'orange', 'apple'}
bool1 = 'apple' in set1	# æ£€æµ‹å­˜åœ¨
print(bool1)
x = set1.copy()	# æ·±æ‹·è´
print(x)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pytest/pyth.py"
{'apple', 'kkk', 'banana', 'pear', 'orange'}
{'ppp', 'apple', 'kkk', 'banana', 'pear', 'orange'}
{'ppp', 'apple', 'kkk', 'banana', 'orange'}
{'apple', 'kkk', 'banana', 'orange'}
4
set()
True
{'banana', 'pear', 'orange', 'apple'}
```
## æ£€æµ‹ in
ä½¿ç”¨inæµ‹è¯•kæ˜¯å¦å­˜åœ¨
```
drinks = {
'martini': {'vodka', 'vermouth'},
'black russian': {'vodka', 'kahlua'},
'white russian': {'cream', 'kahlua', 'vodka'},
'manhattan': {'rye', 'vermouth', 'bitters'},
'screwdriver': {'orange juice', 'vodka'}
}
for name, contents in drinks.items():
	if 'vodka' in contents and not ('vermouth' in contents or 'cream' in contents):
		print(name)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pytest/pyth.py"
black russian
screwdriver
```
## é›†åˆè¿ç®—

```
>>> a = set('afqwbracadaagfgbrafg')
>>> b = set('rfgfgfalacazamddg')
>>> a                                  
{'r', 'q', 'd', 'b', 'w', 'g', 'f', 'c', 'a'}
>>> b
{'r', 'd', 'g', 'f', 'l', 'z', 'c', 'm', 'a'}
# é›†åˆaä¸­åŒ…å«è€Œé›†åˆbä¸­ä¸åŒ…å«çš„å…ƒç´ 
>>> a - b                              
{'b', 'w', 'q'}
 # é›†åˆaæˆ–bä¸­åŒ…å«çš„æ‰€æœ‰å…ƒç´ 
>>> a | b                             
{'d', 'g', 'l', 'c', 'r', 'q', 'b', 'w', 'f', 'z', 'm', 'a'}
# é›†åˆaå’Œbä¸­éƒ½åŒ…å«äº†çš„å…ƒç´ 
>>> a & b                              
{'r', 'd', 'g', 'f', 'c', 'a'}
# ä¸åŒæ—¶åŒ…å«äºaå’Œbçš„å…ƒç´ 
>>> a ^ b                              
{'l', 'q', 'b', 'w', 'z', 'm'}
```
## é›†åˆæ¨å¯¼å¼
```
# åˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨
>>> a = {x for x in 'abracadabra' if x not in 'abc'}
>>> a
{'r', 'd'}
```
## å…¶ä½™å†…ç½®æ–¹æ³•


```
difference
difference_update
intersection
intersection_update
union
isdisjoint
issubset
issuperset
symmetric_difference
symmetric_difference_update
è¯¦è§ http://www.ityouknow.com/python/2019/09/16/python-set-015.html
```

# å¤æ‚æ•°æ®ç»“æ„
## å…ƒç¥–é‡Œå­˜åˆ—è¡¨
```
marxes = ['Groucho', 'Chico', 'Harpo']
pythons = ['Chapman', 'Cleese', 'Gilliam', 'Jones', 'Palin']
stooges = ['Moe', 'Curly', 'Larry']
tuple_of_lists = marxes, pythons, stooges
print(tuple_of_lists)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pytest/pyth.py"
(['Groucho', 'Chico', 'Harpo'], ['Chapman', 'Cleese', 'Gilliam', 'Jones', 'Palin'], ['Moe', 'Curly', 'Larry'])
```
## å­—å…¸çš„kæ˜¯å…ƒç¥–
```

houses = {
	(44.79, -93.14, 285): 'My House',
	(38.89, -77.03, 13): 'The White House'
}

print(houses)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pytest/pyth.py"
{(44.79, -93.14, 285): 'My House', (38.89, -77.03, 13): 'The White House'}
```
## åˆ—è¡¨é‡Œå­˜åˆ—è¡¨
- ç®€å•çš„ä½¿ç”¨
```
small_birds = ['hummingbird', 'finch']
extinct_birds = ['dodo', 'passenger pigeon', 'Norwegian Blue']
carol_birds = [3, 'French hens', 2, 'turtledoves']
all_birds = [small_birds, extinct_birds, 'macaw', carol_birds]

print(all_birds)
print(all_birds[0])
print(all_birds[1][0])

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pytest/pyth.py"
[['hummingbird', 'finch'], ['dodo', 'passenger pigeon', 'Norwegian Blue'], 'macaw', [3, 'French hens', 2, 'turtledoves']]
['hummingbird', 'finch']
dodo
```
- ç›¸å¯¹å¤æ‚ä¸€ç‚¹çš„

ä¸¤ç§æ–¹å¼ç»“æœç›¸åŒ
```
æ–¹å¼1
board = [['_'] * 3 for i in range(3)]
print(board)
board[1][2] = 'X'
print(board)

æ–¹å¼2
board = []
for i in range(3):
	row=['_'] * 3
	board.append(row)
print(board)
board[2][0] = 'X'
print(board)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/bbb/src/pyth.py"
[['_', '_', '_'], ['_', '_', '_'], ['_', '_', '_']]
[['_', '_', '_'], ['_', '_', 'X'], ['_', '_', '_']]


[['_', '_', '_'], ['_', '_', '_'], ['_', '_', '_']]
[['_', '_', '_'], ['_', '_', '_'], ['X', '_', '_']]

```
é”™è¯¯çš„èµ‹å€¼æ¼”ç¤º
```
weird_board = [['_'] * 3] * 3	# weird_boardåŒ…å« 3 ä¸ªæŒ‡å‘åŒä¸€ä¸ªåˆ—è¡¨çš„å¼•ç”¨
print(weird_board)
weird_board[1][2] = 'O'
print(weird_board)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/bbb/src/pyth.py"
[['_', '_', '_'], ['_', '_', '_'], ['_', '_', '_']]
[['_', '_', 'O'], ['_', '_', 'O'], ['_', '_', 'O']]
```
## åˆ—è¡¨é‡Œå­˜å­—å…¸
```
#!/usr/bin/python3
# åˆ›å»ºä¸€ä¸ªç”¨äºå­˜å‚¨å¤–æ˜Ÿäººçš„ç©ºåˆ—è¡¨ã€‚
aliens = []
# åˆ›å»º30ä¸ªç»¿è‰²çš„å¤–æ˜Ÿäººã€‚
for alien_number in range (30):
	new_alien = {'color': 'green', 'points': 5, 'speed': 'slow'}
	aliens.append(new_alien)
for alien in aliens[:3]:
	if alien['color'] == 'green':
		alien['color'] = 'yellow'
		alien['speed'] = 'medium'
		alien['points'] = 10
# æ˜¾ç¤ºå‰5ä¸ªå¤–æ˜Ÿäººã€‚
for alien in aliens[:5]:
	print(alien)
print("...")

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
{'color': 'yellow', 'points': 10, 'speed': 'medium'}
{'color': 'yellow', 'points': 10, 'speed': 'medium'}
{'color': 'yellow', 'points': 10, 'speed': 'medium'}
{'color': 'green', 'points': 5, 'speed': 'slow'}
{'color': 'green', 'points': 5, 'speed': 'slow'}
...
```
## å­—å…¸é‡Œå­˜åˆ—è¡¨
```
#!/usr/bin/python3
favorite_languages = {
	'jen': ['python', 'ruby'],
	'sarah': ['c'],
	'edward': ['ruby', 'go'],
	'phil': ['python', 'haskell'],
}
for name, languages in favorite_languages.items():
	print(f"\n{name.title()}'s favorite languages are:")
	for language in languages:
		print(f"\t{language.title()}")

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"

Jen's favorite languages are:
        Python
        Ruby

Sarah's favorite languages are:
        C

Edward's favorite languages are:
        Ruby
        Go

Phil's favorite languages are:
        Python
        Haskell
```
## å­—å…¸é‡Œå­˜å­—å…¸
```
#!/usr/bin/python3
users = {
	'aeinstein': {
		'first': 'albert',
		'last': 'einstein',
		'location': 'princeton',
	},
	'mcurie': {
		'first': 'marie',
		'last': 'curie',
		'location': 'paris',
	},
}
for username, user_info in users.items():
	print(f"\nUsername: {username}")
	full_name = f"{user_info['first']} {user_info['last']}"
	location = user_info['location']
	print(f"\tFull name: {full_name.title()}")
	print(f"\tLocation: {location.title()}")


[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"

Username: aeinstein
        Full name: Albert Einstein
        Location: Princeton

Username: mcurie
        Full name: Marie Curie
        Location: Paris
```
### é€šè®¯å½•æ¡ˆä¾‹
æ¼”ç¤ºäº†é€šè¿‡"[][]"æ¥è®¿é—®å†…å±‚å­—å…¸çš„å…ƒç´ å€¼
```
#!/usr/bin/python3

people = { 
 'Alice': { 
 'phone': '2341', 
 'addr': 'Foo drive 23' 
 }, 
 'Beth': { 
 'phone': '9102', 
 'addr': 'Bar street 42' 
 }, 
'Cecil': { 
 'phone': '3158', 
 'addr': 'Baz avenue 90' 
 } 
}

# ç”µè¯å·ç å’Œåœ°å€çš„æè¿°æ€§æ ‡ç­¾ï¼Œä¾›æ‰“å°è¾“å‡ºæ—¶ä½¿ç”¨
labels = { 
 'phone': 'phone number', 
 'addr': 'address' 
} 
name = input('Name: ') 
# è¦æŸ¥æ‰¾ç”µè¯å·ç è¿˜æ˜¯åœ°å€ï¼Ÿ
request = input('Phone number (p) or address (a)? ') 
# ä½¿ç”¨æ­£ç¡®çš„é”®ï¼š
if request == 'p': key = 'phone' 
if request == 'a': key = 'addr' 
# ä½¿ç”¨getæä¾›é»˜è®¤å€¼
person = people.get(name, {}) 
label = labels.get(key, key) 
result = person.get(key, 'not available') 
print("{}'s {} is {}.".format(name, label, result)) 


[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
Name: Beth
Phone number (p) or address (a)? a
Beth's address is Bar street 42.
[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
Name: Cecil
Phone number (p) or address (a)? p
Cecil's phone number is 3158.
```

# å…¶å®ƒç±»å‹ä¸å®¹å™¨

## æ•°ç»„ array
array æ¨¡å—æä¾›äº†ä¸€ç§ array() å¯¹è±¡ï¼Œå®ƒç±»ä¼¼äºåˆ—è¡¨ï¼Œä½†åªèƒ½å­˜å‚¨ç±»å‹ä¸€è‡´çš„æ•°æ®ä¸”å­˜å‚¨å¯†é›†æ›´é«˜ã€‚ 
- æ•°ç»„æ”¯æŒæ‰€æœ‰è·Ÿå¯å˜åºåˆ—æœ‰å…³çš„æ“ä½œåŒ…æ‹¬ .popã€.insert å’Œ .extendã€‚
- æ•°ç»„è¿˜æä¾›ä»æ–‡ä»¶è¯»å–å’Œå­˜å…¥æ–‡ä»¶çš„æ›´å¿«çš„æ–¹æ³•ï¼Œå¦‚ .frombytes å’Œ .tofileã€‚
- åˆ›å»ºæ•°ç»„éœ€è¦ä¸€ä¸ªç±»å‹ç ï¼Œè¿™ä¸ªç±»å‹ç ç”¨æ¥è¡¨ç¤ºåœ¨åº•å±‚çš„ C è¯­è¨€åº”è¯¥å­˜æ”¾æ€æ ·çš„æ•°æ®ç±»å‹ã€‚
- å…·ä½“æ•°ç»„æ”¯æŒçš„æ–¹æ³•å‚åŠ â€œæµç•…çš„python 2.9.1â€
- ä¸‹é¢çš„â€˜dâ€™ä»£è¡¨å­—èŠ‚ç±»å‹ï¼Œå³byteï¼Œ-128~127
```
from array import array
from random import random
floats = array('d', (random() for i in range(10**7)))	# åŒç²¾åº¦æµ®ç‚¹æ•°ç»„ç”Ÿæˆå™¨
print(floats[-1])	# æœ€æœ«å…ƒç´ 
fp = open('floats.bin', 'wb')
floats.tofile(fp)	# å†™å…¥äºŒè¿›åˆ¶æ–‡ä»¶
fp.close()
floats2 = array('d')	# æ–°å»ºæ•°ç»„
fp = open('floats.bin', 'rb')
floats2.fromfile(fp, 10**7)	# å°†æ–‡ä»¶å†…å®¹å†™åˆ°æ•°ç»„é‡Œ
fp.close()
print(floats2[-1])	# æœ€æœ«å…ƒç´ 
print(floats2 == floats)	# åˆ¤æ–­æ•°ç»„ç›¸åŒ

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/bbb/src/pyth.py"
0.4028576664776865
0.4028576664776865
True
```

## å­—èŠ‚ bytes
- å­—èŠ‚bytesæ˜¯ä¸å¯å˜çš„ï¼Œåƒå­—èŠ‚æ•°æ®ç»„æˆçš„å…ƒç»„
- bytes ç±»å‹å€¼çš„è¡¨ç¤ºä»¥ b å¼€å¤´ï¼Œæ¥ç€æ˜¯ä¸€ä¸ªå•å¼•å·ï¼Œåé¢è·Ÿç€ç”±åå…­è¿›åˆ¶æ•°ï¼ˆä¾‹å¦‚ \x02ï¼‰æˆ– ASCII ç ç»„æˆçš„åºåˆ—ï¼Œæœ€åä»¥é…å¯¹çš„å•å¼•å·ç»“æŸ
- Python ä¼šå°†è¿™äº›åå…­è¿›åˆ¶æ•°æˆ–è€… ASCII ç è½¬æ¢ä¸ºæ•´æ•°ï¼Œå¦‚æœè¯¥å­—èŠ‚çš„å€¼ä¸ºæœ‰æ•ˆ ASCIIç¼–ç åˆ™ä¼šæ˜¾ç¤º ASCII å­—ç¬¦ã€‚
- ä½¿ç”¨ 8 æ¯”ç‰¹åºåˆ—å­˜å‚¨å°æ•´æ•°çš„æ–¹å¼è¿›è¡Œå­˜å‚¨ï¼Œæ¯ 8æ¯”ç‰¹ï¼ˆå³ä¸€å­—èŠ‚ï¼‰å¯ä»¥å­˜å‚¨ä» 0~255 çš„å€¼
- æ‰“å° bytes æˆ– bytearray æ•°æ®æ—¶ï¼ŒPython ä¼šä»¥ \xxx çš„å½¢å¼è¡¨ç¤ºä¸å¯æ‰“å°çš„å­—ç¬¦
- ä»¥ ASCII å­—ç¬¦çš„å½¢å¼è¡¨ç¤ºå¯æ‰“å°çš„å­—ç¬¦ï¼ˆä»¥åŠä¸€äº›è½¬ä¹‰å­—ç¬¦ï¼Œä¾‹å¦‚ \n è€Œä¸æ˜¯ \x0aï¼‰

```
blist = [1, 2, 3, 255]
the_bytes = bytes(blist)	# ä½¿ç”¨åˆ—è¡¨åˆ›å»ºä¸€ä¸ªbytes ç±»å‹çš„å˜é‡
print(the_bytes)
# the_bytes[1] = 127	# errï¼Œä¸å¯æ”¹å˜
print(b'\x61')	# æ˜¾ç¤ºaï¼Œå› ä¸º61å¯¹åº”asciiçš„a
print(b'\x01abc\xff')	# æ— å¯¹åº”ï¼ŒåŸæ ·æ˜¾ç¤º
the_bytes = bytes(range(0, 256))	# å»ºä¸€ä¸ªåŒ…å« 0åˆ°255 çš„æ‰€æœ‰æ•°çš„bytes 
print(the_bytes)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pyth.py"
b'\x01\x02\x03\xff'
b'a'
b'\x01abc\xff'
b'\x00\x01\x02\x03\x04\x05\x06\x07\x08\t\n\x0b\x0c\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !"#$%&\'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff'
```

## å­—èŠ‚æ•°ç»„ bytearray

- å­—èŠ‚æ•°ç»„bytearrayæ˜¯å¯å˜çš„ï¼Œåƒå­—èŠ‚æ•°æ®ç»„æˆçš„åˆ—è¡¨ã€‚
- æ‰“å°bytearrayé€šå¸¸æ‰‹åŠ¨åŠ å…¥æ¢è¡Œç”¨äºæ˜¾ç¤ºæ•ˆæœï¼Œå¦‚ä¸€è¡Œæ˜¾ç¤º 16 ä¸ªå­—èŠ‚

```
blist = [1, 2, 3, 255]
the_byte_array = bytearray(blist) # ä½¿ç”¨åˆ—è¡¨åˆ›å»ºä¸€ä¸ªbytearrayç±»å‹çš„å˜é‡
print(the_byte_array)
the_byte_array[1] = 127	# bytearray ç±»å‹çš„å˜é‡æ˜¯å¯å˜çš„
print(the_byte_array)
the_byte_array = bytearray(range(0, 256))	# å»ºä¸€ä¸ªåŒ…å« 0åˆ°255 çš„æ‰€æœ‰æ•°çš„bytearray
print(the_byte_array)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pyth.py"
bytearray(b'\x01\x02\x03\xff')
bytearray(b'\x01\x7f\x03\xff')
bytearray(b'\x00\x01\x02\x03\x04\x05\x06\x07\x08\t\n\x0b\x0c\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !"#$%&\'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff')
```

# æšä¸¾ enum


## åˆ›å»ºã€è®¿é—®ã€è¿­ä»£

æšä¸¾å±æ€§å€¼å¯ä»¥æ˜¯ä»»ä½•ä¸œè¥¿: int, str ç­‰ã€‚å¦‚æœç¡®åˆ‡çš„å€¼ä¸é‡è¦ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ auto å®ä¾‹ï¼Œå¹¶ä¸ºæ‚¨é€‰æ‹©é€‚å½“çš„å€¼ã€‚å¦‚æœæ‚¨å°† auto ä¸å…¶ä»–å€¼æ··åˆï¼Œåˆ™å¿…é¡»å°å¿ƒã€‚ æšä¸¾ç±»å‹ä¸­ï¼Œä¸å¯ä»¥è®¾ç½®ç›¸åŒåç§°çš„ nameï¼Œå¯ä»¥æœ‰ç›¸åŒçš„ valueã€‚
```
from enum import Enum, auto, unique
# åˆ›å»º
# @uniqueï¼Œæšä¸¾å€¼å”¯ä¸€ï¼Œ åŠ å…¥æ­¤å¥å¯ç¡®ä¿æ‰€æœ‰å€¼ä¸èƒ½æœ‰é‡å¤ï¼Œå¦åˆ™å¼‚å¸¸
class HttpStatus(Enum):
    OK = 200
    BAD_REQUEST = 400
    FORBIDDEN = 403
    NOT_FOUND = 404
    REQUEST_TIMEOUT = 408
    SERVICE_UNAVAILABLE = 500
    OTHER = auto.value

print('Member: {}'.format(HttpStatus.OK))               # Member: HttpStatus.OK
print('Member name: {}'.format(HttpStatus.OK.name))     # Member name: OK
print('Member value: {}'.format(HttpStatus.OK.value))   # Member value: 200
print(repr(HttpStatus.OK))                              # <enum 'HttpStatus'>
print(type(HttpStatus.OK))                              # <HttpStatus.OK: 200>
print(isinstance(HttpStatus.OK, HttpStatus))            # True

# è¿­ä»£  éå†çš„æ¯ä¸€ä¸ª status æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æšä¸¾æˆå‘˜ï¼Œæ‹¥æœ‰ name å’Œ value å±æ€§
for status in HttpStatus:
    print('{} : {}'.format(status.name, status.value))

# å¦ä¸€ç§å½¢å¼
for name, member in HttpStatus.__members__.items():
    print('{} : {}'.format(name, member))
    

# æšä¸¾æˆå‘˜ä¸å±æ€§è®¿é—®
print(HttpStatus(200))      # HttpStatus.OK é€šè¿‡æšä¸¾ value è¿›è¡Œè®¿é—®ï¼Œè®¿é—®éœ€è¦ä½¿ç”¨å…ƒç»„()çš„å½¢å¼
print(HttpStatus['OK'])     # HttpStatus.OK é€šè¿‡æšä¸¾ name è¿›è¡Œè®¿é—®ï¼Œè®¿é—®éœ€è¦ä½¿ç”¨åˆ—è¡¨[]çš„å½¢å¼
number = HttpStatus.OK      # å°†å±æ€§èµ‹äºˆå¦ä¸€ä¸ª enum æˆå‘˜
print(number)               # HttpStatus.OK 

[huawei@n161 ccc]$ python3 1.py
Member: HttpStatus.OK
Member name: OK
Member value: 200
<HttpStatus.OK: 200>
<enum 'HttpStatus'>
True
OK : 200
BAD_REQUEST : 400
FORBIDDEN : 403
NOT_FOUND : 404
REQUEST_TIMEOUT : 408
SERVICE_UNAVAILABLE : 500
OTHER : <object object at 0x7fcc2fc2b0b0>
OK : HttpStatus.OK
BAD_REQUEST : HttpStatus.BAD_REQUEST
FORBIDDEN : HttpStatus.FORBIDDEN
NOT_FOUND : HttpStatus.NOT_FOUND
REQUEST_TIMEOUT : HttpStatus.REQUEST_TIMEOUT
SERVICE_UNAVAILABLE : HttpStatus.SERVICE_UNAVAILABLE
OTHER : HttpStatus.OTHER
HttpStatus.OK
HttpStatus.OK
```

##  æšä¸¾è‡ªåŠ¨èµ‹å€¼
```
from enum import Enum, auto, unique


# æšä¸¾è‡ªåŠ¨èµ‹å€¼
# æ­¤åŠŸèƒ½ç”¨äºæˆ‘ä»¬åœ¨ä½¿ç”¨æšä¸¾æ—¶ï¼Œåªåœ¨æ„æšä¸¾çš„æ ‡è¯†ç¬¦çš„å«ä¹‰è€Œä¸åœ¨æ„å€¼çš„æƒ…å†µä¸‹ï¼Œä½†æ˜¯å¦‚æœéœ€è¦ä¸å­—ç¬¦ä¸²æˆ–æ•´æ•°æ··åˆä½¿ç”¨å°±è¦é¢å¤–æ³¨æ„ã€‚
class Color(Enum):
    red = auto()
    blue = auto()
    green = auto()

print(list(Color) == [Color.red, Color.blue, Color.green])
print(Color.red.value ==  1)
print(Color.blue.value ==  2)
print(Color.green.value == 3)

# ä½¿ç”¨ auto() å¾—åˆ°çš„æ˜¯æ•´æ•°è‡ªå¢å‹ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦åˆ«çš„æ–¹å¼ï¼Œåªéœ€è¦åœ¨æˆ‘ä»¬çš„æšä¸¾ç±»ä¸­ï¼Œé‡å†™ _generate_next_value_ æ–¹æ³•ã€‚
class Color(Enum):
    def _generate_next_value_(self, start, count, last):
        return self
    red = auto()
    blue = auto()
    green = auto()

print(list(Color) == [Color.red, Color.blue, Color.green])
print(Color.red.value == 'red')
print(Color.blue.value == 'blue')
print(Color.green.value == 'green')

[huawei@n161 ccc]$ python3 1.py
True
True
True
True
True
True
True
True

```

## æ¯”è¾ƒã€æ–¹æ³•ã€ç»§æ‰¿

è¯¦è§ http://www.ityouknow.com/python/2019/10/15/python-enum-033.html


# åˆ¤æ–­
## æ¯”è¾ƒæ•°å€¼ä¸å­—ç¬¦ä¸²
```
#!/usr/bin/python3
requested_topping = 'mushrooms'
if requested_topping != 'anchovies':
	print("Hold the anchovies!")
car = 'Audi'
print(car.lower() == 'audi')

answer = 17
if answer != 42:
	print("That is not the correct answer. Please try again!")

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
Hold the anchovies!
True
That is not the correct answer. Please try again!
```
## æ¯”è¾ƒè¿ç®—ç¬¦
- 0 < age < 100  
  Pythonæ”¯æŒé“¾å¼æ¯”è¾ƒï¼Œå¯åŒæ—¶ä½¿ç”¨å¤šä¸ªæ¯”è¾ƒè¿ç®—ç¬¦
- == ç”¨æ¥æ£€æŸ¥ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ï¼Œæ¯”å€¼ï¼ˆå¯¹è±¡ä¸­ä¿å­˜çš„æ•°æ®ï¼‰
- x != y  
  xä¸ç­‰äºy

```
names = ['Mrs. Entity', 'Mrs. Thing'] 
n = names[:] 
print(n is names)
print(n == names)

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
False
True
```
## identityã€isã€is notã€id
- Python ä¸­çš„å˜é‡å…·æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å±æ€§ï¼šidentityï¼Œå³â€œèº«ä»½æ ‡è¯†â€ã€‚è¿™ç§ç‰¹æ®Šçš„å±æ€§ä¹Ÿåœ¨å¾ˆå¤šåœ°æ–¹è¢«ç§°ä¸ºâ€œå¼•ç”¨â€ã€‚

- id() å‡½æ•°è¿”å›å¯¹è±¡çš„æ ‡è¯†ã€‚å¯¹è±¡ ID çš„çœŸæ­£æ„ä¹‰åœ¨ä¸åŒçš„å®ç°ä¸­æœ‰æ‰€ä¸åŒã€‚åœ¨ CPython ä¸­ï¼Œid() è¿”å›å¯¹è±¡çš„å†…å­˜åœ°å€ï¼Œä½†æ˜¯åœ¨å…¶ä»– Python è§£é‡Šå™¨ä¸­å¯èƒ½æ˜¯åˆ«çš„å€¼ã€‚å…³é”®æ˜¯ï¼ŒID ä¸€å®šæ˜¯å”¯ä¸€çš„æ•°å€¼æ ‡æ³¨ï¼Œè€Œä¸”åœ¨å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸä¸­ç»ä¸ä¼šå˜ã€‚

- is è¿ç®—ç¬¦æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„æ ‡è¯†
  - x is y  ï¼š  isç”¨æ¥æ£€æŸ¥ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸åŒï¼ˆæ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼‰
  - x is not y  ï¼š  xå’Œyæ˜¯ä¸åŒçš„å¯¹è±¡

```
charles = {'name': 'Charles L. Dodgson', 'born': 1832}
print(charles)
lewis = charles	# lewisä¸charlesæŒ‡å‘åŒä¸€åœ°å€
print(lewis is charles)	 # isæ¯”åœ°å€ï¼Œæ‰€ä»¥ç›¸åŒ
print(id(charles))
print(id(lewis))
lewis['balance'] = 950
print(charles)

alex = {'name': 'Charles L. Dodgson', 'born': 1832, 'balance': 950}
print(alex == charles)	# å­—å…¸çš„==ï¼ˆå³__eq__ï¼‰æ˜¯æ¯”å€¼ï¼Œæ‰€ä»¥ç›¸åŒ
print(alex is not charles)	# ä½†isæ˜¯æ¯”åœ°å€

[huawei@n161 aaa]$ python3 test.py 
{'name': 'Charles L. Dodgson', 'born': 1832}
True
140107530622368
140107530622368
{'name': 'Charles L. Dodgson', 'born': 1832, 'balance': 950}
True
True
```



## inã€not in
- x in y  
  xæ˜¯å®¹å™¨ï¼ˆå¦‚åºåˆ—ï¼‰yçš„æˆå‘˜
- x not in y  
  xä¸æ˜¯å®¹å™¨ï¼ˆå¦‚åºåˆ—ï¼‰yçš„æˆå‘˜
## if else
```
#!/usr/bin/python3
age = 17
if age >= 18:
	print("You are old enough to vote!")
	print("Have you registered to vote yet?")
else:
	print("Sorry, you are too young to vote.")
	print("Please register to vote as soon as you turn 18!")
	
```
## æ¡ä»¶è¡¨è¾¾å¼
å³éƒ½å†™åœ¨ä¸€è¡Œé‡Œ
```
status = "friend" if name.endswith("Gumby") else "stranger" 
```
## else if
```
#!/usr/bin/python3
age = 12
if age < 4:
	price = 0
elif age < 18:
	price = 25
elif age < 65:
	price = 40
else:
	price = 20
print(f"Your admission cost is ${price}.")
```
```
#!/usr/bin/python3
requested_toppings = ['mushrooms', 'extra cheese']
if 'mushrooms' in requested_toppings:
	print("Adding mushrooms.")
elif 'pepperoni' in requested_toppings:
	print("Adding pepperoni.")
elif 'extra cheese' in requested_toppings:
	print("Adding extra cheese.")
print("\nFinished making your pizza!")
```
## å¸ƒå°”è¿ç®—ç¬¦ andã€or
```
(age_0 >= 21) and (age_1 >= 21)
(age_0 >= 21) or (age_1 >= 21)
å¦‚æœæ˜¯ç®€å•çš„æ¯”è¾ƒåˆ™å¯ä»¥ä½¿ç”¨é“¾å¼ 1 <= number <= 10
```

# å¾ªç¯
## while
```
#!/usr/bin/python3
prompt = "\nTell me something, and I will repeat it back to you:"
prompt += "\nEnter 'quit' to end the program. "
message = ""
while message != 'quit':
 message = input(prompt)
 if message != 'quit':
     print(message)
```
## for
```
words = ['this', 'is', 'an', 'ex', 'parrot'] 
for word in words:
    print(word) 

for word in [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]:
 	print(word) 

for number in range(1,11):
    print(number) 

d = {'x': 1, 'y': 2, 'z': 3} 
for key in d: 
	print(key, 'corresponds to', d[key]) 
for key, value in d.items(): 
	print(key, 'corresponds to', value) 


names = ['anne', 'beth', 'george', 'damon'] 
ages = [12, 45, 32, 102] 
for i in range(len(names)): 
	print(names[i], 'is', ages[i], 'years old') 
```
## breakã€continue
```
from math import sqrt 
for n in range(99, 0, -1): 
	root = sqrt(n) 
	if root == int(root): 
		print(n) 
		break

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
81		
```
## else
- for  
ä»…å½“ for å¾ªç¯è¿è¡Œå®Œæ¯•æ—¶ï¼ˆå³ for å¾ªç¯æ²¡æœ‰è¢« break è¯­å¥ä¸­æ­¢ï¼‰æ‰è¿è¡Œ else å—ã€‚
- while  
ä»…å½“ while å¾ªç¯å› ä¸ºæ¡ä»¶ä¸ºå‡å€¼è€Œé€€å‡ºæ—¶ï¼ˆå³ while å¾ªç¯æ²¡æœ‰è¢« break è¯­å¥ä¸­æ­¢ï¼‰æ‰è¿
è¡Œ else å—ã€‚
- try  
ä»…å½“ try å—ä¸­æ²¡æœ‰å¼‚å¸¸æŠ›å‡ºæ—¶æ‰è¿è¡Œ else å—ã€‚

# è¿­ä»£å™¨


- è¿­ä»£å™¨ï¼ˆiteratorï¼‰æ˜¯ä¸€ç§å¯åœ¨å®¹å™¨ï¼ˆcontainerï¼‰ä¸­éè®¿çš„æ¥å£ï¼Œä¸ºä½¿ç”¨è€…å°è£…äº†å†…éƒ¨é€»è¾‘ã€‚
- è¿­ä»£å™¨æ˜¯è¿™æ ·çš„å¯¹è±¡ï¼šå®ç°äº†æ— å‚æ•°çš„ __next__ æ–¹æ³•ï¼Œè¿”å›åºåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼›
- å¦‚æœæ²¡æœ‰å…ƒç´ äº†ï¼Œé‚£ä¹ˆæŠ›å‡º StopIteration å¼‚å¸¸ã€‚
- Python ä¸­çš„è¿­ä»£å™¨è¿˜å®ç°äº† __iter__ æ–¹æ³•ï¼Œå› æ­¤è¿­ä»£å™¨ä¹Ÿå¯ä»¥è¿­ä»£ã€‚
- __iter__()å’Œ__next__()ä¸¤ç§æ–¹æ³•ï¼ŒäºŒè€…åˆç§°ä¸ºâ€œè¿­ä»£å™¨åè®®â€
è¯¦ç»†å‚è§ http://www.ityouknow.com/python/2019/09/21/python-iterator-019.html

## ç”Ÿæˆå™¨å‡½æ•° yield
- åªè¦ Python å‡½æ•°çš„å®šä¹‰ä½“ä¸­æœ‰ yield å…³é”®å­—ï¼Œè¯¥å‡½æ•°å°±æ˜¯ç”Ÿæˆå™¨å‡½æ•°ã€‚
- è°ƒç”¨ç”Ÿæˆå™¨å‡½æ•°æ—¶ï¼Œä¼šè¿”å›ä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç”Ÿæˆå™¨å‡½æ•°æ˜¯ç”Ÿæˆå™¨å·¥å‚ã€‚
- æ™®é€šçš„å‡½æ•°ä¸ç”Ÿæˆå™¨å‡½æ•°åœ¨å¥æ³•ä¸Šå”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼Œåœ¨åè€…çš„å®šä¹‰ä½“ä¸­æœ‰yield å…³é”®å­—ã€‚
- è°ƒç”¨ç”Ÿæˆå™¨å‡½æ•°è¿”å›ç”Ÿæˆå™¨å¯¹è±¡ï¼›ç”Ÿæˆå™¨äº§å‡ºæˆ–ç”Ÿæˆå€¼ã€‚
- æŠŠç”Ÿæˆå™¨ä¼ ç»™nextå‡½æ•°æ—¶ï¼Œç”Ÿæˆå™¨å‡½æ•°ä¼šå‘å‰ï¼Œæ‰§è¡Œåˆ°å‡½æ•°å®šä¹‰ä¸­çš„ä¸‹ä¸€ä¸ªyieldè¯­å¥ï¼Œè¿”å›äº§å‡ºçš„å€¼


```
def gen_AB():
	print('start')
	yield 'A'
	print('continue')
	yield 'B'
	print('end.')

for c in gen_AB():	# for æœºåˆ¶ä¼šæ•è·StopIteration å¼‚å¸¸ï¼Œå› æ­¤å¾ªç¯ç»ˆæ­¢æ—¶æ²¡æœ‰æŠ¥é”™ã€‚
	print('-->', c)

a = gen_AB()	# åˆ›å»ºç”Ÿæˆå™¨å¯¹è±¡
print(next(a))	# æ‰“å°startã€A
print(next(a))	# æ‰“å°continueã€B
print(next(a))	# æ‰“å°end.åç”±äºæ²¡æœ‰åç»­å…ƒç´ ï¼Œç”Ÿæˆå™¨å¯¹è±¡ä¼šæŠ›å‡º StopIteration å¼‚å¸¸


[huawei@n161 ccc]$ python3 1.py
start
--> A
continue
--> B
end.
start
A
continue
B
end.
Traceback (most recent call last):
  File "1.py", line 16, in <module>
    print(next(a))
StopIteration
```
## æ ‡å‡†åº“æä¾›çš„ç”Ÿæˆå™¨

è¯¦è§æµç•…çš„python14.9ã€14.11
### ç”¨äºè¿‡æ»¤çš„ç”Ÿæˆå™¨å‡½æ•°
```
import itertools
 
# itertools.compress(it,selector_it)
# å¹¶è¡Œå¤„ç†ä¸¤ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œå¦‚æœselector_itä¸­çš„å…ƒç´ æ˜¯çœŸå€¼ï¼Œäº§å‡ºitä¸­å¯¹åº”çš„å…ƒç´ 
print([i for i in itertools.compress(range(10), [0, 0, 1, 1])])
 
# itertools.takewhile(predicate,it)
# ä½¿ç”¨ä¼ å…¥çš„ç”Ÿæˆå™¨ç”Ÿæˆå¦ä¸€ä¸ªç”Ÿæˆå™¨ï¼ŒpredicateæŒ‡å®šç»ˆæ­¢æ¡ä»¶
print([i for i in itertools.takewhile(lambda n: n < 5, range(10))])
 
# itertools.dropwhile(prdicate,it)
# ä¸itertools.takewhileçš„ä½œç”¨ç›¸å
print([i for i in itertools.dropwhile(lambda n: n < 5, range(10))])
 
# filter(predicate,it)
# å°†itä¸­çš„å„ä¸ªå…ƒç´ ä¼ ç»™predicateï¼Œå¦‚æœä¸ºçœŸï¼Œåˆ™äº§å‡ºitä¸­å¯¹åº”çš„å…ƒç´ 
print([i for i in filter(lambda a: a % 2, range(10))])  # ä¿ç•™å¥‡æ•°
 
# itertools.filterfalse(predicate,it)
# ä¸filterçš„ä½œç”¨ç›¸å
print([i for i in itertools.filterfalse(lambda a: a % 2, range(10))])  # ä¿ç•™å¶æ•°
 
# itertools.islice(it,stop)æˆ–è€…itertools.islice(it,start,stop,step=1)
# äº§å‡ºitçš„åˆ‡ç‰‡ å®ç°çš„æ˜¯æƒ°æ€§æ“ä½œ
print([i for i in itertools.islice(range(10), 2)])
print([i for i in itertools.islice(range(10), 2, 9, 3)])

[huawei@n161 ccc]$ python3 1.py
[2, 3]
[0, 1, 2, 3, 4]
[5, 6, 7, 8, 9]
[1, 3, 5, 7, 9]
[0, 2, 4, 6, 8]
[0, 1]
[2, 5, 8]
```

### ç”¨äºæ˜ å°„çš„ç”Ÿæˆå™¨å‡½æ•°
```
import itertools
import fractions
import operator
 
# itertools.accumulate(it,func)
# äº§å‡ºç´¯ç§¯çš„æ€»å’Œï¼Œå¦‚æœæä¾›äº†funcï¼Œé‚£ä¹ˆæŠŠå‰ä¸¤ä¸ªå…ƒç´ ä¼ ç»™å®ƒï¼Œç„¶åæŠŠè®¡ç®—çš„ç»“æœå’Œä¸‹ä¸€ä¸ªå…ƒç´ ä¼ ç»™å®ƒï¼Œä»¥æ­¤ç±»æ¨
print([i for i in itertools.accumulate(range(10), lambda a, b: a + b)])  # è®¡ç®—å‰né¡¹çš„å’Œ
 
# enunerate(it,start=0)
# äº§å‡ºç”±ä¸¤ä¸ªå…ƒç´ æ„æˆçš„å…ƒç»„ ç»“æ„æ˜¯(index,item) indexä»startå¼€å§‹ï¼Œæ¯æ¬¡åŠ ä¸€ itemçš„å€¼ä¸­itä¸­å–
print([i for i in enumerate(range(10), start=10)])
 
# map(func,iter,[it2,...itn])
# æŠŠitä¸­çš„å„ä¸ªå…ƒç´ ä¼ ç»™funcï¼Œäº§å‡ºç»“æœï¼Œå¦‚æœä¼ å…¥nä¸ªitï¼Œfuncçš„å‚æ•°å¿…é¡»æœ‰nä¸ª
print([i for i in map(lambda a, b, c: a + b + c, range(-10, 0, 1), range(10), range(10, 20))])  # å¯¹it1ï¼Œit2ï¼Œit3å¯¹åº”ä½ç½®çš„å…ƒç´ è¿›è¡Œæ±‚å’Œ
# itertools.startmap(func,it)
# æŠŠitä¸­çš„å„ä¸ªå…ƒç´ ä¼ ç»™funcï¼Œäº§å‡ºç»“æœ
print([i for i in itertools.starmap(operator.mul, enumerate('hello world', 1))])  # ä»1å¼€å§‹ï¼Œæ ¹æ®å­—æ¯æ‰€åœ¨ä½ç½®ï¼ŒæŠŠå­—æ¯é‡å¤ç›¸åº”çš„æ¬¡æ•°

[huawei@n161 ccc]$ python3 1.py
[0, 1, 3, 6, 10, 15, 21, 28, 36, 45]
[(10, 0), (11, 1), (12, 2), (13, 3), (14, 4), (15, 5), (16, 6), (17, 7), (18, 8), (19, 9)]
[0, 3, 6, 9, 12, 15, 18, 21, 24, 27]
['h', 'ee', 'lll', 'llll', 'ooooo', '      ', 'wwwwwww', 'oooooooo', 'rrrrrrrrr', 'llllllllll', 'ddddddddddd']
```

### åˆå¹¶å¤šä¸ªå¯è¿­ä»£å¯¹è±¡çš„ç”Ÿæˆå™¨å‡½æ•°
```
import itertools
 
# itertools.chain(it1,[it2...it2])
# å…ˆäº§å‡ºit1ä¸­çš„å…ƒç´ ï¼Œç„¶åäº§å‡ºit2ä¸­çš„å…ƒç´ ï¼Œä»¥æ­¤ç±»æ¨ï¼Œæ— ç¼è¿æ¥åœ¨ä¸€èµ·
print([i for i in itertools.chain(range(10), range(11, 20), 'hello world')])
 
# itertools.chain.from_iterable(it)
# åŠŸèƒ½åŒitertools.chain ä¸è¿‡ä¼ å…¥çš„å‚æ•°çš„ç»“æ„æœ‰æ‰€å˜åŒ–   itçš„ç»“æ„ï¼šit=[iter1,[iter2...itern]]
print([i for i in itertools.chain.from_iterable([range(10), 'hello'])])
 
# itertools.product(it1,...itn,repeat=1)
# è®¡ç®—ç¬›å¡å°”ç§¯ï¼Œä»è¾“å…¥çš„å„ä¸ªå¯è¿­ä»£å¯¹è±¡ä¸­è·å–å…ƒç´ ï¼Œåˆå¹¶æˆç”±Nä¸ªå…ƒç´ ç»„æˆçš„å…ƒç»„ï¼Œä¸åµŒå¥—çš„forå¾ªç¯æ•ˆæœä¸€æ ·ï¼ŒrepeatæŒ‡æ˜é‡å¤å¤„ç†å¤šå°‘æ¬¡è¾“å…¥çš„å¯è¿­ä»£å¯¹è±¡
print([i for i in itertools.product(range(3), 'hello', 'world', repeat=1)])
 
# zip(it1,...itn)
# å¹¶è¡Œä»è¾“å…¥çš„å„ä¸ªå¯è¿­ä»£å¯¹è±¡ä¸­è·å–å…ƒç´ ï¼Œäº§å‡ºç”±Nä¸ªå…ƒç´ ç»„æˆçš„å…ƒç»„ï¼Œåªè¦æœ‰ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡åˆ°äº†å¤´ï¼Œè¿­ä»£å°±ç»ˆæ­¢
print([i for i in zip(range(5), 'hello')])
 
# zip_longest(it1,..itn,fillvalue=None)
# ä¸zipä½œç”¨ä¸€æ ·ï¼Œä½†æ˜¯ç»ˆæ­¢æ¡ä»¶æ˜¯æœ€é•¿çš„å¯è¿­ä»£å¯¹è±¡åˆ°å¤´äº†æ‰ç»ˆæ­¢ï¼Œå…¶ä»–å¯è¿­ä»£å¯¹è±¡ç©ºç¼ºçš„å€¼ç”¨fillvalueè¿›è¡Œè¡¥å……
print([i for i in itertools.zip_longest(range(10), 'hello', fillvalue='world')])

[huawei@n161 ccc]$ python3 1.py
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, 'h', 'e', 'l', 'l', 'o', ' ', 'w', 'o', 'r', 'l', 'd']
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 'h', 'e', 'l', 'l', 'o']
[(0, 'h', 'w'), (0, 'h', 'o'), (0, 'h', 'r'), (0, 'h', 'l'), (0, 'h', 'd'), (0, 'e', 'w'), (0, 'e', 'o'), (0, 'e', 'r'), (0, 'e', 'l'), (0, 'e', 'd'), (0, 'l', 'w'), (0, 'l', 'o'), (0, 'l', 'r'), (0, 'l', 'l'), (0, 'l', 'd'), (0, 'l', 'w'), (0, 'l', 'o'), (0, 'l', 'r'), (0, 'l', 'l'), (0, 'l', 'd'), (0, 'o', 'w'), (0, 'o', 'o'), (0, 'o', 'r'), (0, 'o', 'l'), (0, 'o', 'd'), (1, 'h', 'w'), (1, 'h', 'o'), (1, 'h', 'r'), (1, 'h', 'l'), (1, 'h', 'd'), (1, 'e', 'w'), (1, 'e', 'o'), (1, 'e', 'r'), (1, 'e', 'l'), (1, 'e', 'd'), (1, 'l', 'w'), (1, 'l', 'o'), (1, 'l', 'r'), (1, 'l', 'l'), (1, 'l', 'd'), (1, 'l', 'w'), (1, 'l', 'o'), (1, 'l', 'r'), (1, 'l', 'l'), (1, 'l', 'd'), (1, 'o', 'w'), (1, 'o', 'o'), (1, 'o', 'r'), (1, 'o', 'l'), (1, 'o', 'd'), (2, 'h', 'w'), (2, 'h', 'o'), (2, 'h', 'r'), (2, 'h', 'l'), (2, 'h', 'd'), (2, 'e', 'w'), (2, 'e', 'o'), (2, 'e', 'r'), (2, 'e', 'l'), (2, 'e', 'd'), (2, 'l', 'w'), (2, 'l', 'o'), (2, 'l', 'r'), (2, 'l', 'l'), (2, 'l', 'd'), (2, 'l', 'w'), (2, 'l', 'o'), (2, 'l', 'r'), (2, 'l', 'l'), (2, 'l', 'd'), (2, 'o', 'w'), (2, 'o', 'o'), (2, 'o', 'r'), (2, 'o', 'l'), (2, 'o', 'd')]
[(0, 'h'), (1, 'e'), (2, 'l'), (3, 'l'), (4, 'o')]
[(0, 'h'), (1, 'e'), (2, 'l'), (3, 'l'), (4, 'o'), (5, 'world'), (6, 'world'), (7, 'world'), (8, 'world'), (9, 'world')]
```

### æŠŠè¾“å…¥çš„å„ä¸ªå…ƒç´ æ‰©å±•æˆå¤šä¸ªè¾“å‡ºå…ƒç´ çš„ç”Ÿæˆå™¨å‡½æ•°
```

import itertools
 
# itertools.combinations(it,out_len)  ç»„åˆ å’Œé¡ºåºæ— å…³
# æŠŠitäº§å‡ºçš„out_lenä¸ªå…ƒç´ ç»„åˆåœ¨ä¸€èµ·ï¼Œç„¶åäº§å‡º
print([i for i in itertools.combinations('ABC', 2)])  # äº§å‡ºä¸¤ä¸¤ç»„åˆçš„å…ƒç´ 
 
# itertools.combinations_with_replacement ç»„åˆ
# åŠŸèƒ½åŒitertools.combinationsï¼Œä½†æ˜¯ä¹ŸåŒ…å«è‡ªå·±å’Œè‡ªå·±çš„ç»„åˆ
print([i for i in itertools.combinations_with_replacement('ABC', 2)])
 
# itertools.count(start=0,step=1)
# ä»startå¼€å§‹ï¼Œä»¥stepä¸ºæ­¥é•¿ï¼Œä¸æ–­äº§å‡ºæ•°å­—
for i in itertools.count(1, 2):
    print(i, end=' ')
    if i > 10: break
print()
 
# itertools.permutations(it,out_len=len(list(it)))
# æŠŠitäº§å‡ºçš„out_lenä¸ªå…ƒç´ æ’åˆ—åœ¨ä¸€èµ·  æ’åˆ—  å’Œé¡ºåºæœ‰å…³
print([i for i in itertools.permutations('ABC', 2)])
 
# repeat(item,[times])
# é‡å¤ä¸æ–­çš„äº§å‡ºæŒ‡å®šçš„å…ƒç´ ï¼Œé™¤éæä¾›timesæŒ‡å®šæ¬¡æ•°
print([i for i in itertools.repeat('hello', 10)])
 
# itertools.cycle(it)
# ä»itä¸­äº§å‡ºå„ä¸ªå…ƒç´ ï¼Œå­˜å‚¨å„ä¸ªå…ƒç´ çš„å‰¯æœ¬ï¼Œç„¶åæŒ‰é¡ºåºé‡å¤ä¸æ–­åœ°äº§å‡ºå„ä¸ªå…ƒç´ 
cy = itertools.cycle('ABC')  # å°†ité¦–ä½ç›¸è¿
while True:
    print(next(cy))
    break

[huawei@n161 ccc]$ python3 1.py
[('A', 'B'), ('A', 'C'), ('B', 'C')]
[('A', 'A'), ('A', 'B'), ('A', 'C'), ('B', 'B'), ('B', 'C'), ('C', 'C')]
1 3 5 7 9 11 
[('A', 'B'), ('A', 'C'), ('B', 'A'), ('B', 'C'), ('C', 'A'), ('C', 'B')]
['hello', 'hello', 'hello', 'hello', 'hello', 'hello', 'hello', 'hello', 'hello', 'hello']
A
```

### ç”¨äºé‡æ–°æ’åˆ—å…ƒç´ çš„ç”Ÿæˆå™¨å‡½æ•°
```
import itertools
 
# itertools.groupby(it,key=None)
# äº§å‡ºç”±ç»ƒä¸ªå…ƒç´ ç»„æˆçš„å…ƒç´ ï¼Œå½¢å¼ä¸º(key,group)ï¼Œå…¶ä¸­keyæ˜¯åˆ†ç»„æ ‡å‡†ï¼Œgroupæ˜¯ç”Ÿæˆå™¨ï¼Œç”¨äºäº§å‡ºåˆ†ç»„é‡Œçš„å…ƒç´ 
strs_list = ['hello', 'world', 'we', 'price', 'the', 'things', 'when', 'we', 'have', 'lost', 'them', '.']
strs_list.sort(key=len)  # å…ˆæ’åº
for key, group in itertools.groupby(strs_list, key=len):  # æ ¹æ®å…ƒç´ çš„é•¿åº¦è¿›è¡Œåˆ†ç»„
    print(key, list(group))
 
# reversed(seq)
# ä»åå‘å‰ï¼Œå€’åºäº§å‡ºseq seqå¿…é¡»æ˜¯åºåˆ—ï¼Œæˆ–è€…æ˜¯å®ç°äº†__reversed__çš„å¯¹è±¡
print(list(reversed(strs_list)))
 
# itertools.tee(it,n=2)
# äº§å‡ºä¸€ä¸ªç”±nä¸ªç”Ÿæˆå™¨ç»„æˆçš„å…ƒç»„ï¼Œæ¯ä¸ªç”Ÿæˆå™¨ç”¨äºå•ç‹¬äº§å‡ºè¾“å…¥çš„å¯è¿­ä»£å¯¹è±¡ä¸­çš„å…ƒç´ 
g1, g2 = itertools.tee('ABC')
print(list(g1))
print(list(g2))

[huawei@n161 ccc]$ python3 1.py
1 ['.']
2 ['we', 'we']
3 ['the']
4 ['when', 'have', 'lost', 'them']
5 ['hello', 'world', 'price']
6 ['things']
['things', 'price', 'world', 'hello', 'them', 'lost', 'have', 'when', 'the', 'we', 'we', '.']
['A', 'B', 'C']
['A', 'B', 'C']
```
### å¯è¿­ä»£çš„å½’çº¦å‡½æ•°
```
import functools
import itertools
 
# å½’çº¦å‡½æ•°:æ¥å—ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œç„¶åè¿”å›å•ä¸ªç»“æœçš„å‡½æ•°ã€‚
 
# all(it)
# itä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½ä¸ºçœŸæ—¶è¿”å›Trueï¼Œå¦è€…è¿”å›False
print(all(range(10)))  # å› ä¸ºå‡ºç°äº†0ï¼Œæ‰€ä»¥è¿”å›False
 
# any(it)
# åªæœ‰æœ‰ä¸€ä¸ªå…ƒç´ æ˜¯Trueå°±è¿”å›Trueï¼Œå¦è€…è¿”å›False
print(any(range(10)))
 
# max(it,[key=],[default=])
# è¿”å›itä¸­çš„æœ€å¤§å€¼ï¼ŒkeyæŒ‡å®šæ’åºè§„åˆ™ï¼Œå¦‚æœitä¸ºç©ºï¼Œè¿”å›defaultçš„å€¼
print(max(['apple', 'banana', 'orange', 'peach'], key=len, default='apple'))  # æŒ‰ç…§é•¿åº¦è¿›è¡Œæ¯”è¾ƒ
 
# min(it,[key=],[default=])
# è¿”å›itä¸­çš„æœ€å°å€¼ï¼ŒkeyæŒ‡å®šæ’åºè§„åˆ™ï¼Œå¦‚æœitä¸ºç©ºï¼Œè¿”å›defaultçš„å€¼
print(min([1, 2, -4, -9, 6], key=abs, default=0))  # æŒ‰ç…§ç»å¯¹å€¼è¿›è¡Œæ¯”è¾ƒ
 
# itertools.reduce(func,it,[initial])
# æŠŠå‰ä¸¤ä¸ªå…ƒç´ ä¼ ç»™funcï¼Œç„¶åæŠŠè®¡ç®—ç»“æœå’Œç¬¬ä¸‰ä¸ªå…ƒç´ ä¼ ç»™funcï¼Œä»¥æ­¤ç±»æ¨ï¼Œè¿”å›æœ€åçš„ç»“æœï¼Œå¦‚æœæä¾›äº†initial
# å°±ä¼šæŠŠå®ƒå½“åšç¬¬ä¸€ä¸ªå…ƒç´ ä¼ å…¥
print(functools.reduce(lambda a, b: a * b, range(1, 11)))  # è®¡ç®—10ï¼
print(list(itertools.accumulate(range(1, 11), lambda a, b: a * b)))  # ä¾æ¬¡è®¡ç®—1! 2! 3!...10!
 
# sum(it,start=0)
# itä¸­æ‰€æœ‰å…ƒç´ çš„æ€»å’Œï¼Œå¦‚æœæä¾›å¯é€‰çš„startï¼Œä¼šæŠŠå®ƒåŠ ä¸Š
# 0+1+2+10=13
print(sum(range(3), 10))

[huawei@n161 ccc]$ python3 1.py
False
True
banana
1
3628800
[1, 2, 6, 24, 120, 720, 5040, 40320, 362880, 3628800]
13
```

## yield from
https://blog.csdn.net/max_LLL/article/details/124242358

## ç”Ÿæˆå™¨è¡¨è¾¾å¼
- ç”Ÿæˆå™¨è¡¨è¾¾å¼å¯ä»¥ç†è§£ä¸ºåˆ—è¡¨æ¨å¯¼çš„æƒ°æ€§ç‰ˆæœ¬ï¼šä¸ä¼šè¿«åˆ‡åœ°æ„å»ºåˆ—è¡¨ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªç”Ÿæˆå™¨ï¼ŒæŒ‰éœ€æƒ°æ€§ç”Ÿæˆå…ƒç´ ã€‚
- å¦‚æœåˆ—è¡¨æ¨å¯¼æ˜¯åˆ¶é€ åˆ—è¡¨çš„å·¥å‚ï¼Œé‚£ä¹ˆç”Ÿæˆå™¨è¡¨è¾¾å¼å°±æ˜¯åˆ¶é€ ç”Ÿæˆå™¨çš„å·¥å‚ã€‚
- å¦‚æœç”Ÿæˆå™¨è¡¨è¾¾å¼è¦åˆ†æˆå¤šè¡Œå†™ï¼Œåˆ™æ¨èä½¿ç”¨ç”Ÿæˆå™¨å‡½æ•°ï¼Œä»¥ä¾¿æé«˜å¯è¯»æ€§ã€‚æ­¤å¤–ï¼Œç”Ÿæˆå™¨å‡½æ•°æœ‰åç§°ï¼Œå› æ­¤å¯ä»¥é‡ç”¨ã€‚
- ç”Ÿæˆå™¨è¡¨è¾¾å¼æ˜¯åˆ›å»ºç”Ÿæˆå™¨çš„ç®€æ´å¥æ³•ï¼Œè¿™æ ·æ— éœ€å…ˆå®šä¹‰å‡½æ•°å†è°ƒç”¨ã€‚ä¸è¿‡ï¼Œç”Ÿæˆå™¨å‡½æ•°çµæ´»å¾—å¤šï¼Œå¯ä»¥ä½¿ç”¨å¤šä¸ªè¯­å¥å®ç°å¤æ‚çš„é€»è¾‘ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºåç¨‹ä½¿ç”¨
  
```
def gen_AB():
	print('start')
	yield 'A'
	print('continue')
	yield 'B'
	print('end.')

res1 = [x*3 for x in gen_AB()]	# æ‰“å°startã€continueã€end.æ­¤å¤„æ˜¯åˆ—è¡¨æ¨å¯¼ï¼Œå…¨åˆ›å»ºå‡ºæ¥äº†ï¼Œélazy
for i in res1:
    print('-->', i)	# æ‰“å°AAAã€BBB
print("------------")
res2 = (x*3 for x in gen_AB())	# lazyï¼Œç”Ÿæˆå™¨è¡¨è¾¾å¼ä¼šäº§å‡ºç”Ÿæˆå™¨å¯¹è±¡ï¼Œæœªæ‰§è¡Œç”Ÿæˆå™¨å†…çš„ä»£ç 
for i in res2:	# å¾ªç¯æ—¶åˆ»æ‰æ‰§è¡Œç”Ÿæˆå™¨å†…çš„ä»£ç 
    print('-->', i)

[huawei@n161 ccc]$ python3 1.py
start
continue
end.
--> AAA
--> BBB
------------
start
--> AAA
continue
--> BBB
end.
```


## å¯è¿­ä»£å¯¹è±¡

- ä½¿ç”¨ iter å†…ç½®å‡½æ•°å¯ä»¥è·å–è¿­ä»£å™¨çš„å¯¹è±¡ã€‚
- å¦‚æœå¯¹è±¡å®ç°äº†èƒ½è¿”å›è¿­ä»£å™¨çš„ __iter__ æ–¹æ³•ï¼Œé‚£ä¹ˆå¯¹è±¡å°±æ˜¯å¯è¿­ä»£çš„ã€‚
- åºåˆ—éƒ½å¯ä»¥è¿­ä»£ï¼›
- å®ç°äº† __getitem__ æ–¹æ³•ï¼Œè€Œä¸”å…¶å‚æ•°æ˜¯ä»é›¶å¼€å§‹çš„ç´¢å¼•ï¼Œè¿™ç§å¯¹è±¡ä¹Ÿå¯ä»¥è¿­ä»£ã€‚


### è¿­ä»£å‡½æ•° __getitem__
å¦‚æœæ²¡æœ‰å®ç° __iter__ æ–¹æ³•ï¼Œä½†æ˜¯å®ç°äº† __getitem__ æ–¹æ³•ï¼ŒPython ä¼šåˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨ï¼Œå°è¯•æŒ‰é¡ºåºï¼ˆä»ç´¢å¼• 0 å¼€å§‹ï¼‰è·å–å…ƒç´ ã€‚æ­¤å¯¹è±¡åˆ™æ˜¯å¯è¿­ä»£çš„
```
#!/usr/bin/python3
import re
import reprlib
RE_WORD = re.compile('\w+')
class Sentence:
	def __init__(self, text):
		self.text = text
		self.words = RE_WORD.findall(text)
	def __getitem__(self, index):
		return self.words[index]
	def __len__(self):
		return len(self.words)
	def __repr__(self):
		return 'Sentence(%s)' % reprlib.repr(self.text)

s = Sentence('"The time has come," the Walrus said,')

for word in s:
    print(word)
print(s)
print(s[0])
print(s[-1])



[huawei@n161 ccc]$ python3 1.py
The
time
has
come
the
Walrus
said
Sentence('"The time ha... Walrus said,')
The
said
```
### è¿­ä»£å‡½æ•° iterã€next
- iter()å‡½æ•°çš„åŠŸèƒ½æ˜¯ï¼šæ¥å—ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œå°†å…¶è½¬æ¢æˆä¸€ä¸ªè¿­ä»£å™¨
- è¿˜å¯ä»¥æœ‰2ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸­çš„å¯¹è±¡ä¸æ–­äº§å‡ºå€¼ï¼Œå¦‚æœäº§å‡ºçš„å€¼å’Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€æ ·çš„ï¼Œå°±åœæ­¢äº§å‡º

ä¸€èˆ¬ç”¨æ³•
```
a=[1,2,3]
a_iter=iter(a)
print(a_iter)
print(next(a_iter))
print(next(a_iter))


[huawei@n161 ccc]$ python3 1.py
<list_iterator object at 0x7fea017d3240>
1
2
```
ä¸€èˆ¬ç”¨æ³•
```
#!/usr/bin/python3
import re
import reprlib
RE_WORD = re.compile('\w+')
class Sentence:
	def __init__(self, text):
		self.text = text
		self.words = RE_WORD.findall(text)
	def __getitem__(self, index):
		return self.words[index]
	def __len__(self):
		return len(self.words)
	def __repr__(self):
		return 'Sentence(%s)' % reprlib.repr(self.text)

s3 = Sentence('Pig and Pepper')
print(list(iter(s3)))	# ['Pig', 'and', 'Pepper']ï¼Œä½¿ç”¨itæ„å»ºäº†listï¼Œæ­¤æ—¶itå·²ç»ç”¨å®Œäº†ã€‚å¦‚æœæƒ³å†æ¬¡è¿­ä»£ï¼Œè¦é‡æ–°æ„å»ºè¿­ä»£å™¨
it = iter(s3)	# åˆé‡æ–°æ„å»ºäº†it
print(it)	# <iterator object at 0x7f27cb075dd8> æ‰“å°äº†åœ°å€
print(next(it))	# Pig
print(next(it))	# and
print(list(it))	# ['Pepper']ï¼Œä½¿ç”¨itæ„å»ºäº†listï¼Œæ­¤æ—¶itç”¨å®Œäº†
print(list(it))	# []ï¼Œitå·²ç»ç”¨å®Œäº†ï¼Œæ‰€ä»¥æ„å»ºå‡ºç©ºlist
print(next(it))	# errï¼Œitæ²¡æœ‰æ•°æ®äº†ã€‚ã€‚ã€‚

[huawei@n161 ccc]$ python3 1.py
['Pig', 'and', 'Pepper']
<iterator object at 0x7f329c5eddd8>
Pig
and
['Pepper']
[]
Traceback (most recent call last):
  File "1.py", line 24, in <module>
    print(next(it))
StopIteration
[huawei@n161 ccc]$ 
```


é«˜çº§ç”¨æ³•ï¼šéšæœºäº§ç”Ÿ1åˆ°10çš„æ•°å­—ï¼Œå¦‚æœäº§å‡ºæ•°å­—æ˜¯5å°±åœæ­¢ã€‚
```
from random import randint
 
def d10():
    return randint(1, 10)
 
# éšæœºäº§ç”Ÿ1~10ä¹‹é—´çš„æ•°ï¼Œé‡åˆ°5å°±åœæ­¢
for i in iter(d10, 5):
    print(i)
```



## itertoolsæ¨¡å—

åœ¨ Python ä¸­ï¼Œè¿­ä»£å™¨æ˜¯ä¸€ç§éå¸¸å¥½ç”¨çš„æ•°æ®ç»“æ„ï¼Œå…¶æœ€å¤§çš„ä¼˜åŠ¿å°±æ˜¯å»¶è¿Ÿç”Ÿæˆï¼ŒæŒ‰éœ€ä½¿ç”¨ï¼Œä»è€Œå¤§å¤§æé«˜ç¨‹åºçš„è¿è¡Œæ•ˆç‡ã€‚è€Œ itertools ä½œä¸º Python çš„å†…ç½®æ¨¡å—ï¼Œå°±ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€å¥—éå¸¸æœ‰ç”¨çš„ç”¨äºæ“ä½œå¯è¿­ä»£å¯¹è±¡çš„å‡½æ•°ã€‚æ³¨æ„ä¸€ç‚¹ï¼Œä»–è¿”å›çš„ä¸æ˜¯listï¼Œè€Œæ˜¯iterator

### æ— ç©·è¿­ä»£å™¨

- count(start, [step]) å…¶ä¸­ step æ˜¯é»˜è®¤å‚æ•°ï¼Œå¯é€‰çš„ï¼Œé»˜è®¤å€¼ä¸º 1ã€‚ è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªæ–°çš„è¿­ä»£å™¨ï¼Œä» start å¼€å§‹ï¼Œè¿”å›ä»¥ step ä¸ºæ­¥é•¿çš„å‡åŒ€é—´éš”çš„å€¼ã€‚ä¼šåˆ›å»ºä¸€ä¸ªæ— é™è¿­ä»£å™¨ï¼Œä»å½“å‰æ•°å­—æ— é™å¾ªç¯ä¸‹å»ï¼Œåœæ­¢å¯ä»¥æŒ‰Ctrl+cé”®
- cycle( p)ä¼šæŠŠä¼ å…¥çš„åºåˆ—æ— é™çš„å¾ªç¯æ‰“å°
- repeat(elem [,n])å¯ä»¥æŠŠä¸€ä¸ªå…ƒç´ æ— é™å¾ªç¯ï¼Œå½“ç„¶å¦‚æœæŒ‡å®š times çš„è¯ï¼Œåˆ™åªä¼šé‡å¤ times æ¬¡ã€‚
```
import itertools
# for i in itertools.count(1, 2):
#     print(i)    # 1,3,5...

# for i in itertools.cycle("XYZ"):
#     print(i)    # x,y,z,x,y,z...

for i in itertools.repeat("XYZ", 7): # å¯ä»¥æ·»åŠ ç¬¬äºŒä¸ªå‚æ•°æ¥é™åˆ¶ä¸ªæ•°ï¼Œé»˜è®¤æ— é™
    print(i)    # xyz,xyz...
```
### æœ‰é™è¿­ä»£å™¨

- chain(p,qâ€¦)å¯ä»¥æŠŠä¸€ç»„è¿­ä»£å¯¹è±¡ä¸²è”èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªæ›´å¤§çš„è¿­ä»£å™¨
- groupby(iterable,key=None])æŠŠè¿­ä»£å™¨ä¸­ç›¸é‚»çš„å…ƒç´ æŒ‰ç…§keyå‡½æ•°åˆ†ç»„ï¼Œå½“key=Noneæ—¶ï¼ŒæŠŠç›¸é‚»çš„é‡å¤å…ƒç´ è¿›è¡Œåˆ†ç»„
- accumulate()

```
import itertools

import itertools
for i in itertools.chain("abc", "123"):
    print(i)    # a,b,c,1,2,3



def sortBy(score):
	if score > 80:
		return "A"
	elif score >= 60:
		return "B"
	else:
		return "C"

scores = [81, 82, 84, 76, 64, 78, 59, 44, 55, 89]
scores = sorted(scores, key=sortBy)  # è¿™é‡Œéœ€è¦å…ˆæ’åºï¼Œå¦åˆ™90ä¼šè¢«æ”¾åˆ°æ–°çš„åˆ†ç»„ï¼ŒåŸå› è§ http://www.ityouknow.com/python/2019/10/23/python-itertools-039.html
for m, n in itertools.groupby(scores, key=sortBy):
	print(m, list(n))

[huawei@n161 ccc]$ python3 1.py
A [81, 82, 84, 89]
B [76, 64, 78]
C [59, 44, 55]
```

### æ’åˆ—ç»„åˆè¿­ä»£å™¨

- product(*iterables, repeat=1) è¾“å‡ºå¯è¿­ä»£å¯¹è±¡çš„ç¬›å¡å°”ç§¯ï¼Œæœ‰ç‚¹ç±»ä¼¼äºåµŒå¥—å¾ªç¯ã€‚å…¶ä¸­ repeat å¯ä»¥è®¾ç½®å¾ªç¯æ¬¡æ•°ã€‚
- permutations(iterable, r=None) è¿”å› iterable ä¸­é•¿åº¦ä¸º r çš„æ‰€æœ‰æ’åˆ—ã€‚é»˜è®¤å€¼ r ä¸º iterable çš„é•¿åº¦ã€‚å³ä½¿å…ƒç´ çš„å€¼ç›¸åŒï¼Œä¸åŒä½ç½®çš„å…ƒç´ ä¹Ÿè¢«è®¤ä¸ºæ˜¯ä¸åŒçš„ã€‚å³è®¤ä¸º('a', 'b')ä¸('b', 'a')ä¸åŒï¼Œå¦åˆ™éœ€ä½¿ç”¨combinationsæ–¹æ³•ï¼Œä¼šå»é‡
- combinations(iterable, r=None) è¿”å› iterable ä¸­é•¿åº¦ä¸º r çš„æœ‰åºæ’åˆ—ã€‚é»˜è®¤å€¼ r ä¸º iterable çš„é•¿åº¦ã€‚ ä¸ permutations æ“ä½œä¸åŒçš„æ˜¯è¯¥å‡½æ•°ä¸¥æ ¼æŒ‰ç…§ iterable ä¸­å…ƒç´ çš„é¡ºåºè¿›è¡Œæ’åˆ—ã€‚
- combinations_with_replacement(iterable, r=None) è¿”å› iterable ä¸­é•¿åº¦ä¸º r çš„æœ‰åºæ’åˆ—ã€‚é»˜è®¤å€¼ r ä¸º iterable çš„é•¿åº¦ã€‚ ä¸ combinations æ“ä½œä¸åŒçš„æ˜¯è¯¥å‡½æ•°å…è®¸æ¯ä¸ªå…ƒç´ é‡å¤å‡ºç°ã€‚

```
å–æ’åˆ—ç»„åˆ
import itertools
for i in itertools.product("ab", "12"):
    print(i)
print(list(itertools.product("34", "56")))
print(list(itertools.product("cd", repeat=2)))

[huawei@n161 ccc]$ python3 1.py
('a', '1')
('a', '2')
('b', '1')
('b', '2')
[('3', '5'), ('3', '6'), ('4', '5'), ('4', '6')]
[('c', 'c'), ('c', 'd'), ('d', 'c'), ('d', 'd')]


å–æ‰€æœ‰æ’åˆ—ç»„åˆï¼Œå½“rå¤§äºå‚æ•°lenåˆ™ç»„åˆä¸ºç©º
import itertools
for i in itertools.permutations("abc", r=2):
    print(i)

print(list(itertools.permutations("123", r=4)))
[huawei@n161 ccc]$ python3 1.py
('a', 'b')
('a', 'c')
('b', 'a')
('b', 'c')
('c', 'a')
('c', 'b')
[]


ä¸permutationsä¸ä¸€æ ·ï¼Œè®¤ä¸º('a', 'b')ä¸('b', 'a')ç›¸åŒï¼Œä¼šå»é™¤è¿™ç±»é‡å¤
import itertools
for i in itertools.combinations("abc", r=2):
    print(i)

print(list(itertools.combinations("123", r=4)))

[huawei@n161 ccc]$ python3 1.py
('a', 'b')
('a', 'c')
('b', 'c')
[]


ä¸å‰é¢çš„ä¸åŒï¼Œå…è®¸å‡ºç°('a', 'a')ã€('b', 'b')è¿™ç±»
import itertools
for i in itertools.combinations_with_replacement("abc", r=2):
    print(i)

print(list(itertools.combinations_with_replacement("123", r=2)))

[huawei@n161 ccc]$ python3 1.py
('a', 'a')
('a', 'b')
('a', 'c')
('b', 'b')
('b', 'c')
('c', 'c')
[('1', '1'), ('1', '2'), ('1', '3'), ('2', '2'), ('2', '3'), ('3', '3')]
```

### æ¯”è¾ƒ
- compress(data, selectors) è¯¥å‡½æ•°åŠŸèƒ½å¾ˆç®€å•ï¼Œå°±æ˜¯æ ¹æ® selectors ä¸­çš„å€¼åˆ¤æ–­æ˜¯å¦ä¿ç•™ data ä¸­å¯¹åº”ä½ç½®çš„å€¼ã€‚
```
import itertools
data = [81, 82, 84, 76, 64, 78]
tf = [1,1,0,1,1,0]
print(list(itertools.compress(data, tf)))

# è¾“å‡ºç»“æœå¦‚ä¸‹
[81, 82, 76, 64]

```
- dropwhile(predicate, iterable) åˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨ï¼Œä» predicate é¦–æ¬¡ä¸º false æ—¶å¼€å§‹è¿­ä»£å…ƒç´ ã€‚
```
import itertools
x = itertools.dropwhile(lambda x: x < 5, [1,3,5,7,4,2,1])
print(list(x))

# è¾“å‡ºç»“æœå¦‚ä¸‹ã€‚å³ä½¿ predicate é¦–æ¬¡ä¸º false åé¢çš„å…ƒç´ ä¸æ»¡è¶³ predicate ä¹ŸåŒæ ·ä¼šè¢«è¿­ä»£ã€‚
[5, 7, 4, 2, 1]
```
- filterfalse(predicate, iterable) åˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¿”å› iterable ä¸­ predicate ä¸º false çš„å…ƒç´ ã€‚
```
import itertools
x = itertools.filterfalse(lambda x: x < 5, [1,3,5,7,4,2,1])
print(list(x))

# è¾“å‡ºç»“æœå¦‚ä¸‹
[5, 7]
```
- islice(iterable, start, stop[, step]) å¯¹ iterable è¿›è¡Œåˆ‡ç‰‡æ“ä½œã€‚ä» start å¼€å§‹åˆ° stop æˆªæ­¢ï¼ŒåŒæ—¶æ”¯æŒä»¥æ­¥é•¿ä¸º step çš„è·³è·ƒã€‚
```
import itertools
print(list(itertools.islice('123456789', 2)))
print(list(itertools.islice('123456789', 2, 4)))
print(list(itertools.islice('123456789', 2, None)))
print(list(itertools.islice('123456789', 0, None, 2)))

# è¾“å‡ºç»“æœå¦‚ä¸‹
['1', '2']
['3', '4']
['3', '4', '5', '6', '7', '8', '9']
['1', '3', '5', '7', '9']
```

- starmap(function, iterable) ä»å¯è¿­ä»£å¯¹è±¡ä¸­è·å–å‚æ•°æ¥æ‰§è¡Œè¯¥å‡½æ•°ã€‚
```
import itertools
print(list(itertools.starmap(pow,[(2,10), (3,3)])))

# è¾“å‡ºç»“æœå¦‚ä¸‹
[1024, 27]
```
- takewhile(predicate, iterable) åˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨ï¼Œé‡åˆ° predicate ä¸º false åˆ™åœæ­¢è¿­ä»£å…ƒç´ ã€‚ä¸ dropwhile å®Œå…¨ç›¸åã€‚

```
import itertools
x = itertools.takewhile(lambda x: x < 5, [1,3,5,7,4,2,1])
print(list(x))

# è¾“å‡ºç»“æœå¦‚ä¸‹
[1, 3]
```

### å…¶ä½™
- accumulate(iterable [,func])æ˜¯ä¸€ä¸ªè®¡ç®—è¿­ä»£å™¨ï¼Œå¦‚æœä¸æŒ‡å®šå‚æ•°å‡½æ•°ï¼Œå°†ä¼šé‡‡å–é»˜è®¤çš„æ±‚å’Œå‡½æ•°
```
import itertools
for i in itertools.accumulate([1,2,4,5,3]):
    print(i)

ä¹Ÿå¯ä»¥æŒ‡å®šå‚æ•°å‡½æ•°ï¼Œæ¯”å¦‚æ±‚æœ€å¤§å€¼
for i in itertools.accumulate([1,2,4,5,3], max):
    print(i)

[huawei@n161 ccc]$ python3 1.py
1
3
7
12
15
1
2
4
5
5
```

# å‡½æ•°
## å®šä¹‰ã€ä¼ å€¼ã€é»˜è®¤å€¼ã€ç±»å‹
```
#!/usr/bin/python3
def describe_pet(pet_name, animal_type='dog'):
	"""æ˜¾ç¤ºå® ç‰©çš„ä¿¡æ¯ã€‚"""
	print(f"\nI have a {animal_type}.")
	print(f"My {animal_type}'s name is {pet_name.title()}.")

describe_pet('hamster', 'harry')
describe_pet(pet_name='harry', animal_type='hamster')
describe_pet(pet_name='willie')
```
- Pythonä¸­çš„ä»»æ„ä¸€ä¸ªå‡½æ•°éƒ½æœ‰æ•°æ®ç±»å‹ï¼Œè¿™ç§æ•°æ®ç±»å‹æ˜¯functionï¼Œè¢«ç§°ä¸ºå‡½æ•°ç±»å‹ã€‚
- ä¸‹é¢æ˜¯ä¸€ä¸ªä¼ é€’å¼•ç”¨ä¸”æœ‰é»˜è®¤å€¼çš„ä½¿ç”¨æ–¹å¼ï¼Œæ€»ç»“å¦‚ä¸‹ï¼š
- é™¤éè¿™ä¸ªæ–¹æ³•ç¡®å®æƒ³ä¿®æ”¹é€šè¿‡å‚æ•°ä¼ å…¥çš„å¯¹è±¡ï¼Œå¦åˆ™åœ¨ç±»ä¸­ç›´æ¥æŠŠå‚æ•°èµ‹å€¼ç»™å®ä¾‹å˜é‡ä¹‹å‰ä¸€å®šè¦ä¸‰æ€ï¼Œå› ä¸ºè¿™æ ·ä¼šä¸ºå‚æ•°å¯¹è±¡åˆ›å»ºåˆ«åã€‚å¦‚æœä¸ç¡®å®šï¼Œé‚£å°±åˆ›å»ºå‰¯æœ¬ã€‚
- æ­¤æ¡ˆä¾‹å…·æœ‰ä»£è¡¨æ„ä¹‰ï¼Œè¯¦è§æµç•…çš„Python8.4.2
```
def __init__(self, passengers=None):
	if passengers is None:
		self.passengers = []
	else:
		self.passengers = list(passengers)
```
## è¿”å›å€¼
```
def get_formatted_name(first_name, last_name, middle_name=''):
	if middle_name:
		full_name = f"{first_name} {middle_name} {last_name}"
	else:
		full_name = f"{first_name} {last_name}"
	return full_name.title()

musician = get_formatted_name('jimi', 'hendrix')
print(musician)
musician = get_formatted_name('john', 'hooker', 'lee')
print(musician)
```
## ï¼ˆä¼ å€ï¼‰ä¼ åˆ—è¡¨ã€ä¼ å­—å…¸
å®é™…æ˜¯ä¼ å¼•ç”¨ï¼Œåœ¨å‡½æ•°å†…åˆ æ‰åå¤–é¢ä¹Ÿéƒ½æ²¡äº†

- **æ— è®ºæ˜¯å€¼ä¼ é€’è¿˜æ˜¯å¼•ç”¨ä¼ é€’ï¼Œæˆ‘ä»¬åªéœ€å…³æ³¨å‡½æ•°å†…éƒ¨æ˜¯å¦ä¼šç”Ÿæˆæ–°çš„å¯¹è±¡å³å¯ã€‚å‡¡æ˜¯å¯¹åŸå¯¹è±¡æ“ä½œçš„å‡½æ•°ï¼Œéƒ½ä¼šå½±å“ä¼ é€’çš„å®é™…å‚æ•°ï¼›å‡¡æ˜¯ç”Ÿæˆäº†æ–°å¯¹è±¡çš„æ“ä½œï¼Œéƒ½ä¸ä¼šå½±å“ä¼ é€’çš„å®é™…å‚æ•°ã€‚**

- **å¦‚æœè¦æƒ³åœ¨å‡½æ•°ä¸­æ”¹å˜å¯¹è±¡ï¼Œç¬¬ä¸€å¯ä»¥ä¼ å…¥å¯å˜æ•°æ®ç±»å‹(åˆ—è¡¨ï¼Œå­—å…¸ï¼Œé›†åˆ)ï¼Œç›´æ¥æ”¹å˜ï¼›ç¬¬äºŒè¿˜å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œä¿®æ”¹åè¿”å›ã€‚å»ºè®®ç”¨åè€…ï¼Œè¡¨è¾¾æ¸…æ™°æ˜äº†ï¼Œä¸æ˜“å‡ºé”™**

```
#!/usr/bin/python3

def fun1(arr):
	while(arr):
		arr.pop()

unprinted_designs = ['phone case', 'robot pendant', 'dodecahedron']
print(unprinted_designs)
fun1(unprinted_designs)
print(unprinted_designs)



def fun2(dict):
	del dict['color']

alien_0 = {'color': 'green', 'points': 5}
print(alien_0)
fun2(alien_0)
print(alien_0)

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
['phone case', 'robot pendant', 'dodecahedron']
[]
{'color': 'green', 'points': 5}
{'points': 5}
```
## ï¼ˆä¼ å€¼ï¼‰ä¼ åˆ—è¡¨åˆ‡ç‰‡
å®åˆ™ä¼ é€’çš„æ˜¯åˆ—è¡¨çš„å‰¯æœ¬ï¼Œå¤–é¢å’Œé‡Œé¢ä¸æ˜¯åŒä¸€ä»½æ•°æ®
```
#!/usr/bin/python3

def fun1(arr):
	while(arr):
		arr.pop()

unprinted_designs = ['phone case', 'robot pendant', 'dodecahedron']
print(unprinted_designs)
fun1(unprinted_designs[:])
print(unprinted_designs)



def fun2(dict):
	del dict['color']

alien_0 = {'color': 'green', 'points': 5}
print(alien_0)
fun2(alien_0)
print(alien_0)

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
['phone case', 'robot pendant', 'dodecahedron']
['phone case', 'robot pendant', 'dodecahedron']
{'color': 'green', 'points': 5}
{'points': 5}

```

## å¯å˜å‚æ•°ï¼ˆ*ä¸**ï¼‰
- åˆ†ä¸ºåŸºäºå…ƒç»„çš„å¯å˜å‚æ•°ï¼ˆ*å¯å˜å‚æ•°ï¼‰ä¸åŸºäºå­—å…¸çš„å¯å˜å‚æ•°ï¼ˆ**å¯å˜å‚æ•°ï¼‰
- æ•ˆæœç±»ä¼¼perlçš„ARGVä¸@_

```
ä¸‹ä¾‹* toppingså®åˆ™ä¼šå˜ä¸ºå…ƒç¥–ï¼Œå†…å®¹ä¸º('mushrooms', 'green peppers', 'extra cheese')ã€‚

#!/usr/bin/python3
def make_pizza(size, *toppings):
	print(f"\nMaking a {size}-inch pizza with the following toppings:")
	for topping in toppings:
		print(f"- {topping}")
make_pizza(16, 'pepperoni')
make_pizza(12, 'mushrooms', 'green peppers', 'extra cheese')


def build_profile(first, last, **user_info):
	user_info['first_name'] = first
	user_info['last_name'] = last
	return user_info
user_profile = build_profile('albert', 'einstein', location='princeton', field='physics')
print(user_profile)

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"

Making a 16-inch pizza with the following toppings:
- pepperoni

Making a 12-inch pizza with the following toppings:
- mushrooms
- green peppers
- extra cheese
{'location': 'princeton', 'field': 'physics', 'first_name': 'albert', 'last_name': 'einstein'}
```
- å¦‚æœåœ¨å®šä¹‰å’Œè°ƒç”¨å‡½æ•°æ—¶éƒ½ä½¿ç”¨*æˆ–**ï¼Œå°†åªèƒ½ä¼ é€’å…ƒç»„æˆ–å­—å…¸ã€‚åè€Œä¸ä¾¿

å¦‚ä¸‹ï¼Œä¸¤ç§æ–¹å¼ç»“æœä¸€æ ·
```
def with_stars(**kwds): 
	print(kwds['name'], 'is', kwds['age'], 'years old') 

def without_stars(kwds): 
	print(kwds['name'], 'is', kwds['age'], 'years old') 

args = {'name': 'Mr. Gumby', 'age': 42} 
with_stars(**args) 
without_stars(args) 

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
Mr. Gumby is 42 years old
Mr. Gumby is 42 years old
```
- åªæœ‰åœ¨å®šä¹‰å‡½æ•°ï¼ˆå…è®¸å¯å˜æ•°é‡çš„å‚æ•°ï¼‰æˆ–è°ƒç”¨å‡½æ•°æ—¶ï¼ˆæ‹†åˆ†å­—å…¸æˆ–åºåˆ—ï¼‰ä½¿ç”¨ï¼Œæ˜Ÿå·æ‰èƒ½å‘æŒ¥ä½œç”¨

ä½¿ç”¨è¿™äº›æ‹†åˆ†è¿ç®—ç¬¦æ¥ä¼ é€’å‚æ•°å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºè¿™æ ·æ— éœ€æ“å¿ƒå‚æ•°ä¸ªæ•°ä¹‹ç±»çš„é—®é¢˜ï¼Œå¦‚ä¸‹è¿™åœ¨è°ƒç”¨è¶…ç±»çš„æ„é€ å‡½æ•°æ—¶ç‰¹åˆ«æœ‰ç”¨
```
def foo(x, y, z, m=0, n=0): 
	print(x, y, z, m, n) 
def call_foo(*args, **kwds): 
	print("Calling foo!") 
	foo(*args, **kwds) 
```
ç»¼åˆçš„ç®€å•æ¡ˆä¾‹
```
def story(**kwds): 
	return 'Once upon a time, there was a {job} called {name}.'.format_map(kwds)
def power(x, y, *others): 
	if others: 
		print('Received redundant parameters:', others) 
	return pow(x, y) 
def interval(start, stop=None, step=1): 
	'Imitates range() for step > 0' 
	if stop is None: # å¦‚æœæ²¡æœ‰ç»™å‚æ•°stopæŒ‡å®šå€¼ï¼Œ
		start, stop = 0, start # å°±è°ƒæ•´å‚æ•°startå’Œstopçš„å€¼
	result = [] 
	i = start # ä»startå¼€å§‹å¾€ä¸Šæ•°
	while i < stop:  # æ•°åˆ°stopä½ç½®
		result.append(i) # å°†å½“å‰æ•°çš„æ•°é™„åŠ åˆ°resultæœ«å°¾
		i += step # å¢åŠ åˆ°å½“å‰æ•°å’Œstepï¼ˆ> 0ï¼‰ä¹‹å’Œ
	return result

print(story(job='king', name='Gumby')) 
print(story(name='Sir Robin', job='brave knight')) 
params = {'job': 'language', 'name': 'Python'} 
print(story(**params)) 
del params['job'] 
print(story(job='stroke of genius', **params)) 
print(power(2, 3))
print(power(3, 2))
print(power(y=3, x=2))
params = (5,) * 2 
print(power(*params))
print(power(3, 3, 'Hello, world'))
print(interval(10))
print(interval(1, 5))
print(interval(3, 12, 4))
print(power(*interval(3, 7)))

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
Once upon a time, there was a king called Gumby.
Once upon a time, there was a brave knight called Sir Robin.
Once upon a time, there was a language called Python.
Once upon a time, there was a stroke of genius called Python.
8
9
8
3125
Received redundant parameters: ('Hello, world',)
27
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
[1, 2, 3, 4]
[3, 7, 11]
Received redundant parameters: (5, 6)
81
```
å¤æ‚çš„æ¡ˆä¾‹
```
def tag(name, *content, cls=None, **attrs):
	if cls is not None:
		attrs['class'] = cls
	if attrs:
		attr_str = ''.join(' %s="%s"' % (attr, value) for attr, value in sorted(attrs.items()))
	else:
		attr_str = ''
	if content:
		return '\n'.join('<%s%s>%s</%s>' % (name, attr_str, c, name) for c in content)
	else:
		return '<%s%s />' % (name, attr_str)

print(tag('br'))	ä¼ å…¥å•ä¸ªå®šä½å‚æ•°ï¼Œç”Ÿæˆä¸€ä¸ªæŒ‡å®šåç§°çš„ç©ºæ ‡ç­¾ã€‚
print(tag('p', 'hello'))	ç¬¬ä¸€ä¸ªå‚æ•°åé¢çš„ä»»æ„ä¸ªå‚æ•°ä¼šè¢« *content æ•è·ï¼Œå­˜å…¥ä¸€ä¸ªå…ƒç»„
print(tag('p', 'hello', 'world'))
print(tag('p', 'hello', id=33))	tag å‡½æ•°ç­¾åä¸­æ²¡æœ‰æ˜ç¡®æŒ‡å®šåç§°çš„å…³é”®å­—å‚æ•°ä¼šè¢« **attrs æ•è·ï¼Œå­˜å…¥ä¸€ä¸ªå­—å…¸ã€‚
print(tag('p', 'hello', 'world', cls='sidebar'))	cls å‚æ•°åªèƒ½ä½œä¸ºå…³é”®å­—å‚æ•°ä¼ å…¥
print(tag(content='testing', name="img"))	è°ƒç”¨ tag å‡½æ•°æ—¶ï¼Œå³ä¾¿ç¬¬ä¸€ä¸ªå®šä½å‚æ•°ä¹Ÿèƒ½ä½œä¸ºå…³é”®å­—å‚æ•°ä¼ å…¥ã€‚

my_tag = {'name': 'img', 'title': 'Sunset Boulevard','src': 'sunset.jpg', 'cls': 'framed'}
print(tag(**my_tag))	åœ¨ my_tag å‰é¢åŠ ä¸Š **ï¼Œå­—å…¸ä¸­çš„æ‰€æœ‰å…ƒç´ ä½œä¸ºå•ä¸ªå‚æ•°ä¼ å…¥ï¼ŒåŒåé”®ä¼šç»‘å®šåˆ°å¯¹åº”çš„
å…·åå‚æ•°ä¸Šï¼Œä½™ä¸‹çš„åˆ™è¢« **attrs æ•è·ã€‚


[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/bbb/src/pyth.py"
<br />
<p>hello</p>
<p>hello</p>
<p>world</p>
<p id="33">hello</p>
<p class="sidebar">hello</p>
<p class="sidebar">world</p>
<img content="testing" />
<img class="framed" src="sunset.jpg" title="Sunset Boulevard" />
```

## å‡½æ•°æŒ‡é’ˆ
å¯ä»¥å°†å˜é‡æŒ‡å‘å‡½æ•°ï¼Œæ­¤å˜é‡ç±»å‹æ˜¯functionï¼Œè™½éƒ½æ˜¯functionä½†ä¸åŒå‡½æ•°ç­¾åçš„åº•å±‚å¹¶ä¸åŒ
```
def add(a,b):
    return a+b

def sub(a,b):
    return a-b

def square(a):
    return a*b

def calc(opr):
    if opr=='+':
        return add
    else:
        return sub

f1 = calc('+')
f2 = calc('-')
print("10+5={0}".format(f1(10,5)))
print("10-5={0}".format(f2(10,5)))
print(type(f1))
print(type(f2))
print(type(square))

[huawei@n161 ccc]$ python3 1.py
10+5=15
10-5=5
<class 'function'>
<class 'function'>
<class 'function'>
```

## é«˜é˜¶å‡½æ•°
åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œå¯ä»¥å°†å‡½æ•°å½“ä½œå˜é‡ä¸€æ ·è‡ªç”±ä½¿ç”¨ã€‚ä¸€ä¸ªå‡½æ•°æ¥æ”¶å¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿™ç§å‡½æ•°ç§°ä¹‹ä¸ºé«˜é˜¶å‡½æ•°ã€‚å¸¸ç”¨é«˜é˜¶å‡½æ•°æœ‰mapã€reduceã€filterã€sortedã€zipã€‚ã€‚ã€‚

## reduce
reduce å‡½æ•°éœ€è¦ä¼ å…¥ä¸€ä¸ªæœ‰ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œç„¶åç”¨è¿™ä¸ªå‡½æ•°ä»å·¦è‡³å³é¡ºåºéå†åºåˆ—å¹¶ç”Ÿæˆç»“æœï¼Œå®šä¹‰å¦‚ä¸‹ï¼šreduce(function, sequence[, initial]) -> value
- functionï¼šå‡½æ•°, åºåˆ—ä¸­çš„æ¯ä¸ªå…ƒç´ éœ€è¦æ‰§è¡Œçš„æ“ä½œ, å¯ä»¥æ˜¯åŒ¿åå‡½æ•°
- sequenceï¼šéœ€è¦æ‰§è¡Œæ“ä½œçš„åºåˆ—
- initialï¼šå¯é€‰ï¼Œåˆå§‹å‚æ•°
- æœ€åè¿”å›å‡½æ•°çš„è®¡ç®—ç»“æœ, å’Œåˆå§‹å‚æ•°ç±»å‹ç›¸åŒ
- éœ€è¦æ³¨æ„çš„æ˜¯ï¼šåºåˆ—æ•°æ®ç±»å‹éœ€è¦å’Œåˆå§‹å‚æ•°ä¸€è‡´ã€‚

```
# æ³¨æ„ï¼Œç°åœ¨ reduce() å‡½æ•°å·²ç»æ”¾å…¥åˆ°functoolsåŒ…ä¸­ã€‚
from functools import reduce
result = reduce(lambda x, y: x + y, [1, 2, 3, 4, 5])
print(result)
# print out 15
s = reduce(lambda x, y: x + y, ['1', '2', '3', '4', '5'], "æ•°å­— = ")
print(s)

[huawei@n161 ccc]$ python3 1.py
15
æ•°å­— = 12345
```

## filter

filter() å‡½æ•°ç”¨æ¥è¿‡æ»¤åºåˆ—ä¸­ä¸ç¬¦åˆæ¡ä»¶çš„å€¼ï¼Œè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¯¥è¿­ä»£å™¨ç”Ÿæˆé‚£äº›å‡½æ•°(é¡¹)ä¸º true çš„ iterable é¡¹ã€‚å¦‚æœå‡½æ•°ä¸º Noneï¼Œåˆ™è¿”å›ä¸º true çš„é¡¹ã€‚å®šä¹‰å¦‚ä¸‹ï¼šfilter(function or None, iterable) --> filter object
- function or Noneï¼šè¿‡æ»¤æ“ä½œæ‰§è¡Œçš„å‡½æ•°
- iterableï¼šéœ€è¦è¿‡æ»¤çš„åºåˆ—
```
def boy(n):
    if n % 2 == 0:
        return True
    return False

# è‡ªå®šä¹‰å‡½æ•°
filterList = filter(boy, list(range(20)))

print(list(filterList))
# print out: [0, 2, 4, 6, 8, 10, 12, 14, 16, 18]

# è‡ªå®šä¹‰å‡½æ•°
filterList2 = filter(lambda n: n % 2 == 0, list(range(20)))

print(list(filterList2))
# print out: [0, 2, 4, 6, 8, 10, 12, 14, 16, 18]

[huawei@n161 ccc]$ python3 1.py
[0, 2, 4, 6, 8, 10, 12, 14, 16, 18]
[0, 2, 4, 6, 8, 10, 12, 14, 16, 18]
```

è¿˜å¯ä»¥å‚è€ƒ[ç”¨äºè¿‡æ»¤çš„ç”Ÿæˆå™¨å‡½æ•°](#ç”¨äºè¿‡æ»¤çš„ç”Ÿæˆå™¨å‡½æ•°)
```
def f1(x):
    return x>50

data1 = [10, 30, 60, 100]
data2 = filter(f1, data1)
data3 = list(data2)
print(data3)

[huawei@n161 ccc]$ python3 1.py
[60, 100]

```

## map

æ ¹æ®æä¾›çš„å‡½æ•°å¯¹æŒ‡å®šåºåˆ—åšæ˜ å°„, å¹¶è¿”å›æ˜ å°„åçš„åºåˆ—ï¼Œå®šä¹‰ï¼š
map(func, *iterables) --> map object
- functionï¼šåºåˆ—ä¸­çš„æ¯ä¸ªå…ƒç´ éœ€è¦æ‰§è¡Œçš„æ“ä½œ, å¯ä»¥æ˜¯åŒ¿åå‡½æ•°
- *iterablesï¼šä¸€ä¸ªæˆ–å¤šä¸ªåºåˆ—

```
from math import factorial

def square(n):
    return n ** 2

# ä½¿ç”¨pythonè‡ªå¸¦æ•°å­¦å‡½æ•°
facMap = map(factorial, list(range(10)))
print(list(facMap))
# print out: [1, 1, 2, 6, 24, 120, 720, 5040, 40320, 362880]

# ä½¿ç”¨è‡ªå®šä¹‰å‡½æ•°
squareMap = map(square, list(range(10)))
print(list(squareMap))
# print out: [0, 1, 4, 9, 16, 25, 36, 49, 64, 81]


# ä½¿ç”¨åŒ¿åå‡½æ•°
lamMap = map(lambda x: x * 2, list(range(10)))
print(list(lamMap))
# print out: [0, 2, 4, 6, 8, 10, 12, 14, 16, 18]

# ä¼ å…¥å¤šä¸ªåºåˆ—
mutiMap = map(lambda x, y: x+y, list(range(10)), list(range(11, 15)))
print(list(mutiMap))
# print out: [11, 13, 15, 17]

[huawei@n161 ccc]$ python3 1.py
[1, 1, 2, 6, 24, 120, 720, 5040, 40320, 362880]
[0, 1, 4, 9, 16, 25, 36, 49, 64, 81]
[0, 2, 4, 6, 8, 10, 12, 14, 16, 18]
[11, 13, 15, 17]

```
è¿˜å¯ä»¥å‚è€ƒ[ç”¨äºæ˜ å°„çš„ç”Ÿæˆå™¨å‡½æ•°](#ç”¨äºæ˜ å°„çš„ç”Ÿæˆå™¨å‡½æ•°)
```
def f1(x):
    return x*2

data1 = [10, 30, 60, 100]
data2 = map(f1, data1)
data3 = list(data2)
print(data3)

[huawei@n161 ccc]$ python3 1.py
[20, 60, 120, 200]
```

## sorted

sorted å‡½æ•°é»˜è®¤å°†åºåˆ—å‡åºæ’åˆ—åè¿”å›ä¸€ä¸ªæ–°çš„ listï¼Œè¿˜å¯ä»¥è‡ªå®šä¹‰é”®å‡½æ•°æ¥è¿›è¡Œæ’åºï¼Œä¹Ÿå¯ä»¥è®¾ç½® reverse å‚æ•°ç¡®å®šæ˜¯å‡åºè¿˜æ˜¯é™åºï¼Œå¦‚æœ reverse = True åˆ™ä¸ºé™åºã€‚å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š
```
def sorted(iterable: Iterable[_T], *,
           key: Optional[Callable[[_T], Any]] = ...,
           reverse: bool = ...) -> List[_T]: ...
iterable # åºåˆ—
key # å¯ä»¥ç”¨æ¥è®¡ç®—çš„æ’åºå‡½æ•°ã€‚
reverse # æ’åºè§„åˆ™ï¼Œreverse = True é™åºï¼Œreverse = False å‡åº(é»˜è®¤ï¼‰ã€‚
```
æ¡ˆä¾‹
```
list01 = [5, -1, 3, 6, -7, 8, -11, 2]
list02 = ['apple', 'pig', 'monkey', 'money']

print(sorted(list01))
# print out: [-11, -7, -1, 2, 3, 5, 6, 8]

print(sorted(list01, key=abs))
# print out: [-1, 2, 3, 5, 6, -7, 8, -11]

# é»˜è®¤å‡åº
print(sorted(list02))
# print out: ['apple', 'money', 'monkey', 'pig']

# é™åº
print(sorted(list02, reverse=True))
# print out: ['pig', 'monkey', 'money', 'apple']

# åŒ¿åå‡½æ•°æ’åº
print(sorted(list02, key=lambda x: len(x), reverse=True))
# print out: ['monkey', 'apple', 'money', 'pig']
```

## ä¼ é€’å‡½æ•°

å…¶å®ä¼ çš„æ˜¯ä¸ªå¯¹è±¡
```
def sum_args(*args):
	return sum(args)

def run_with_positional_args(func, *args):
	return func(*args)

print(run_with_positional_args(sum_args, 1, 2, 3, 4))	# 10
```
## å†…éƒ¨å‡½æ•°
```
def outer(a, b):
	def inner(c, d):
		return c + d
	return inner(a, b)

print(outer(4, 7))	# 11
```


## lambda
- lambda å…³é”®å­—åœ¨ Python è¡¨è¾¾å¼å†…åˆ›å»ºåŒ¿åå‡½æ•°ã€‚
- lambda å‡½æ•°çš„å®šä¹‰ä½“ä¸­ä¸èƒ½èµ‹å€¼ï¼Œä¹Ÿä¸èƒ½ä½¿ç”¨ while å’Œ try ç­‰è¯­å¥ï¼Œä»…å¯ä¸€æ¡è¯­å¥ï¼Œä¸ç”¨å†™return
- lambda å¥æ³•åªæ˜¯è¯­æ³•ç³–ï¼šä¸ def è¯­å¥ä¸€æ ·ï¼Œlambda è¡¨è¾¾å¼ä¼šåˆ›å»ºå‡½æ•°å¯¹è±¡ã€‚  

è¯­æ³•ï¼šâ€œlambda å‚æ•°åˆ—è¡¨ï¼šlabmdaä½“â€ï¼Œæ— éœ€å°æ‹¬å·ä¸return

```
ç®€å•çš„é¢lambdaä½¿ç”¨æ¼”ç¤º
def calc(opr):
    if opr == '+':
        return lambda a, b: (a+b)
    else:
        return lambda a, b: (a-b)

f1 = calc('+')
f2 = calc('-')
print("10+5={0}".format(f1(10,5)))
print("10-5={0}".format(f2(10,5)))

[huawei@n161 ccc]$ python3 1.py
10+5=15
10-5=5

æ¼”ç¤º2
def edit_story(words, func):
	for word in words:
		print(func(word))

def enliven(word):
	return word.capitalize() + '!'


stairs = ['thud', 'meow', 'thud', 'hiss']
print("-----func:")
edit_story(stairs, enliven)

print("-----lambda:")
edit_story(stairs, lambda word: word.capitalize() + '!')

[huawei@n148 doc]$ python -u "/home/huawei/hwwork/doc/md/aaa/pltest/pyth.py"
-----func:
Thud!
Meow!
Thud!
Hiss!
-----lambda:
Thud!
Meow!
Thud!
Hiss!

```
å°†å‰é¢çš„filterä¸mapæ¢ä¸ºlambdaå½¢å¼
```
data1 = [10, 30, 60, 100]
data2 = filter(lambda x: (x > 50), data1)
data3 = list(data2)
print(data3)
data2 = map(lambda x: (x * 2), data1)
data3 = list(data2)
print(data3)

[huawei@n161 ccc]$ python3 1.py
[60, 100]
[20, 60, 120, 200]
```
## è£…é¥°å™¨
    è£…é¥°å™¨ï¼ˆdecoratorï¼‰ï¼Œåˆç§°â€œè£…é¥°å‡½æ•°â€ï¼Œå³ä¸€ç§è¿”å›å€¼ä¹Ÿæ˜¯å‡½æ•°çš„å‡½æ•°ï¼Œå¯ä»¥ç§°ä¹‹ä¸ºâ€œå‡½æ•°çš„å‡½æ•°â€ã€‚å…¶ç›®çš„æ˜¯åœ¨ä¸å¯¹ç°æœ‰å‡½æ•°è¿›è¡Œä¿®æ”¹çš„æƒ…å†µä¸‹ï¼Œå®ç°é¢å¤–çš„åŠŸèƒ½ã€‚æœ€åŸºæœ¬çš„ç†å¿µæ¥è‡ªäºä¸€ç§è¢«ç§°ä¸ºâ€œè£…é¥°æ¨¡å¼â€çš„è®¾è®¡æ¨¡å¼ã€‚åœ¨ Python ä¸­ï¼Œè£…é¥°å™¨å±äºçº¯ç²¹çš„â€œè¯­æ³•ç³–â€ï¼Œä¸ä½¿ç”¨ä¹Ÿæ²¡å…³ç³»ï¼Œä½†æ˜¯ä½¿ç”¨çš„è¯èƒ½å¤Ÿå¤§å¤§ç®€åŒ–ä»£ç ï¼Œä½¿ä»£ç æ›´åŠ æ˜“è¯»â€”â€”å½“ç„¶ï¼Œæ˜¯å¯¹çŸ¥é“è¿™æ˜¯æ€ä¹ˆå›äº‹å„¿çš„äººè€Œè¨€ã€‚

- è£…é¥°å™¨æ˜¯å¯è°ƒç”¨çš„å¯¹è±¡ï¼Œå…¶å‚æ•°æ˜¯å¦ä¸€ä¸ªå‡½æ•°ï¼ˆè¢«è£…é¥°çš„å‡½æ•°ï¼‰ã€‚
- å‡½æ•°è£…é¥°å™¨åœ¨å¯¼å…¥æ¨¡å—æ—¶ç«‹å³æ‰§è¡Œï¼Œè€Œè¢«è£…é¥°çš„å‡½æ•°åªåœ¨æ˜ç¡®è°ƒç”¨æ—¶è¿è¡Œã€‚è¿™çªå‡ºäº†æ‰€è°“çš„å¯¼å…¥æ—¶å’Œè¿è¡Œæ—¶ä¹‹é—´çš„åŒºåˆ«ã€‚
- è£…é¥°å™¨å’Œè¢«è£…é¥°çš„å‡½æ•°å¯ä»¥åœ¨2ä¸ªä¸åŒæ¨¡å—é‡Œ
- è£…é¥°å™¨å†…è¿”å›çš„ç»“æœå¯ä»¥æ˜¯å€¼ä¹Ÿå¯ä»¥æ˜¯å‡½æ•°å¯¹è±¡ï¼ˆä¸æ˜¯ä¼ å…¥çš„å‡½æ•°ï¼Œè€Œæ˜¯ä¼šå®šä¹‰ä¸€ä¸ªå†…éƒ¨å‡½æ•°ï¼Œç„¶åå°†å…¶è¿”å›ï¼Œæ›¿æ¢è¢«è£…é¥°çš„å‡½æ•°ï¼‰
- Python å†…ç½®äº†ä¸‰ä¸ªç”¨äºè£…é¥°æ–¹æ³•çš„å‡½æ•°ï¼špropertyã€classmethod å’Œ staticmethodã€‚

ç®€å•çš„æ¼”ç¤ºæ¡ˆä¾‹
```
registry = []
def register(func):	# register çš„å‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°
	print('running register(%s)' % func)
	registry.append(func)
	return func	# è¿”å› funcï¼šå¿…é¡»è¿”å›å‡½æ•°ï¼›è¿™é‡Œè¿”å›çš„å‡½æ•°ä¸é€šè¿‡å‚æ•°ä¼ å…¥çš„ä¸€æ ·ã€‚

@register		# f1 å’Œ f2 è¢« @register è£…é¥°
def f1():
	print('running f1()')
@register
def f2():
	print('running f2()')
def f3():		# f3 æ²¡æœ‰è£…é¥°
	print('running f3()')
def main():
	print('running main()')
	print('registry ->', registry)	# æ‰“å°åˆ—è¡¨ï¼Œæ‰§è¡Œf1f2f3
	f1()
	f2()
	f3()
if __name__=='__main__':
	main()

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/bbb/src/pyth.py"
running register(<function f1 at 0x7fe2d585b1e0>)	# register åœ¨æ¨¡å—ä¸­å…¶ä»–å‡½æ•°ä¹‹å‰è¿è¡Œäº†ä¸¤æ¬¡
running register(<function f2 at 0x7fe2d585b268>)	# å¦‚æœä»…ä»…æ˜¯å¯¼å…¥æ­¤pyåˆ™åªä¼šæ‰“å°å‡ºè¿™ä¸¤å¥ï¼Œå› ä¸ä¼šæ‰§è¡Œmainå‡½æ•°
running main()
registry -> [<function f1 at 0x7fe2d585b1e0>, <function f2 at 0x7fe2d585b268>]
running f1()
running f2()
running f3()
```
## å‡½æ•°è£…é¥°å™¨
http://www.ityouknow.com/python/2019/09/22/Python-decorator-020.html

## é—­åŒ…

é—­åŒ…æ˜¯ä¸€ä¸ªå¯ä»¥ç”±å¦ä¸€ä¸ªå‡½æ•°åŠ¨æ€ç”Ÿæˆçš„å‡½æ•°ï¼Œå¹¶ä¸”å¯ä»¥æ”¹å˜å’Œå­˜å‚¨å‡½æ•°å¤–åˆ›å»ºçš„å˜é‡çš„å€¼ï¼Œå…¶å®å†…éƒ¨å‡½æ•°å¯ä»¥çœ‹ä½œä¸ºé—­åŒ…ï¼Œåªä¸è¿‡æ²¡æœ‰ä½“ç°å‡ºç²¾é«“è€Œå·²ã€‚
- é—­åŒ…æŒ‡å»¶ä¼¸äº†ä½œç”¨åŸŸçš„å‡½æ•°ï¼Œå…¶ä¸­åŒ…å«å‡½æ•°å®šä¹‰ä½“ä¸­å¼•ç”¨çš„ä½†åˆæ²¡åœ¨å®šä¹‰ä½“ä¸­å®šä¹‰çš„éå…¨å±€å˜é‡
- å‡½æ•°æ˜¯ä¸æ˜¯åŒ¿åçš„æ²¡æœ‰å…³ç³»ï¼Œå…³é”®æ˜¯å®ƒèƒ½è®¿é—®å®šä¹‰ä½“ä¹‹å¤–å®šä¹‰çš„éå…¨å±€å˜é‡

é€šè¿‡ä¸‹æ¡ˆä¾‹ä»‹ç»é—­åŒ…ç‰¹ç‚¹ï¼š
- inner2() ç›´æ¥ä½¿ç”¨å¤–éƒ¨çš„ saying å‚æ•°ï¼Œè€Œä¸æ˜¯é€šè¿‡å¦å¤–ä¸€ä¸ªå‚æ•°è·å–ã€‚ï¼ˆä¸ä¸Šé¢å†…éƒ¨å‡½æ•°çš„æ¡ˆä¾‹ä¸­çš„å‚æ•°ä¼ é€’æ–¹å¼å¯¹æ¯”æŸ¥çœ‹å³å¯ï¼‰
- knights2() è¿”å›å€¼ä¸º inner2 å‡½æ•°ï¼Œè€Œä¸æ˜¯è°ƒç”¨å®ƒã€‚ï¼ˆå¯¹æ¯”åŒä¸Šï¼‰
- inner2() å‡½æ•°å¯ä»¥å¾—åˆ° saying å‚æ•°çš„å€¼å¹¶ä¸”è®°å½•ä¸‹æ¥ã€‚
- return inner2 å‡†ç¡®çš„è¯´æ˜¯è¿”å›1ä¸ªæ²¡æœ‰è¢«è°ƒç”¨è¿‡çš„å‡½æ•°å¯¹è±¡ï¼ˆæ˜¯ä¸€ä¸ªé—­åŒ…ï¼šä¸€ä¸ªè¢«åŠ¨æ€åˆ›å»ºçš„å¯ä»¥è®°å½•å¤–éƒ¨å˜é‡çš„å‡½æ•°ï¼‰ã€‚


```
def knights2(saying):
	def inner2():
		return "We are the knights who say: '%s'" % saying
	return inner2

a = knights2('Duck')
print(type(a))	# açš„typeæ˜¯å‡½æ•°
print(a)	# è¿™æ ·æ‰“å°å‡ºæ¥çš„å†…å®¹è²Œä¼¼æ˜¯açš„åœ°å€
print(a())	# è°ƒç”¨å‡½æ•°å¯¹è±¡


b = knights2('Hasenpfeffer')
print(type(b))
print(b)
print(b())


[huawei@n148 doc]$ python -u "/home/huawei/hwwork/doc/md/aaa/pltest/pyth.py"
<type 'function'>
<function inner2 at 0x7f814caec7d0>
We are the knights who say: 'Duck'
<type 'function'>
<function inner2 at 0x7f814caec848>
We are the knights who say: 'Hasenpfeffer'
```
## nonlocal
å¦‚æœä¸º nonlocal å£°æ˜çš„å˜é‡èµ‹äºˆæ–°å€¼ï¼Œé—­åŒ…ä¸­ä¿å­˜çš„ç»‘å®šä¼šæ›´æ–°ã€‚  
```
ä¸‹ä¾‹ä¸­countã€totalå¯ä»¥åœ¨é—­åŒ…é‡Œæ›´æ–°

def make_averager():
	count = 0
	total = 0
	def averager(new_value):
		nonlocal count, total
		count += 1
		total += new_value
		return total / count
	return averager

avg = make_averager()
print(avg(10))
print(avg(20))
print(avg(30))

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/bbb/src/pyth.py"
10.0
15.0
20.0
```

# æ¨¡å—
- ç±»æ”¯æŒç»§æ‰¿ï¼Œä½†æ¨¡å—ä¸æ”¯æŒã€‚Python æ¨¡å—æ˜¯å•ä¾‹

## æ£€æŸ¥ç¬¬ä¸‰æ–¹åº“æ˜¯å¦æ­£ç¡®å®‰è£…

æ­£å¸¸åˆ™æ— ä»»ä½•è¾“å‡ºï¼Œæœªå®‰è£…å¯¹åº”æ¨¡å—åˆ™è¾“å‡ºå¼‚å¸¸
```
[huawei@n161 mdbooks]$ python -c 'import sys'
```

## å®šä¹‰
- æ™®é€šå‡½æ•°æ¨¡å—ï¼Œå¦è§ç±»æ¨¡å—
```
[huawei@n148 pythontest]$ cat pizza.py 
#!/usr/bin/python3
def make_pizza(size, *toppings):
        print(f"\nMaking a {size}-inch pizza with the following toppings:")
        for topping in toppings:
                print(f"- {topping}")
```
## æ¨¡å—æœç´¢è·¯å¾„

- æ¨¡å—sysçš„å˜é‡pathæ‰€åŒ…å«çš„è·¯å¾„åˆ—è¡¨å³æ¨¡å—çš„æœç´¢è·¯å¾„
- æ¨¡å—ä½äºç±»ä¼¼äºsite-packagesè¿™æ ·çš„åœ°æ–¹ï¼Œæ‰€æœ‰çš„ç¨‹åºå°±éƒ½èƒ½å¤Ÿå¯¼å…¥å®ƒ

```
#!/usr/bin/python3
import sys, pprint 
pprint.pprint(sys.path) 

[huawei@n148 pytest]$ python3 pyth.py 
['/home/huawei/hwwork/doc/md/aaa/pytest',
 '/usr/local/lib/python3.6/site-packages/setuptools-19.6-py3.6.egg',
 '/usr/lib64/python36.zip',
 '/usr/lib64/python3.6',
 '/usr/lib64/python3.6/lib-dynload',
 '/usr/local/lib64/python3.6/site-packages',
 '/usr/local/lib/python3.6/site-packages',
 '/usr/lib64/python3.6/site-packages',
 '/usr/lib/python3.6/site-packages']
```
## å¯¼å…¥ç±»
ç±»æ¨¡å—çš„å®šä¹‰åœ¨ä¸Šé¢
```
#!/usr/bin/python3
from car import Car
my_new_car = Car('audi', 'a4', 2019)
print(my_new_car.get_descriptive_name())
my_new_car.odometer_reading = 23
my_new_car.read_odometer()

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
2019 Audi A4
This car has 23 miles on it.
```

## å¯¼å…¥æ•´ä¸ªæ¨¡å—
ä½¿ç”¨importå¯¼å…¥æ–‡ä»¶ä¸»å¹²åï¼Œè°ƒç”¨éœ€è¦ä½œç”¨åŸŸ
```
[huawei@n148 pythontest]$ cat making_pizzas.py 
#!/usr/bin/python3
import pizza
pizza.make_pizza(16, 'pepperoni')
pizza.make_pizza(12, 'mushrooms', 'green peppers', 'extra cheese')
[huawei@n148 pythontest]$ python3 making_pizzas.py 

Making a 16-inch pizza with the following toppings:
- pepperoni

Making a 12-inch pizza with the following toppings:
- mushrooms
- green peppers
- extra cheese
```
## å¯¼å…¥æŒ‡å®šå‡½æ•°
è°ƒç”¨å¯ä»¥ç›´æ¥å‡½æ•°åï¼Œä¸éœ€è¦å¸¦ä½œç”¨åŸŸäº†ï¼Œå…¶å®è¿˜å¯ä»¥å…¨éƒ¨éƒ½å¯¼å…¥ï¼Œå¦‚ from pizza import *
```
[huawei@n148 pythontest]$ cat making_pizzas.py 
#!/usr/bin/python3
from pizza import make_pizza
make_pizza(12, 'mushrooms', 'green peppers', 'extra cheese')
make_pizza(16, 'pepperoni')
[huawei@n148 pythontest]$ python3 making_pizzas.py 

Making a 12-inch pizza with the following toppings:
- mushrooms
- green peppers
- extra cheese

Making a 16-inch pizza with the following toppings:
- pepperoni
```
## ç»™æ¨¡å—æˆ–å‡½æ•°æŒ‡å®šåˆ«å
ç”¨äºé˜²æ­¢åç§°é‡å¤å†²çª
```
#!/usr/bin/python3
from pizza import make_pizza as mp
mp(12, 'mushrooms', 'green peppers', 'extra cheese')
mp(16, 'pepperoni')
```
```
#!/usr/bin/python3
import pizza as p
p.make_pizza(16, 'pepperoni')
p.make_pizza(12, 'mushrooms', 'green peppers', 'extra cheese')
```
## ç±»æ¨¡å—

### å®šä¹‰æ¨¡å—æ–‡ä»¶
è¿™é‡Œå°†å¤šä¸ªç±»å®šä¹‰åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œäº†ï¼Œå…¶å®ä¹Ÿå¯ä»¥åˆ†æ•£å¼€ï¼ˆè§æ¨¡å—å¯¼å…¥æ¨¡å—ï¼‰
```
æ–‡ä»¶å car.py

#!/usr/bin/python3
class Car:
	def __init__(self, make, model, year):
		self.make = make
		self.model = model
		self.year = year
		self.odometer_reading = 0

	def get_descriptive_name(self):
		long_name = f"{self.year} {self.make} {self.model}"
		return long_name.title()
	def read_odometer(self):
		print(f"This car has {self.odometer_reading} miles on it.")
	def update_odometer(self, mileage):
		if mileage >= self.odometer_reading:
			self.odometer_reading = mileage
		else:
			print("You can't roll back an odometer!")
	def increment_odometer(self, miles):
		self.odometer_reading += miles


class Battery:
	def __init__(self, battery_size=75):
		self.battery_size = battery_size
	def describe_battery(self):
		print(f"This car has a {self.battery_size}-kWh battery.")
	def get_range(self):
		if self.battery_size == 75:
			range = 260
		elif self.battery_size == 100:
			range = 315
		print(f"This car can go about {range} miles on a full charge.")


class ElectricCar(Car):
	def __init__(self, make, model, year):
		super().__init__(make, model, year)
		self.battery = Battery()
	def describe_battery(self):
		print(f"This car has a {self.battery_size}-kWh battery.")
```
### ä½¿ç”¨ç±»æ¨¡å—
- è¿™é‡Œåˆ†åˆ«å¯¼å…¥äº†åŸºç±»ä¸å­ç±»
```
#!/usr/bin/python3
from car import Car
my_new_car = Car('audi', 'a4', 2019)
print(my_new_car.get_descriptive_name())
my_new_car.odometer_reading = 23
my_new_car.read_odometer()

from car import ElectricCar
my_tesla = ElectricCar('tesla', 'model s', 2019)
print(my_tesla.get_descriptive_name())
my_tesla.battery.describe_battery()
my_tesla.battery.get_range()


[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
2019 Audi A4
This car has 23 miles on it.
2019 Tesla Model S
This car has a 75-kWh battery.
This car can go about 260 miles on a full charge.

```
- å…¶å®ä¹Ÿå¯ä»¥ä»ä¸€æ¬¡ä»æ¨¡å—ä¸­å¯¼å…¥å¤šä¸ªç±»
```
#!/usr/bin/python3
from car import Car, ElectricCar
my_beetle = Car('volkswagen', 'beetle', 2019)
print(my_beetle.get_descriptive_name())
my_tesla = ElectricCar('tesla', 'roadster', 2019)
print(my_tesla.get_descriptive_name())

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
2019 Volkswagen Beetle
2019 Tesla Roadster
```
- è¿˜å¯ä»¥å¯¼å…¥æ•´ä¸ªæ¨¡å—
```
#!/usr/bin/python3

import car
my_beetle = car.Car('volkswagen', 'beetle', 2019)
print(my_beetle.get_descriptive_name())
my_tesla = car.ElectricCar('tesla', 'roadster', 2019)
print(my_tesla.get_descriptive_name())
```

## æ¨¡å—å¯¼å…¥æ¨¡å—
å³å°†ä¸åŒç±»åˆ†æ•£åˆ°ä¸åŒæ–‡ä»¶ä¸­
- åŸºç±»æ¨¡å—
```
[huawei@n148 pythontest]$ cat car.py 
#!/usr/bin/python3

class Car:
        def __init__(self, make, model, year):
                self.make = make
                self.model = model
                self.year = year
                self.odometer_reading = 0

        def get_descriptive_name(self):
                long_name = f"{self.year} {self.make} {self.model}"
                return long_name.title()
        def read_odometer(self):
                print(f"This car has {self.odometer_reading} miles on it.")
        def update_odometer(self, mileage):
                if mileage >= self.odometer_reading:
                        self.odometer_reading = mileage
                else:
                        print("You can't roll back an odometer!")
        def increment_odometer(self, miles):
                self.odometer_reading += miles
```
- å­ç±»æ¨¡å—ï¼Œæ­¤æ¨¡å—éœ€å¯¼å…¥åŸºç±»æ¨¡å—
```
[huawei@n148 pythontest]$ cat electric_car.py 
#!/usr/bin/python3
from car import Car

class Battery:
        def __init__(self, battery_size=75):
                self.battery_size = battery_size
        def describe_battery(self):
                print(f"This car has a {self.battery_size}-kWh battery.")
        def get_range(self):
                if self.battery_size == 75:
                        range = 260
                elif self.battery_size == 100:
                        range = 315
                print(f"This car can go about {range} miles on a full charge.")


class ElectricCar(Car):
        def __init__(self, make, model, year):
                super().__init__(make, model, year)
                self.battery = Battery()
        def describe_battery(self):
                print(f"This car has a {self.battery_size}-kWh battery.")
```
- ä½¿ç”¨çš„ä»£ç ï¼Œå¯¼å…¥å¤šä¸ªæ¨¡å—å³å¯
```
#!/usr/bin/python3

from car import Car
from electric_car import ElectricCar
my_beetle = Car('volkswagen', 'beetle', 2019)
print(my_beetle.get_descriptive_name())
my_tesla = ElectricCar('tesla', 'roadster', 2019)
print(my_tesla.get_descriptive_name())

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
2019 Volkswagen Beetle
2019 Tesla Roadster
```
## æ¨¡å—çš„æµ‹è¯•æ–¹æ³•
```
æ¨¡å—æ–‡ä»¶æä¾›äº†ä¸€ä¸ªæ–¹æ³•ä¸æµ‹è¯•å‡½æ•°ï¼Œæ ¹æ®__name__å˜é‡çš„å€¼æ¥è¿›è¡Œåˆ¤æ–­æ˜¯å¦è¿è¡Œtestæ–¹æ³•
[huawei@n148 pytest]$ cat hello.py 
#!/usr/bin/python3
def hello(): 
        print("Hello, world!") 
def test(): 
        hello() 

print(__name__)
if __name__ == '__main__': test() 

ä¸‹é¢æ˜¯mainä»£ç 
[huawei@n148 pytest]$ cat pyth.py 
#!/usr/bin/python3
import hello;
hello.hello()

æ‰§è¡Œæ¨¡å—è‡ªèº«åˆ™ä¼šè°ƒç”¨test
[huawei@n148 pytest]$ python3 hello.py
__main__
Hello, world!

æ‰§è¡Œmainä»£ç åˆ™ä¸è§¦å‘test
[huawei@n148 pytest]$ python3 pyth.py 
hello
```
## åŒ…
- åŒ…(package)æ˜¯å¤šä¸ªæ¨¡å—çš„èšåˆä½“å½¢æˆçš„æ–‡ä»¶å¤¹ï¼Œé‡Œé¢å¯ä»¥æ˜¯å¤šä¸ª py æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥åµŒå¥—æ–‡ä»¶å¤¹
- åŒ…æ˜¯ä¸€ä¸ªç›®å½•ï¼Œç›®å½•å†…å¿…é¡»åŒ…å«æ–‡ä»¶__init__.py
- å¦‚æœåƒæ™®é€šæ¨¡å—ä¸€æ ·å¯¼å…¥åŒ…ï¼Œæ–‡ä»¶__init__.pyçš„å†…å®¹å°±å°†æ˜¯åŒ…çš„å†…å®¹
- è¦å°†æ¨¡å—åŠ å…¥åŒ…ä¸­ï¼Œåªéœ€å°†æ¨¡å—æ–‡ä»¶æ”¾åœ¨åŒ…ç›®å½•ä¸­å³å¯
- åŒ…ä¸­å¯ä»¥åµŒå¥—å…¶ä»–åŒ…ï¼Œå³ç›®å½•å¯ä»¥å¤šå±‚ï¼Œå¦‚ä¸‹
	- ~/python/ PYTHONPATHä¸­çš„ç›®å½•
	- ~/python/drawing/ åŒ…ç›®å½•ï¼ˆåŒ…drawingï¼‰
	- ~/python/drawing/__init__.py åŒ…ä»£ç ï¼ˆæ¨¡å—drawingï¼‰
	- ~/python/drawing/colors.py æ¨¡å—colors
	- ~/python/drawing/shapes.py æ¨¡å—shapes
- è²Œä¼¼ä¹Ÿå¯ä»¥å«init.pyã€‚è¿™ä¸ªæ–‡ä»¶å¯ä»¥æ˜¯ç©ºçš„ï¼Œä½†æ˜¯ Python éœ€è¦å®ƒï¼Œä»¥ä¾¿æŠŠè¯¥ç›®å½•ä½œä¸ºä¸€ä¸ªåŒ…ã€‚
```
	å®Œæˆè¿™äº›å‡†å¤‡å·¥ä½œåï¼Œä¸‹é¢çš„è¯­å¥éƒ½æ˜¯åˆæ³•çš„ï¼š
	import drawing # (1) å¯¼å…¥drawingåŒ…
	import drawing.colors # (2) å¯¼å…¥drawingåŒ…ä¸­çš„æ¨¡å—colors 
	from drawing import shapes # (3) å¯¼å…¥æ¨¡å—shapes
```

# unittest

## æµ‹è¯•å‡½æ•°
```
å®šä¹‰ä¸€ä¸ªæ–¹æ³•
[huawei@n148 pytest]$ cat name_function.py 
#!/usr/bin/python3
def get_formatted_name(first, last, middle=''):
	if middle:
		full_name = f"{first} {middle} {last}"
	else:
		full_name = f"{first} {last}"
	return full_name.title()



ä¸‹é¢æ˜¯æµ‹è¯•ä»£ç 
[huawei@n148 pytest]$ cat test_name_function.py 
import unittest
from name_function import get_formatted_name

class NamesTestCase(unittest.TestCase):
	def test_first_last_name(self):
		formatted_name = get_formatted_name('janis', 'joplin')
		self.assertEqual(formatted_name, 'Janis Joplin')
	def test_first_last_middle_name(self):
		formatted_name = get_formatted_name('wolfgang', 'mozart', 'amadeus')
		self.assertEqual(formatted_name, 'Wolfgang Amadeus Mozart')

if __name__ == '__main__':
	unittest.main()


è¿è¡Œç»“æœ
[huawei@n148 pytest]$ python3 test_name_function.py 
.
----------------------------------------------------------------------
Ran 1 test in 0.000s

OK
```
## unittestçš„setUpå’ŒtearDown

æ–¹æ³•setUpå’ŒtearDownï¼Œå®ƒä»¬å°†åˆ†åˆ«åœ¨æ¯ä¸ªæµ‹è¯•æ–¹æ³•ä¹‹å‰å’Œä¹‹åæ‰§è¡Œã€‚å¯ä½¿ç”¨è¿™äº›æ–¹æ³•æ¥æ‰§è¡Œé€‚ç”¨äºæ‰€æœ‰æµ‹è¯•çš„åˆå§‹åŒ–ä»£ç å’Œæ¸…ç†ä»£ç 

## æµ‹è¯•ç±»


```
[huawei@n148 pytest]$ cat survey.py 
#!/usr/bin/python3
class AnonymousSurvey:
        def __init__(self, question):
                self.question = question
                self.responses = []
        def show_question(self):
                print(self.question)
        def store_response(self, new_response):
                self.responses.append(new_response)
        def show_results(self):
                print("Survey results:")
                for response in self.responses:
                        print(f"- {response}")


[huawei@n148 pytest]$ cat test_survey.py 
import unittest
from survey import AnonymousSurvey
class TestAnonymousSurvey(unittest.TestCase):
        def setUp(self):
                question = "What language did you first learn to speak?"
                self.my_survey = AnonymousSurvey(question)
                self.responses = ['English', 'Spanish', 'Mandarin']
        def test_store_single_response(self):
                self.my_survey.store_response(self.responses[0])
                self.assertIn(self.responses[0], self.my_survey.responses)
        def test_store_three_responses(self):
                for response in self.responses:
                        self.my_survey.store_response(response)
                for response in self.responses:
                        self.assertIn(response, self.my_survey.responses)

if __name__ == '__main__':
        unittest.main()


[huawei@n148 pytest]$ python3 test_survey.py 
..
----------------------------------------------------------------------
Ran 2 tests in 0.000s

OK
```
## æµ‹è¯•çš„è¾“å‡º
è¿è¡Œæµ‹è¯•ç”¨ä¾‹æ—¶ï¼Œæ¯å®Œæˆä¸€ä¸ªå•å…ƒæµ‹è¯•ï¼ŒPythonéƒ½æ‰“å°ä¸€ä¸ªå­—ç¬¦
- æµ‹è¯•é€šè¿‡æ—¶æ‰“å°ä¸€ä¸ªå¥ç‚¹
- æµ‹è¯•å¼•å‘é”™è¯¯æ—¶æ‰“å°ä¸€ä¸ªE
- æµ‹è¯•å¯¼è‡´æ–­è¨€å¤±è´¥æ—¶åˆ™æ‰“å°ä¸€ä¸ªF

# ç³»ç»Ÿç›¸å…³

## os

æ“ä½œç³»ç»Ÿç›¸å…³è°ƒç”¨å’Œæ“ä½œ
http://www.ityouknow.com/python/2019/10/09/python-os-demonstration-026.html

- os.name                       è·å–æ“ä½œç³»ç»Ÿå¹³å°
- os.environ                    ä¸€ä¸ª dictionary åŒ…å«ç¯å¢ƒå˜é‡çš„æ˜ å°„å…³ç³»
- print(os.environ)             è¾“å‡ºç¯å¢ƒå˜é‡å€¼
- os.system()                   ç”¨æ¥è¿è¡Œshellå‘½ä»¤
- os.chdir(dir)                 æ”¹å˜å½“å‰ç›®å½• 
- os.chdir(â€˜F:\WprkSpaceâ€™)      æ³¨æ„ç¬¦å·è½¬ä¹‰
- os.getegid()                  å¾—åˆ°æœ‰æ•ˆç»„id
- os.getgid()                   å¾—åˆ°ç»„id
- os.getuid()                   å¾—åˆ°ç”¨æˆ·id
- os.geteuid()                  å¾—åˆ°æœ‰æ•ˆç”¨æˆ·id
- os.setegid os.setegid() os.seteuid() os.setuid()  è®¾ç½®id
- os.getgruops()                å¾—åˆ°ç”¨æˆ·ç»„åç§°åˆ—è¡¨
- os.getlogin()                 å¾—åˆ°ç”¨æˆ·ç™»å½•åç§°
- os.getenv                     å¾—åˆ°ç¯å¢ƒå˜é‡
- os.putenv                     è®¾ç½®ç¯å¢ƒå˜é‡
- os.umask                      è®¾ç½®umask
- os.system(cmd)                åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨ï¼Œè¿è¡Œcmdå‘½ä»¤
- sys.exit()                    ç»ˆæ­¢è„šæœ¬

## sys
http://www.ityouknow.com/python/2019/10/09/python-sys-demonstration-028.html

- sys.argv
- sys.platform
- sys.byteorder
- sys.executable
- sys.modules
- sys.builtin_module_names
- sys.path
- sys.stdin
- sys.stdout
- sys.err
- sys.getrecursionlimit() å’Œ sys.setrecursionlimit()
- sys.getrefcount()
- sys.getsizeof()
- sys.int_info å’Œ sys.float_info



# è¯»å†™æ–‡ä»¶
http://www.ityouknow.com/python/2019/12/19/python-IO-Programming-read&write-files-93.html
## openæ¨¡å¼ä¸ç¼–ç 

open()çš„æ¨¡å¼å¦‚ä¸‹ï¼Œå¦‚æœçœç•¥ï¼ŒPythonå°†ä»¥é»˜è®¤çš„åªè¯»æ¨¡å¼æ‰“å¼€æ–‡ä»¶ã€‚é»˜è®¤æ˜¯UTF-8ç¼–ç æ‰“å¼€
- è¯»å–æ¨¡å¼ ï¼ˆ'r' ï¼‰
- å†™å…¥æ¨¡å¼ ï¼ˆ'w' ï¼‰
- é™„åŠ æ¨¡å¼ ï¼ˆ'a' ï¼‰
- è¯»å†™æ¨¡å¼ ï¼ˆ'r+' ï¼‰
- 'b' äºŒè¿›åˆ¶æ¨¡å¼ï¼ˆä¸å…¶ä»–æ¨¡å¼ç»“åˆä½¿ç”¨ï¼‰
- 't' æ–‡æœ¬æ¨¡å¼ï¼ˆé»˜è®¤å€¼ï¼Œä¸å…¶ä»–æ¨¡å¼ç»“åˆä½¿ç”¨ï¼‰
- è¿˜æœ‰å¾ˆå¤šï¼Œè§çœ‹æ¼«ç”»å­¦python12.1

## ä½¿ç”¨withè‡ªåŠ¨å…³é—­æ–‡ä»¶
Python çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼ˆcontext managerï¼‰ä¼šæ¸…ç†ä¸€äº›èµ„æºï¼Œä¾‹å¦‚æ‰“å¼€çš„æ–‡ä»¶ã€‚ä½¿ç”¨æ–¹å¼è§ä¸‹é¢çš„æ¡ˆä¾‹

## ä¸€æ¬¡è¯»å…¥æ‰€æœ‰
```
#!/usr/bin/python3
with open('pi_digits.txt') as file_object:
	contents = file_object.read()
print(contents.rstrip())
```
## è¯»å–æ‰€æœ‰è¡Œ
```
#!/usr/bin/python3
with open('pi_digits.txt') as file_object:
    lines = file_object.readlines()
for line in lines:
	print(line.rstrip())
```
## è¯»å–æŒ‡å®šå­—èŠ‚
```
with open('pi_digits.txt') as file_object:
	contents = file_object.read(5)
print(contents.rstrip())

[huawei@n148 pytest]$ cat alice.txt | python3 pyth.py
3.141
```
## æ¯æ¬¡è¯»ä¸€ä¸ªå­—ç¬¦æˆ–å­—èŠ‚
è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶å³ä¸ºå­—èŠ‚~
```
with open(filename) as f: 
	while True: 
		char = f.read(1) 
		if not char: break 
		print(char) 
```
ä¹Ÿå¯ä»¥ä¸€æ¬¡è¯»å–ï¼Œéå†å­—ç¬¦
```
with open(filename) as f: 
	for char in f.read(): 
 		process(char) 
```
## æ¯æ¬¡è¯»ä¸€è¡Œ
```
filename = 'username.json';
with open(filename) as f: 
	while True: 
		line = f.readline() 
		if not line: break 
		print(line) 
```
ä¹Ÿå¯ä»¥ä¸€æ¬¡è¯»å–åˆ°å­—ç¬¦ä¸²æ•°ç»„ï¼Œç„¶åè¿­ä»£æ­¤æ•°ç»„
```
with open(filename) as f: 
 	for line in f.readlines(): 
		process(line) 
```

## è¿æ¥æ–‡ä»¶æ‰€æœ‰è¡Œ
ä½¿ç”¨stripå»é™¤æ¯è¡Œçš„ä¸¤ç«¯ç©ºç™½ï¼Œç„¶åç›¸è¿ï¼ŒåŠæ³•æ„Ÿè§‰å¾ˆç¹ç
```
with open('pi_digits.txt') as file_object:
    lines = file_object.readlines()
pi_string = ''
for line in lines:
	pi_string += line.strip()
print(pi_string)
```
## å†™å…¥ä¸è¿½åŠ 
- å‡½æ•° write() è¿”å›å†™å…¥æ–‡ä»¶çš„å­—èŠ‚æ•°
- å…¶å®ä¹Ÿå¯ä»¥ä½¿ç”¨print()ï¼Œè§pythonè¯­è¨€åŠå…¶åº”ç”¨8.1.1
```
#!/usr/bin/python3
filename = 'programming.txt'
with open(filename, 'w') as file_object:
	file_object.write("I love programming.\n")
	file_object.write("I love creating new games.\n")


with open(filename, 'a') as file_object:
	file_object.write("I also love finding meaning in large datasets.\n")
	file_object.write("I love creating apps that can run in a browser.\n")

[huawei@n148 pythontest]$ cat programming.txt 
I love programming.
I love creating new games.
I also love finding meaning in large datasets.
I love creating apps that can run in a browser.
```
## è¯»å–åæ”¹å†å†™å›
```
#!/usr/bin/python3
fname = 'username.json';
f = open(fname) 
lines = f.readlines()
f.close() 
lines[0] = "new test" 
f = open(fname, 'w') 
f.writelines(lines) 
f.close() 
```

## å†™äºŒè¿›åˆ¶æ–‡ä»¶
å¦‚æœæ–‡ä»¶æ¨¡å¼å­—ç¬¦ä¸²ä¸­åŒ…å« 'b'ï¼Œé‚£ä¹ˆæ–‡ä»¶ä¼šä»¥äºŒè¿›åˆ¶æ¨¡å¼æ‰“å¼€ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œè¯»å†™çš„æ˜¯å­—èŠ‚è€Œä¸æ˜¯å­—ç¬¦ä¸²ã€‚


```
ä¸€æ¬¡æ€§å†™å…¥

bdata = bytes(range(0, 256))
fout = open('bfile', 'wb')
fout.write(bdata)
fout.close()
```

```
åˆ†å—å†™å…¥

fout = open('bfile2', 'wb')
size = len(bdata)
offset = 0
chunk = 100
while True:
	if offset > size:
		break
	fout.write(bdata[offset:offset+chunk])
	offset += chunk
fout.close()

```

## è¯»äºŒè¿›åˆ¶æ–‡ä»¶
```
fin = open('bfile', 'rb')
bdata = fin.read()
print(len(bdata))
fin.close()
```

## pathlibæ¨¡å—æä¾›çš„è¯»å†™
- Path.open(mode=â€™râ€™)ï¼Œä»¥ â€œrâ€ æ ¼å¼æ‰“å¼€ Path è·¯å¾„ä¸‹çš„æ–‡ä»¶ï¼Œè‹¥æ–‡ä»¶ä¸å­˜åœ¨å³åˆ›å»ºåæ‰“å¼€ã€‚
- Path.read_bytes()ï¼Œæ‰“å¼€ Path è·¯å¾„ä¸‹çš„æ–‡ä»¶ï¼Œä»¥å­—èŠ‚æµæ ¼å¼è¯»å–æ–‡ä»¶å†…å®¹ï¼Œç­‰åŒ open æ“ä½œæ–‡ä»¶çš„ â€œrbâ€ æ ¼å¼ã€‚
- Path.read_text()ï¼Œæ‰“å¼€ Path è·¯å¾„ä¸‹çš„æ–‡ä»¶ï¼Œä»¥ str æ ¼å¼è¯»å–æ–‡ä»¶å†…å®¹ï¼Œç­‰åŒ open æ“ä½œæ–‡ä»¶çš„ â€œrâ€ æ ¼å¼ã€‚
- Path.write_bytes()ï¼Œå¯¹ Path è·¯å¾„ä¸‹çš„æ–‡ä»¶è¿›è¡Œå†™æ“ä½œï¼Œç­‰åŒ open æ“ä½œæ–‡ä»¶çš„ â€œwbâ€ æ ¼å¼ã€‚
- Path.write_text()ï¼Œå¯¹ Path è·¯å¾„ä¸‹çš„æ–‡ä»¶è¿›è¡Œå†™æ“ä½œï¼Œç­‰åŒ open æ“ä½œæ–‡ä»¶çš„ â€œwâ€ æ ¼å¼ã€‚

è¯»å†™æ–‡æœ¬
```
from pathlib import Path
currentPath = Path.cwd()
mkPath = currentPath / 'python-100.txt'
with mkPath.open('w') as f:  # åˆ›å»ºå¹¶ä»¥ "w" æ ¼å¼æ‰“å¼€ python-100.txt æ–‡ä»¶ã€‚
    f.write('python-100')  # å†™å…¥ python-100 å­—ç¬¦ä¸²ã€‚
f = open(mkPath, 'r')
print("è¯»å–çš„æ–‡ä»¶å†…å®¹ä¸º:%s" % f.read())
f.close()

```

è¯»å†™æ–‡æœ¬ä¸äºŒè¿›åˆ¶æ–‡ä»¶
```
from pathlib import Path
currentPath = Path.cwd()
mkPathText = currentPath / 'python-100-text.txt'
mkPathText.write_text('python-100')
print("è¯»å–çš„æ–‡ä»¶å†…å®¹ä¸º:%s" % mkPathText.read_text())

str2byte = bytes('python-100', encoding = 'utf-8')
mkPathByte = currentPath / 'python-100-byte.txt'
mkPathByte.write_bytes(str2byte)
print("è¯»å–çš„æ–‡ä»¶å†…å®¹ä¸º:%s" % mkPathByte.read_bytes())
```

## seekã€tellã€close
- seek(offset, from_what) æ”¹å˜æ–‡ä»¶å½“å‰çš„ä½ç½®ã€‚offset ç§»åŠ¨è·ç¦»ï¼›from_what èµ·å§‹ä½ç½®ï¼Œ0 è¡¨ç¤ºå¼€å¤´ï¼Œ1 è¡¨ç¤ºå½“å‰ä½ç½®ï¼Œ2 è¡¨ç¤ºç»“å°¾ï¼Œé»˜è®¤å€¼ä¸º 0 ï¼Œå³å¼€å¤´ã€‚
```
>>> f = open('tmp.txt', 'rb+')
>>> f.write(b'0123456789abcdef')
# ç§»åŠ¨åˆ°æ–‡ä»¶çš„ç¬¬ 6 ä¸ªå­—èŠ‚
>>> f.seek(5)
>>> print(f.read())
b'56789abcdef'
```

- tell() è¿”å›æ–‡ä»¶å¯¹è±¡å½“å‰æ‰€å¤„çš„ä½ç½®ï¼Œå®ƒæ˜¯ä»æ–‡ä»¶å¼€å¤´å¼€å§‹ç®—èµ·çš„å­—èŠ‚æ•°ã€‚
```
>>> f = open('tmp.txt', 'r')
>>> f.seek(5)
>>> print(f.tell())
5
```
-  close() å½“å¤„ç†å®Œä¸€ä¸ªæ–‡ä»¶åï¼Œè°ƒç”¨ close() æ¥å…³é—­æ–‡ä»¶å¹¶é‡Šæ”¾ç³»ç»Ÿçš„èµ„æºã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ with å…³é”®å­—å¤„ç†æ–‡ä»¶å¯¹è±¡ï¼Œå®ç°æ–‡ä»¶ç”¨å®Œåè‡ªåŠ¨å…³é—­ã€‚
```
>>> with open('tmp.txt', 'r') as f: 
...     read_data = f.read()
>>> print(f.closed)
True
```

## flush
åˆ·æ–°å†™ç¼“å†²åŒºï¼Œåœ¨æ–‡ä»¶æ²¡æœ‰å…³é—­çš„æƒ…å†µä¸‹å°†æ•°æ®å†™å…¥æ–‡ä»¶ä¸­ã€‚

## json
json æ˜¯ä¸€ä¸ªæ–‡æœ¬åºåˆ—åŒ–æ ¼å¼ï¼Œå¯ä»¥ç›´è§‚é˜…è¯»çš„ï¼ŒJSON èƒ½åŒ…å«ä»¥ä¸‹æ•°æ®ç±»å‹çš„å€¼ï¼šå­—ç¬¦ä¸²ã€æ•´å‹ã€æµ®ç‚¹å‹ã€å¸ƒå°”å‹ã€åˆ—è¡¨ã€å­—å…¸å’Œ NoneTypeã€‚JSON ä¸èƒ½è¡¨ç¤º Python ç‰¹æœ‰çš„å¯¹è±¡ï¼Œå¦‚ File å¯¹è±¡ã€CSV Reader æˆ– Writer å¯¹è±¡ã€Regexå¯¹è±¡æˆ– Selenium WebElement å¯¹è±¡ã€‚

- json.dumps(obj) åºåˆ—åŒ–ï¼Œobj è½¬æ¢ä¸º json æ ¼å¼çš„å­—ç¬¦ä¸²ï¼›
- json.dump(obj, fp) åºåˆ—åŒ–ï¼Œå°† obj è½¬æ¢ä¸º json æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œå°†å­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶ï¼›
- json.loads(str) ååºåˆ—åŒ–ï¼Œå°† json æ ¼å¼çš„å­—ç¬¦ä¸²ååºåˆ—åŒ–ä¸ºä¸€ä¸ª Python å¯¹è±¡ï¼›
- json.load(fp) ååºåˆ—åŒ–ï¼Œä»æ–‡ä»¶ä¸­è¯»å–å« json æ ¼å¼çš„æ•°æ®ï¼Œå°†ä¹‹ååºåˆ—åŒ–ä¸ºä¸€ä¸ª Python å¯¹è±¡ã€‚

æ¼”ç¤ºæ“ä½œï¼Œæ³¨æ„ensure_asciiçš„ä½œç”¨
```
#å­—å…¸è½¬æˆjsonå­—ç¬¦ä¸² åŠ ä¸Šensure_ascii=Falseä»¥åï¼Œå¯ä»¥è¯†åˆ«ä¸­æ–‡ï¼Œ indent=4æ˜¯é—´éš”4ä¸ªç©ºæ ¼æ˜¾ç¤º   
import json
d={'å°æ˜':{'sex':'ç”·1','addr':'ä¸Šæµ·','age':26},'å°çº¢':{ 'sex':'å¥³','addr':'ä¸Šæµ·', 'age':24},}
# å°†å¯¹è±¡è½¬ä¸ºJsonå­—ç¬¦ä¸²
v = json.dumps(d, ensure_ascii=False,indent=4);
print(v)



# ç›´æ¥dumpå¯¹è±¡åˆ°æ–‡ä»¶
with open('users.json','w',encoding='utf-8') as fw: 
    json.dump(d,fw,ensure_ascii=False,indent=4)



# æ‰“å¼€æ–‡ä»¶åè¯»æ–‡ä»¶ï¼Œå†loadsè¯»åˆ°çš„å­—ç¬¦ä¸²åˆ°æ•°æ®ç»“æ„ä¸­ï¼Œæ“ä½œæ¯”è¾ƒç¹çã€‚ã€‚ã€‚
with open('users.json','r',encoding='utf-8') as f: 
#è¯»æ–‡ä»¶
    res=f.read()
    datas = json.loads(res)
    print(datas)


# è¿™é‡Œç›´æ¥openåloadï¼Œè‡ªåŠ¨åˆ°æ•°æ®ç»“æ„ä¸­
with open('users.json','r',encoding='utf-8') as f:
    numbers = json.load(f)
    print(numbers)


[huawei@n161 ccc]$ python3 1.py
{
    "å°æ˜": {
        "sex": "ç”·1",
        "addr": "ä¸Šæµ·",
        "age": 26
    },
    "å°çº¢": {
        "sex": "å¥³",
        "addr": "ä¸Šæµ·",
        "age": 24
    }
}
{'å°æ˜': {'sex': 'ç”·1', 'addr': 'ä¸Šæµ·', 'age': 26}, 'å°çº¢': {'sex': 'å¥³', 'addr': 'ä¸Šæµ·', 'age': 24}}
{'å°æ˜': {'sex': 'ç”·1', 'addr': 'ä¸Šæµ·', 'age': 26}, 'å°çº¢': {'sex': 'å¥³', 'addr': 'ä¸Šæµ·', 'age': 24}}
```
è¯»å†™æ¡ˆä¾‹  
æ²¡æœ‰è®°å½•åˆ™å†™æ–‡ä»¶ï¼Œæœ‰è®°å½•åˆ™è¯»æ–‡ä»¶å¹¶å±•ç¤º
```
#!/usr/bin/python3

import json
def get_stored_username():
	filename = 'username.json'
	try:
		with open(filename) as f:
			username = json.load(f)
	except FileNotFoundError:
		return None
	else:
		return username

def get_new_username():
	username = input("What is your name? ")
	filename = 'username.json'
	with open(filename, 'w') as f:
		json.dump(username, f)
	return username

def greet_user():
	username = get_stored_username()
	if username:
		print(f"Welcome back, {username}!")
	else:
		username = get_new_username()
		print(f"We'll remember you when you come back, {username}!")

greet_user()
```

## Pickle

pickle æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶åºåˆ—åŒ–æ ¼å¼ï¼Œ æ˜¯ Python ä¸“ç”¨çš„ï¼Œ pickle å¯ä»¥è¡¨ç¤ºå¤§é‡çš„ Python æ•°æ®ç±»å‹ã€‚
Pickle æ¨¡å—ä¸ Json æ¨¡å—åŠŸèƒ½ç›¸ä¼¼ï¼Œä¹ŸåŒ…å«å››ä¸ªå‡½æ•°ï¼Œå³ dump()ã€dumps()ã€loads() å’Œ load()ï¼Œå®ƒä»¬çš„ä¸»è¦åŒºåˆ«å¦‚ä¸‹ï¼š
- dumps å’Œ dump çš„åŒºåˆ«åœ¨äºå‰è€…æ˜¯å°†å¯¹è±¡åºåˆ—åŒ–ï¼Œè€Œåè€…æ˜¯å°†å¯¹è±¡åºåˆ—åŒ–å¹¶ä¿å­˜åˆ°æ–‡ä»¶ä¸­ã€‚
- loads å’Œ load çš„åŒºåˆ«åœ¨äºå‰è€…æ˜¯å°†åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ååºåˆ—åŒ–ï¼Œè€Œåè€…æ˜¯å°†åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ä»æ–‡ä»¶è¯»å–å¹¶ååºåˆ—åŒ–ã€‚

```
# dumpsåŠŸèƒ½
import pickle
data = ['A', 'B', 'C','D']  
bindata = pickle.dumps(data)   # dumps()å‡½æ•°å¯ä»¥å°†æ•°æ®é€šè¿‡ç‰¹æ®Šçš„å½¢å¼è½¬æ¢ä¸ºåªæœ‰pythonè¯­è¨€è®¤è¯†çš„å­—ç¬¦ä¸²
print(bindata)

with open('test.bin', 'wb') as f:
    pickle.dump(data, f)    # dump()å‡½æ•°å¯ä»¥å°†æ•°æ®é€šè¿‡ç‰¹æ®Šçš„å½¢å¼è½¬æ¢ä¸ºåªæœ‰pythonè¯­è¨€è®¤è¯†çš„å­—ç¬¦ä¸²ï¼Œå¹¶å†™å…¥æ–‡ä»¶
    print('å†™å…¥æˆåŠŸ')


# loadsåŠŸèƒ½
msg = pickle.loads(bindata) # loads()å‡½æ•°å¯ä»¥å°†pickleæ•°æ®è½¬æ¢ä¸ºpythonçš„æ•°æ®ç»“æ„
print(msg)


# loadåŠŸèƒ½
with open('test.bin', 'rb') as f:
    data = pickle.load(f)   # load()å‡½æ•°å¯ä»¥ä»æ•°æ®æ–‡ä»¶ä¸­è¯»å–æ•°æ®ï¼Œå¹¶è½¬æ¢ä¸ºpythonçš„æ•°æ®ç»“æ„
    print(data)

[huawei@n161 ccc]$ python3 1.py
b'\x80\x03]q\x00(X\x01\x00\x00\x00Aq\x01X\x01\x00\x00\x00Bq\x02X\x01\x00\x00\x00Cq\x03X\x01\x00\x00\x00Dq\x04e.'
å†™å…¥æˆåŠŸ
['A', 'B', 'C', 'D']
['A', 'B', 'C', 'D']

```

## cvs

CSV å…¨ç§° Comma-Separated Valuesï¼Œä¸­æ–‡å«é€—å·åˆ†éš”å€¼æˆ–å­—ç¬¦åˆ†éš”å€¼ï¼Œå®ƒä»¥çº¯æ–‡æœ¬å½¢å¼å­˜å‚¨è¡¨æ ¼æ•°æ®ï¼ˆæ•°å­—å’Œæ–‡æœ¬ï¼‰ï¼Œå…¶æœ¬è´¨å°±æ˜¯ä¸€ä¸ªå­—ç¬¦åºåˆ—ï¼Œå¯ä»¥ç”±ä»»æ„æ•°ç›®çš„è®°å½•ç»„æˆï¼Œè®°å½•ä¹‹é—´ä»¥æŸç§æ¢è¡Œç¬¦åˆ†éš”ï¼Œæ¯æ¡è®°å½•ç”±å­—æ®µç»„æˆï¼Œé€šå¸¸æ‰€æœ‰è®°å½•å…·æœ‰å®Œå…¨ç›¸åŒçš„å­—æ®µåºåˆ—ï¼Œå­—æ®µé—´å¸¸ç”¨é€—å·æˆ–åˆ¶è¡¨ç¬¦è¿›è¡Œåˆ†éš”ã€‚CSV æ–‡ä»¶æ ¼å¼ç®€å•ã€é€šç”¨ï¼Œåœ¨ç°å®ä¸­æœ‰ç€å¹¿æ³›çš„åº”ç”¨ï¼Œå…¶ä¸­ä½¿ç”¨æœ€å¤šçš„æ˜¯åœ¨ç¨‹åºä¹‹é—´è½¬ç§»è¡¨æ ¼æ•°æ®ã€‚

- writer(csvfile, dialect=â€™excelâ€™, **fmtparams)  
è¿”å›ä¸€ä¸ª writer å¯¹è±¡ï¼Œè¯¥å¯¹è±¡è´Ÿè´£å°†ç”¨æˆ·çš„æ•°æ®åœ¨ç»™å®šçš„æ–‡ä»¶ç±»å¯¹è±¡ä¸Šè½¬æ¢ä¸ºå¸¦åˆ†éš”ç¬¦çš„å­—ç¬¦ä¸²ã€‚csvfile å¯ä»¥æ˜¯å…·æœ‰ write() æ–¹æ³•çš„ä»»ä½•å¯¹è±¡ï¼Œå¦‚æœ csvfile æ˜¯æ–‡ä»¶å¯¹è±¡ï¼Œåˆ™ä½¿ç”¨ newline=â€™â€™ æ‰“å¼€ï¼›å¯é€‰å‚æ•° dialect æ˜¯ç”¨äºä¸åŒçš„ CSV å˜ç§çš„ç‰¹å®šå‚æ•°ç»„ï¼›å¯é€‰å…³é”®å­—å‚æ•° fmtparams å¯ä»¥è¦†å†™å½“å‰å˜ç§æ ¼å¼ä¸­çš„å•ä¸ªæ ¼å¼è®¾ç½®

- reader(csvfile, dialect=â€™excelâ€™, **fmtparams)  
è¿”å›ä¸€ä¸ª reader å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å°†é€è¡Œéå† csvfileï¼Œcsvfile å¯ä»¥æ˜¯æ–‡ä»¶å¯¹è±¡å’Œåˆ—è¡¨å¯¹è±¡ï¼Œå¦‚æœæ˜¯æ–‡ä»¶å¯¹è±¡è¦ä½¿ç”¨ newline=â€™â€™ æ‰“å¼€

- delimiter å’Œ lineterminator å…³é”®å­—å¯ç”¨äºæ”¹å˜åˆ†éš”ç¬¦ä¸è¡Œè·çš„å‚æ•°ï¼Œå‚è§â€œpythonç¼–ç¨‹å¿«é€Ÿä¸Šæ‰‹14.1.4â€

```
import csv
with open('test.csv', 'w', newline='') as csvfile:
    writer = csv.writer(csvfile)
    writer.writerow(['id', 'name', 'age'])
    writer.writerow(['1001', 'å¼ ä¸‰', '222'])
    # å†™å…¥å¤šè¡Œ
    data = [('1001', 'å¼ ä¸‰', '21'), ('1002', 'æå››', '31')]
    writer.writerows(data)

with open('test.csv', newline='') as csvfile:
    reader = csv.reader(csvfile, delimiter=' ')
    for row in reader:
        print(', '.join(row))

[huawei@n161 ccc]$ python3 1.py
id,name,age
1001,å¼ ä¸‰,222
1001,å¼ ä¸‰,21
1002,æå››,31
```

## ç”¨ shelve æ¨¡å—ä¿å­˜å˜é‡

åˆ©ç”¨ shelve æ¨¡å—å¯ä»¥å°† Python ç¨‹åºä¸­çš„å˜é‡ä¿å­˜åˆ°äºŒè¿›åˆ¶çš„ shelf æ–‡ä»¶ä¸­ã€‚

- shelf å€¼æœ‰ keys()å’Œ values()æ–¹æ³•ï¼Œè¿”å› shelf ä¸­é”®å’Œå€¼çš„ç±»ä¼¼åˆ—è¡¨çš„å€¼ã€‚å› ä¸ºè¿™äº›æ–¹æ³•è¿”å›ç±»ä¼¼åˆ—è¡¨çš„å€¼ï¼Œè€Œä¸æ˜¯çœŸæ­£çš„åˆ—è¡¨ï¼Œæ‰€ä»¥åº”è¯¥å°†å®ƒä»¬ä¼ é€’ç»™ list()å‡½æ•°ï¼Œå–å¾—åˆ—è¡¨çš„å½¢å¼ã€‚
```
import shelve
shelfFile = shelve.open('mydata')
cats = ['Zophie', 'Pooka', 'Simon']
shelfFile['cats'] = cats
shelfFile.close()

shelfFile = shelve.open('mydata')
print(type(shelfFile))
print(shelfFile['cats'])
print(list(shelfFile.keys()))
print(list(shelfFile.values()))
shelfFile.close()

[huawei@n161 ccc]$ python3 1.py
<class 'shelve.DbfilenameShelf'>
['Zophie', 'Pooka', 'Simon']
['cats']
[['Zophie', 'Pooka', 'Simon']]
```

## ç”¨ pprint.pformat()å‡½æ•°ä¿å­˜å˜é‡

ä¸shelveåŠŸèƒ½ç±»ä¼¼ï¼Œä½†å´æ˜¯æ–‡æœ¬çš„ï¼Œä»¥pyæ ¼å¼å†™æ–‡ä»¶ï¼Œååˆå½“åšæ¨¡å—å¯¼å…¥ä»£ç 

```
import pprint
cats = [{'name': 'Zophie', 'desc': 'chubby'}, {'name': 'Pooka', 'desc': 'fluffy'}]
print(pprint.pformat(cats))
fileObj = open('myCats.py', 'w')
fileObj.write('cats = ' + pprint.pformat(cats) + '\n')
fileObj.close()

import myCats
print(myCats.cats)
print(myCats.cats[0])
print(myCats.cats[0]['name'])

[huawei@n161 ccc]$ python3 1.py
[{'desc': 'chubby', 'name': 'Zophie'}, {'desc': 'fluffy', 'name': 'Pooka'}]
[{'desc': 'chubby', 'name': 'Zophie'}, {'desc': 'fluffy', 'name': 'Pooka'}]
{'desc': 'chubby', 'name': 'Zophie'}
Zophie
```

# ç»„ç»‡æ–‡ä»¶

## è·å–å½“å‰ç›®å½•ï¼Œå®¶ç›®å½•

- os.getcwd() è·å–ç°åœ¨çš„å·¥ä½œç›®å½•
- Path.cwd() è¿”å›æ–‡ä»¶å½“å‰æ‰€åœ¨ç›®å½•ã€‚
- Path.home() è¿”å›ç”¨æˆ·çš„ä¸»ç›®å½•ã€‚

```
from pathlib import Path
currentPath = Path.cwd()
homePath = Path.home()
print("æ–‡ä»¶å½“å‰æ‰€åœ¨ç›®å½•:%s\nç”¨æˆ·ä¸»ç›®å½•:%s" %(currentPath, homePath))

[huawei@n161 ccc]$ python3 1.py
æ–‡ä»¶å½“å‰æ‰€åœ¨ç›®å½•:/home/huawei/hwwork/doc/md/ccc
ç”¨æˆ·ä¸»ç›®å½•:/home/huawei
```

## æ”¹å˜å½“å‰ç›®å½•

os.chdir('../aaa')

## ç›®å½•æ‹¼æ¥

æ–œæ  / æ“ä½œç¬¦ç”¨äºæ‹¼æ¥è·¯å¾„ï¼Œæ¯”å¦‚åˆ›å»ºå­è·¯å¾„ã€‚

```
from pathlib import Path
currentPath = Path.cwd()
newPath = currentPath / 'python-100'
print("æ–°ç›®å½•ä¸º:%s" %(newPath))

[huawei@n161 ccc]$ python3 1.py
æ–°ç›®å½•ä¸º:/home/huawei/hwwork/doc/md/ccc/python-100
```
## åˆ›å»ºç›®å½•ã€åˆ é™¤ç›®å½•

- åˆ›å»ºå¤šå±‚ï¼šos.makedirs('../eee/fff/ggg')
- åˆ›å»ºå•å±‚ï¼šos.mkdir('poems')

ä¹Ÿå¯ä»¥ä½¿ç”¨å¦ä¸€ç§æ–¹å¼ï¼š

- Path.mkdir()ï¼Œåˆ›å»ºç»™å®šè·¯å¾„çš„ç›®å½•ã€‚
- Path.rmdir()ï¼Œåˆ é™¤è¯¥ç›®å½•ï¼Œç›®å½•æ–‡ä»¶å¤¹å¿…é¡»ä¸ºç©ºã€‚

```
from pathlib import Path
currentPath = Path.cwd()
makePath = currentPath / 'python-100'
makePath.mkdir()
print("åˆ›å»ºçš„ç›®å½•ä¸º:%s" %(makePath))
```

```
from pathlib import Path
currentPath = Path.cwd()
delPath = currentPath / 'python-100'
delPath.rmdir()
print("åˆ é™¤çš„ç›®å½•ä¸º:%s" %(delPath))
```

## ç›¸å¯¹è·¯å¾„ã€ç»å¯¹è·¯å¾„ã€ä¸¤ç‚¹é—´è·¯å¾„

- os.path.abspath(path)  å°†è¿”å›å‚æ•°çš„ç»å¯¹è·¯å¾„çš„å­—ç¬¦ä¸²ã€‚è¿™æ˜¯å°†ç›¸å¯¹è·¯å¾„è½¬æ¢ä¸ºç»å¯¹è·¯å¾„çš„ç®€ä¾¿æ–¹æ³•ã€‚
- os.path.isabs(path)  å¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªç»å¯¹è·¯å¾„ï¼Œå°±è¿”å› Trueï¼Œå¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼Œå°±è¿”å› Falseã€‚
- os.path.relpath(path, start)  å°†è¿”å›ä» start è·¯å¾„åˆ° path çš„ç›¸å¯¹è·¯å¾„çš„å­—ç¬¦ä¸²ã€‚å¦‚æœæ²¡æœ‰æä¾› startï¼Œå°±ä½¿ç”¨å½“å‰å·¥ä½œç›®å½•ä½œä¸ºå¼€å§‹è·¯å¾„ã€‚


```
import os
print(os.path.abspath('.'))
print(os.path.abspath('Scripts'))
print(os.path.isabs('.'))
print(os.path.isabs(os.path.abspath('.')))
print(os.path.relpath('/home/Download', './'))



[huawei@n161 ccc]$ python3 1.py
/home/huawei/hwwork/postdb_doc/mdbooks/ccc
/home/huawei/hwwork/postdb_doc/mdbooks/ccc/Scripts
False
True
../../../../../Download
```

## åˆ†è§£è·¯å¾„

- os.path.dirname(path) å°†è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒåŒ…å« path å‚æ•°ä¸­æœ€åä¸€ä¸ªæ–œæ ä¹‹å‰çš„æ‰€æœ‰å†…å®¹
- os.path.basename(path) å°†è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒåŒ…å« path å‚æ•°ä¸­æœ€åä¸€ä¸ªæ–œæ ä¹‹åçš„æ‰€æœ‰å†…å®¹
- os.path.split() è¿”å›dirnameä¸basenameçš„ç»“æœ
- os.path.splitext() åˆ†å‰²å‡ºæ‰©å±•åï¼Œä½†è¿˜æœ‰ä¸ªç‚¹ã€‚ã€‚ã€‚
- åˆ†è§£æ¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œæ³¨æ„linuxå¹³å°è¿”å›åˆ—è¡¨ç¬¬ä¸€ä¸ªæ˜¯ç©ºå­—ç¬¦ä¸²
```
import os
file = '/home/huawei/hwwork/postdb_doc/mdbooks/ccc/example.log'
print(os.path.basename(file))
print(os.path.dirname(file))
print(os.path.split(file))
print(os.path.splitext(file))
print(file.split(os.path.sep))



[huawei@n161 ccc]$ python3 1.py
example.log
/home/huawei/hwwork/postdb_doc/mdbooks/ccc
('/home/huawei/hwwork/postdb_doc/mdbooks/ccc', 'example.log')
('/home/huawei/hwwork/postdb_doc/mdbooks/ccc/example', '.log')
['', 'home', 'huawei', 'hwwork', 'postdb_doc', 'mdbooks', 'ccc', 'example.log']
```

å¦ä¸€å¥—æ–¹æ¡ˆ
- Path.resolve()ï¼Œé€šè¿‡ä¼ å…¥æ–‡ä»¶åï¼Œè¿”å›æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ã€‚
- Path.nameï¼Œå¯ä»¥è·å–æ–‡ä»¶çš„åå­—ï¼ŒåŒ…å«åç¼€åã€‚
- Path.parentï¼Œè¿”å›æ–‡ä»¶æ‰€åœ¨æ–‡ä»¶å¤¹çš„åå­—ã€‚
- Path.stemï¼Œè·å–æ–‡ä»¶åä¸åŒ…å«åç¼€åã€‚
- Path.suffixï¼Œè·å–æ–‡ä»¶çš„åç¼€åã€‚
- Path.anchorï¼Œè·å–æ–‡ä»¶æ‰€åœ¨çš„ç›˜ç¬¦ã€‚

```
from pathlib import Path
txtPath = Path('python-100.txt')
nowPath = txtPath.resolve()
print("æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ä¸º:%s" % nowPath)
print("æ–‡ä»¶å®Œæ•´åç§°ä¸º(æ–‡ä»¶å+åç¼€å):%s" % nowPath.name)
print("æ–‡ä»¶åä¸º:%s" % nowPath.stem)
print("æ–‡ä»¶åç¼€åä¸º:%s" % nowPath.suffix)
print("æ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹åä¸º:%s" % nowPath.parent)
print("æ–‡ä»¶æ‰€åœ¨çš„ç›˜ç¬¦ä¸º:%s" % nowPath.anchor)

[huawei@n161 ccc]$ python3 1.py
æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ä¸º:/home/huawei/hwwork/doc/md/ccc/python-100.txt
æ–‡ä»¶å®Œæ•´åç§°ä¸º(æ–‡ä»¶å+åç¼€å):python-100.txt
æ–‡ä»¶åä¸º:python-100
æ–‡ä»¶åç¼€åä¸º:.txt
æ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹åä¸º:/home/huawei/hwwork/doc/md/ccc
æ–‡ä»¶æ‰€åœ¨çš„ç›˜ç¬¦ä¸º:/
```

## æ–‡ä»¶sizeã€æ–‡ä»¶å¤¹size

è°ƒç”¨ os.path.getsize(path)å°†è¿”å› path å‚æ•°ä¸­æ–‡ä»¶çš„å­—èŠ‚æ•°ï¼Œæ¡ˆä¾‹åœ¨[éé€’å½’ä¾¿éæ–‡ä»¶å¤¹](#éé€’å½’ä¾¿éæ–‡ä»¶å¤¹)


## æ–‡ä»¶ã€è·¯å¾„æ˜¯å¦å­˜åœ¨

osæ¨¡å—çš„æ–¹æ¡ˆï¼š

```
import os
mypath = '/home/huawei/hwwork/postdb_doc/mdbooks/ccc'
print(os.path.exists(mypath))
print(os.path.isfile(mypath))
print(os.path.isdir(mypath))


[huawei@n161 ccc]$ python3 1.py
True
False
True
```

æ£€æµ‹å¯ä»¥è¯»accessçš„æµ‹è¯•

```
import os 
import sys 

def main (): 
    sys.argv.append ("") 
    filename = sys.argv[1] 
    if not os.path.isfile(filename):
        raise SystemExit(filename + 'does not exsts')
    elif not os.access(filename, os.R_OK):
        raise SystemExit(filename + 'is not accessible')
    else : 
        print('filename s accessible')

if __name__ == "__main__":
    main()
```

Pathæ¨¡å—çš„æ–¹æ¡ˆï¼š

- Path.exists()ï¼Œåˆ¤æ–­ Path è·¯å¾„æ˜¯å¦æŒ‡å‘ä¸€ä¸ªå·²å­˜åœ¨çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œè¿”å› True æˆ– Falseã€‚
- Path.is_dir()ï¼Œåˆ¤æ–­ Path æ˜¯å¦æ˜¯ä¸€ä¸ªè·¯å¾„ï¼Œè¿”å› True æˆ– Falseã€‚
- Path.is_file()ï¼Œåˆ¤æ–­ Path æ˜¯å¦æŒ‡å‘ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿”å› True æˆ– Falseã€‚

```
from pathlib import Path
currentPath = Path.cwd() / 'python'

print(currentPath.exists())  # åˆ¤æ–­æ˜¯å¦å­˜åœ¨ python æ–‡ä»¶å¤¹ï¼Œæ­¤æ—¶è¿”å› Falseã€‚
print(currentPath.is_dir())  # åˆ¤æ–­æ˜¯å¦å­˜åœ¨ python æ–‡ä»¶å¤¹ï¼Œæ­¤æ—¶è¿”å› Falseã€‚

currentPath.mkdir()  # åˆ›å»º python æ–‡ä»¶å¤¹ã€‚

print(currentPath.exists())  # åˆ¤æ–­æ˜¯å¦å­˜åœ¨ python æ–‡ä»¶å¤¹ï¼Œæ­¤æ—¶è¿”å› Trueã€‚
print(currentPath.is_dir())  # åˆ¤æ–­æ˜¯å¦å­˜åœ¨ python æ–‡ä»¶å¤¹ï¼Œæ­¤æ—¶è¿”å› Trueã€‚

currentPath = Path.cwd() / 'python-100.txt'

print(currentPath.exists())  # åˆ¤æ–­æ˜¯å¦å­˜åœ¨ python-100.txt æ–‡ä»¶ï¼Œæ­¤æ—¶æ–‡ä»¶æœªåˆ›å»ºè¿”å› Falseã€‚
print(currentPath.is_file())  # åˆ¤æ–­æ˜¯å¦å­˜åœ¨ python-100.txt æ–‡ä»¶ï¼Œæ­¤æ—¶æ–‡ä»¶æœªåˆ›å»ºè¿”å› Falseã€‚

f = open(currentPath,'w')  # åˆ›å»º python-100.txt æ–‡ä»¶ã€‚
f.close()

print(currentPath.exists())  # åˆ¤æ–­æ˜¯å¦å­˜åœ¨ python-100.txt æ–‡ä»¶ï¼Œæ­¤æ—¶è¿”å› Trueã€‚
print(currentPath.is_file())  # åˆ¤æ–­æ˜¯å¦å­˜åœ¨ python-100.txt æ–‡ä»¶ï¼Œæ­¤æ—¶è¿”å› Trueã€‚

```


## éé€’å½’éå†æ–‡ä»¶å¤¹ï¼Œglobï¼Œè¿æ¥æ–‡ä»¶å

- os.listdir(path) è·å–æŒ‡å®šä½ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åå’Œå­æ–‡ä»¶å¤¹åç§°ï¼Œéé€’å½’
- os.path.join(path,name)       è¿æ¥ç›®å½•ä¸æ–‡ä»¶åæˆ–ç›®å½•

è®¡ç®—æ¯ä¸ªæ–‡ä»¶å ç”¨çš„sizeï¼Œå¤§å°åŒlinuxçš„lså‘½ä»¤ç»“æœä¸€è‡´
```
import os
mypath = '/home/huawei/hwwork/postdb_doc/mdbooks/ccc'
totalSize = 0
for filename in os.listdir(mypath):
    size = os.path.getsize(os.path.join(mypath, filename))
    print(filename, size)
    totalSize = totalSize + size
print(totalSize)

[huawei@n161 ccc]$ python3 1.py
1.pl 496
1.json 945
1.py 249
tex.md 3873
tex.pdf 308647
tex.tex 10292
myprocess.py 1260
__pycache__ 38
example.log 102
logging.conf 447
config_logging.py 586
users.json 181
test.txt 40
test.bin 40
python 6
python-100.txt 0
test.csv 62
filename.csv 73
327337
```

å¦ä¸€ç§æ–¹æ¡ˆï¼š

- Path.iterdir()ï¼Œè¿”å› Path ç›®å½•æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨ç±»å‹ã€‚
- Path.glob(pattern)ï¼Œè¿”å› Path ç›®å½•æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰ä¸ pattern åŒ¹é…çš„æ–‡ä»¶ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨ç±»å‹ã€‚
- Path.rglob(pattern)ï¼Œè¿”å› Path è·¯å¾„ä¸‹æ‰€æœ‰å­æ–‡ä»¶å¤¹ä¸­ä¸ pattern åŒ¹é…çš„æ–‡ä»¶ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨ç±»å‹ã€‚



```
# ä½¿ç”¨ Path.iterdir() è·å–å½“å‰æ–‡ä»¶ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œå¹¶æ ¹æ®åç¼€åç»Ÿè®¡å…¶ä¸ªæ•°ã€‚
import pathlib
from collections import Counter
currentPath = pathlib.Path.cwd()
print(currentPath)
gen = (i.suffix for i in currentPath.iterdir())
print(Counter(gen))

[huawei@n161 ccc]$ python3 1.py
/home/huawei/hwwork/postdb_doc/mdbooks/ccc
Counter({'.py': 3, '.json': 2, '': 2, '.txt': 2, '.pl': 1, '.md': 1, '.pdf': 1, '.tex': 1, '.log': 1, '.conf': 1, '.bin': 1})
```


```
import pathlib
from collections import Counter
currentPath = pathlib.Path.cwd() / '..'
gen = (i.suffix for i in currentPath.glob('*.txt'))  # è·å–å½“å‰æ–‡ä»¶ä¸‹çš„æ‰€æœ‰ txt æ–‡ä»¶ï¼Œå¹¶ç»Ÿè®¡å…¶ä¸ªæ•°ã€‚
print(Counter(gen))
gen = (i.suffix for i in currentPath.rglob('*.md'))  # è·å–ç›®å½•ä¸­å­æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰ md æ–‡ä»¶ï¼Œå¹¶ç»Ÿè®¡å…¶ä¸ªæ•°ã€‚
print(Counter(gen))

[huawei@n161 ccc]$ python3 1.py
Counter({'.txt': 1})
Counter({'.md': 1874})
```

## å¤åˆ¶æ–‡ä»¶å’Œcopytree

- shutil.copy(source, destination) å°†è·¯å¾„ source å¤„çš„æ–‡ä»¶å¤åˆ¶åˆ°è·¯å¾„ destinationå¤„çš„æ–‡ä»¶å¤¹ï¼ˆsource å’Œ destination éƒ½æ˜¯å­—ç¬¦ä¸²ï¼‰ã€‚å¦‚æœ destination æ˜¯ä¸€ä¸ªæ–‡ä»¶åï¼Œå®ƒå°†ä½œä¸ºè¢«å¤åˆ¶æ–‡ä»¶çš„æ–°åå­—ã€‚è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¢«å¤åˆ¶æ–‡ä»¶çš„è·¯å¾„ã€‚è¿”å›å€¼æ˜¯åˆšåˆšè¢«å¤åˆ¶çš„æ–‡ä»¶çš„è·¯å¾„ã€‚
- shutil.copytree()å°†å¤åˆ¶æ•´ä¸ªæ–‡ä»¶å¤¹ï¼Œä»¥åŠå®ƒåŒ…å«çš„æ–‡ä»¶å¤¹å’Œæ–‡ä»¶ã€‚è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ˜¯æ–°å¤åˆ¶çš„æ–‡ä»¶å¤¹çš„è·¯å¾„

```
import shutil, os
shutil.copy('test.csv', '../test2.csv')
shutil.copytree('../bbb', '../hhh/eee')

```
## æ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„ç§»åŠ¨ä¸æ”¹å

- shutil.move(source, destination)ï¼Œå°†è·¯å¾„ source å¤„çš„æ–‡ä»¶å¤¹ç§»åŠ¨åˆ°è·¯å¾„destinationï¼Œå¹¶è¿”å›æ–°ä½ç½®çš„ç»å¯¹è·¯å¾„çš„å­—ç¬¦ä¸²ã€‚ç¡®ä¿æ–‡ä»¶ä¸ç›®æ ‡è·¯å¾„éƒ½å­˜åœ¨å¦åˆ™å¼‚å¸¸
- os.rename('bfile', 'ohwell.txt')	æŠŠæ–‡ä»¶é‡å‘½åä¸ºohno.txt
```
import shutil, os
shutil.move('test.csv', '../test2.csv')
shutil.move('../aaa', '../aaa2')
```

## åˆ é™¤æ–‡ä»¶å’Œæ–‡ä»¶å¤¹
- os.unlink(path) åˆ é™¤ path å¤„çš„æ–‡ä»¶ã€‚
- os.rmdir(path) åˆ é™¤ path å¤„çš„æ–‡ä»¶å¤¹ã€‚è¯¥æ–‡ä»¶å¤¹å¿…é¡»ä¸ºç©ºï¼Œå…¶ä¸­æ²¡æœ‰ä»»ä½•æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ã€‚
- shutil.rmtree(path) åˆ é™¤ path å¤„çš„æ–‡ä»¶å¤¹ï¼Œå®ƒåŒ…å«çš„æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹éƒ½ä¼šè¢«åˆ é™¤ã€‚
- os.remove() åˆ é™¤æŸä¸ªæ–‡ä»¶

åˆ é™¤å½“å‰æ–‡ä»¶å¤¹å†…çš„æŒ‡å®šç±»å‹æ–‡ä»¶
```
import os
for filename in os.listdir():
    if filename.endswith('.txt'):
        os.unlink(filename)
```

## ç”¨ send2trash æ¨¡å—å®‰å…¨åœ°åˆ é™¤ 

pip install send2trash

è¯¦è§â€œpythonç¼–ç¨‹å¿«é€Ÿä¸Šæ‰‹9.1.4â€

```
import send2trash
baconFile = open('bacon.txt', 'a') # creates the file
baconFile.write('Bacon is not a vegetable.')

baconFile.close()
send2trash.send2trash('bacon.txt')

```

## éå†ç›®å½•æ ‘

os.walk()åœ¨å¾ªç¯çš„æ¯æ¬¡è¿­ä»£ä¸­ï¼Œè¿”å› 3 ä¸ªå€¼ï¼š
- å½“å‰æ–‡ä»¶å¤¹åç§°çš„å­—ç¬¦ä¸²ã€‚
- å½“å‰æ–‡ä»¶å¤¹ä¸­å­æ–‡ä»¶å¤¹çš„å­—ç¬¦ä¸²çš„åˆ—è¡¨ã€‚
- å½“å‰æ–‡ä»¶å¤¹ä¸­æ–‡ä»¶çš„å­—ç¬¦ä¸²çš„åˆ—è¡¨ã€‚
- æ‰€è°“å½“å‰æ–‡ä»¶å¤¹ï¼Œæ˜¯æŒ‡ for å¾ªç¯å½“å‰è¿­ä»£çš„æ–‡ä»¶å¤¹ã€‚ç¨‹åºçš„å½“å‰å·¥ä½œç›®å½•ï¼Œä¸ä¼šå› ä¸º os.walk()è€Œæ”¹å˜ã€‚


```
import os
for folderName, subfolders, filenames in os.walk('/home/huawei/hwwork/postdb_doc/mdbooks/98_testbook'):
    print('The current folder is ' + folderName)
    for subfolder in subfolders:
        print('SUBFOLDER OF ' + folderName + ': ' + subfolder)
    for filename in filenames:
        print('FILE INSIDE ' + folderName + ': '+ filename)
    print('')


[huawei@n161 ccc]$ python3 1.py
The current folder is /home/huawei/hwwork/postdb_doc/mdbooks/98_testbook
SUBFOLDER OF /home/huawei/hwwork/postdb_doc/mdbooks/98_testbook: 1
FILE INSIDE /home/huawei/hwwork/postdb_doc/mdbooks/98_testbook: å‰è¨€.md
FILE INSIDE /home/huawei/hwwork/postdb_doc/mdbooks/98_testbook: menu.md

The current folder is /home/huawei/hwwork/postdb_doc/mdbooks/98_testbook/1
SUBFOLDER OF /home/huawei/hwwork/postdb_doc/mdbooks/98_testbook/1: 2
FILE INSIDE /home/huawei/hwwork/postdb_doc/mdbooks/98_testbook/1: å­˜å‚¨è®¡ç®—åˆ†ç¦».md

The current folder is /home/huawei/hwwork/postdb_doc/mdbooks/98_testbook/1/2
SUBFOLDER OF /home/huawei/hwwork/postdb_doc/mdbooks/98_testbook/1/2: 3
SUBFOLDER OF /home/huawei/hwwork/postdb_doc/mdbooks/98_testbook/1/2: 4
FILE INSIDE /home/huawei/hwwork/postdb_doc/mdbooks/98_testbook/1/2: å¤šæ•°æ´¾åè®®.md
FILE INSIDE /home/huawei/hwwork/postdb_doc/mdbooks/98_testbook/1/2: å·¥ä½œæ¨¡å¼.md
FILE INSIDE /home/huawei/hwwork/postdb_doc/mdbooks/98_testbook/1/2: æ•´ä½“æ¶æ„.md

The current folder is /home/huawei/hwwork/postdb_doc/mdbooks/98_testbook/1/2/3
FILE INSIDE /home/huawei/hwwork/postdb_doc/mdbooks/98_testbook/1/2/3: æ ¸å¿ƒæœºåˆ¶.md
FILE INSIDE /home/huawei/hwwork/postdb_doc/mdbooks/98_testbook/1/2/3: ç½‘ç»œè¿æ¥å’Œç›‘å¬.md

The current folder is /home/huawei/hwwork/postdb_doc/mdbooks/98_testbook/1/2/4
FILE INSIDE /home/huawei/hwwork/postdb_doc/mdbooks/98_testbook/1/2/4: å¤šåç¨‹æ¨¡å‹.md
FILE INSIDE /home/huawei/hwwork/postdb_doc/mdbooks/98_testbook/1/2/4: ç»“ç‚¹ç®¡ç†.md
```


## é“¾æ¥æ“ä½œ

```
import os
os.link('ohno.txt', 'yikes.txt')	# æŠŠå·²æœ‰æ–‡ä»¶ç¡¬é“¾æ¥åˆ°ä¸€ä¸ªæ–°æ–‡ä»¶yikes.txt
os.symlink('ohno.txt', 'jeepers.txt')	# symlink()åˆ›å»ºä¸€ä¸ªç¬¦å·é“¾æ¥
os.path.islink('jeepers.txt')	# islink() å‡½æ•°ä¼šæ£€æŸ¥å‚æ•°æ˜¯æ–‡ä»¶è¿˜æ˜¯ç¬¦å·é“¾æ¥
```

## shutilå…¶ä½™æ–¹æ³•
http://www.ityouknow.com/python/2019/10/09/python-shutil-027.html

æ˜¯é«˜çº§çš„æ–‡ä»¶ï¼Œæ–‡ä»¶å¤¹ï¼Œå‹ç¼©åŒ…å¤„ç†æ¨¡å—ã€‚shutil å¯ä»¥çœ‹ä½œ sh + utilï¼Œå³ shell å·¥å…·ä¹‹æ„ï¼Œè¯¥æ¨¡å—æä¾›äº†ä¸€äº›é’ˆå¯¹æ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„é«˜çº§æ“ä½œï¼Œå¦‚ï¼šæ‹·è´ã€åˆ é™¤ã€ç§»åŠ¨ç­‰ï¼Œshutil æ¨¡å—æ˜¯å¯¹ os æ¨¡å—çš„è¡¥å……ã€‚å¸¸ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š
```
# å°†æ–‡ä»¶å†…å®¹æ‹·è´åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ä¸­
shutil.copyfileobj(fsrc, fdst[, length])

# æ‹·è´æ–‡ä»¶
shutil.copyfile(src, dst, *, follow_symlinks=True)

# ä»…æ‹·è´æƒé™ã€‚å†…å®¹ã€ç»„ã€ç”¨æˆ·å‡ä¸å˜
shutil.copymode(src, dst)

# ä»…æ‹·è´çŠ¶æ€ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼šmode bits, atime, mtime, flags
shutil.copystat(src, dst)


# æ‹·è´æ–‡ä»¶å’ŒçŠ¶æ€ä¿¡æ¯
shutil.copy2(src, dst)

# é€’å½’çš„å»æ‹·è´æ–‡ä»¶å¤¹
shutil.ignore_patterns(*patterns)


# åˆ›å»ºå‹ç¼©åŒ…å¹¶è¿”å›æ–‡ä»¶è·¯å¾„ï¼Œä¾‹å¦‚ï¼šzipã€tar
shutil.make_archive(base_name, format,...)
```



## å½’æ¡£æ“ä½œ
å„ç±»å¯¹archiveçš„æ“ä½œæ–¹æ³•

http://www.ityouknow.com/python/2019/10/09/python-shutil-027.html


# æ—¥æœŸä¸æ—¶é—´


## Pythonæ—¥æœŸæ—¶é—´æ±‡æ€»

åœ¨ Python ä¸­ï¼Œæ—¥æœŸå’Œæ—¶é—´å¯èƒ½æ¶‰åŠå¥½å‡ ç§ä¸åŒçš„æ•°æ®ç±»å‹å’Œå‡½æ•°ã€‚

è¡¨ç¤ºæ—¶é—´çš„ 3 ç§ä¸åŒç±»å‹çš„å€¼ï¼š
- Unix çºªå…ƒæ—¶é—´æˆ³ï¼ˆtime æ¨¡å—ä¸­ä½¿ç”¨ï¼‰æ˜¯ä¸€ä¸ªæµ®ç‚¹å€¼æˆ–æ•´å‹å€¼ï¼Œè¡¨ç¤ºè‡ª 1970 å¹´1 æœˆ 1 æ—¥åˆå¤œ 0 ç‚¹ï¼ˆUTCï¼‰ä»¥æ¥çš„ç§’æ•°ã€‚
- datetime å¯¹è±¡ï¼ˆå±äº datetime æ¨¡å—ï¼‰åŒ…å«ä¸€äº›æ•´å‹å€¼ï¼Œä¿å­˜åœ¨ yearã€monthã€dayã€hourã€minute å’Œ second ç­‰å±æ€§ä¸­ã€‚
- timedelta å¯¹è±¡ï¼ˆå±äº datetime æ¨¡å—ï¼‰è¡¨ç¤ºçš„ä¸€æ®µæ—¶é—´ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç‰¹å®šçš„æ—¶åˆ»ã€‚

æ—¶é—´å‡½æ•°åŠå…¶å‚æ•°å’Œè¿”å›å€¼ï¼š
- time.time()å‡½æ•°è¿”å›ä¸€ä¸ªæµ®ç‚¹å€¼ï¼Œè¡¨ç¤ºå½“å‰æ—¶åˆ»çš„ Unix çºªå…ƒæ—¶é—´æˆ³ã€‚
- time.sleep(seconds)å‡½æ•°è®©ç¨‹åºæš‚åœ seconds å‚æ•°æŒ‡å®šçš„ç§’æ•°ã€‚
- datetime.datetime(year, month, day, hour, minute, second)å‡½æ•°è¿”å›å‚æ•°æŒ‡å®šçš„æ—¶åˆ»çš„ datetime å¯¹è±¡ã€‚å¦‚æœæ²¡æœ‰æä¾› hourã€minute æˆ– second å‚æ•°ï¼Œå®ƒä»¬é»˜è®¤ä¸º 0ã€‚
- datetime.datetime.now()å‡½æ•°è¿”å›å½“å‰æ—¶åˆ»çš„ datetime å¯¹è±¡ã€‚
- datetime.datetime.fromtimestamp(epoch)å‡½æ•°è¿”å› epoch æ—¶é—´æˆ³å‚æ•°è¡¨ç¤ºçš„æ—¶åˆ»çš„ datetime å¯¹è±¡ã€‚
- datetime.timedelta(weeks, days, hours, minutes, seconds, milliseconds, microseconds)å‡½æ•°è¿”å›ä¸€ä¸ªè¡¨ç¤ºä¸€æ®µæ—¶é—´çš„ timedelta å¯¹è±¡ã€‚è¯¥å‡½æ•°çš„å…³é”®å­—å‚æ•°éƒ½æ˜¯å¯é€‰çš„ï¼Œä¸åŒ…æ‹¬ month æˆ– yearã€‚
- total_seconds()æ–¹æ³•ç”¨äº timedelta å¯¹è±¡ï¼Œè¿”å› timedelta å¯¹è±¡è¡¨ç¤ºçš„ç§’æ•°ã€‚
- strftime(format)æ–¹æ³•è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨ format å­—ç¬¦ä¸²ä¸­çš„å®šåˆ¶æ ¼å¼æ¥è¡¨ç¤ºdatetime å¯¹è±¡è¡¨ç¤ºçš„æ—¶é—´ã€‚
- datetime.datetime.strptime(time_string, format)å‡½æ•°è¿”å›ä¸€ä¸ª datetime å¯¹è±¡ï¼Œå®ƒçš„æ—¶åˆ»ç”± time_string æŒ‡å®šï¼Œåˆ©ç”¨ format å­—ç¬¦ä¸²å‚æ•°æ¥è§£æã€‚



## datetimeæ¨¡å—

time æ¨¡å—ç”¨äºå–å¾— Unix çºªå…ƒæ—¶é—´æˆ³ï¼Œå¹¶åŠ ä»¥å¤„ç†ã€‚ä½†æ˜¯ï¼Œå¦‚æœä»¥æ›´æ–¹ä¾¿çš„æ ¼å¼æ˜¾ç¤ºæ—¥æœŸï¼Œæˆ–å¯¹æ—¥æœŸè¿›è¡Œç®—æœ¯è¿ç®—ï¼ˆä¾‹å¦‚ï¼Œææ¸…æ¥š 205 å¤©å‰æ˜¯ä»€ä¹ˆæ—¥æœŸï¼Œæˆ– 123å¤©åæ˜¯ä»€ä¹ˆæ—¥æœŸï¼‰ï¼Œå°±åº”è¯¥ä½¿ç”¨ datetime æ¨¡å—ã€‚

datetimeæ˜¯ Python å†…ç½®çš„åŠŸèƒ½æ¨¡å—ï¼Œå®ƒå¯ä»¥å®ç°å¯¹æ—¥æœŸçš„ç®—æ•°è¿ç®—ï¼Œä»¥æŒ‡å®šçš„æ–¹å¼æ ¼å¼åŒ–æ—¥æœŸã€‚datetime æ¨¡å—å†…å«æœ‰ä¸€ä¸ªåŒåçš„ datetime ç±»ï¼Œè¯¥ç±»ä¸­åŒ…å«å¤šä¸ªæ“ä½œæ—¥æœŸçš„å‡½æ•°ï¼Œä¾‹å¦‚ï¼šdatetime.now()ã€datetime.fromtimestamp()ã€datetime.timedelta()ç­‰

- datetime ç±»æä¾›äº†ä¸€ä¸ªnow()çš„æ–¹æ³•å¯ä»¥è·å–å½“å‰æ—¥æœŸå’Œæ—¶é—´ï¼Œè¿˜æä¾›äº†å¸¦å‚æ•°çš„æ„é€ å‡½æ•°datetime()ï¼Œå¯ä»¥é€šè¿‡ä¼ å…¥ç‰¹å®šçš„æ•°å­—è¿”å›ä¸åŒçš„datetime å¯¹è±¡
```
import datetime
#å½“å‰æ—¥æœŸå’Œæ—¶é—´
print(datetime.datetime.now())
2019-09-30 22:19:37.582514

#è·å–æŒ‡å®šæ—¶é—´
datetest = datetime.datetime(2019,9,30,22,22,0)
print(datetest)
2019-09-30 22:22:00

#è·å–æ—¥æœŸçš„å¹´æœˆæ—¥æ—¶åˆ†ç§’
print(str(datetest.year)+"-"+str(datetest.month)+"-"+str(datetest.day)+" "+str(datetest.hour)+":"+str(datetest.minute)+":"+str(datetest.second))
2019-9-30 22:22:0
```
- fromtimestamp()å‡½æ•°å¯ä»¥å°†æ—¶é—´æˆ³è½¬æ¢æˆ datetime å¯¹è±¡
```
import datetime
dt1 = datetime.datetime.fromtimestamp(10000)
dt2 = datetime.datetime.fromtimestamp(time.time())

print(dt1)
print(dt2)

1970-01-01 10:46:40
2019-09-30 23:28:47.629210
```
- strptime()å’Œstrftime()å‡½æ•°ï¼Œä½¿ç”¨strptime()å‡½æ•°å¯ä»¥å°†æ—¥æœŸå­—ç¬¦ä¸²è½¬æ¢æˆ datetime ç±»å‹ï¼Œstrftime()å‡½æ•°å¯ä»¥å°† datetime ç±»å‹è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚

```
import datetime
#æ—¥æœŸè½¬æ¢
datestr = datetime.strptime('2019-9-30 22:10:00', '%Y-%m-%d %H:%M:%S')
now = datetime.now()
print(datestr)
print(now.strftime('%a, %b %d %H:%M'))

2019-09-30 22:10:00
Tue, Oct 01 00:02
```

- timedelta()å‡½æ•°è¿”å›ä¸€ä¸ª timedelta ç±»å‹çš„æ•°æ®ï¼Œå®ƒè¡¨ç¤ºä¸€æ®µæ—¶é—´è€Œä¸æ˜¯ä¸€ä¸ªæ—¶åˆ»ï¼Œå¤šç”¨äºæ—¥æœŸçš„å¢åŠ å’Œå‡å°‘åœºæ™¯
```
import datetime
#æ—¥æœŸå¢åŠ å’Œå‡å°‘
now = datetime.datetime.now()
print(now)

newdate = now + datetime.timedelta(hours=10)
print(newdate)

newdate = now - datetime.timedelta(days=1)
print(newdate)

2019-10-01 00:23:50.152118
2019-10-01 10:23:50.152118
2019-09-30 00:23:50.152118
```


æ—¥æœŸåŠ å‡ï¼šdate çš„èŒƒå›´ æ˜¯ date.minï¼ˆ å¹´ = 1ï¼Œ æœˆ = 1ï¼Œ æ—¥ = 1ï¼‰ åˆ°date.maxï¼ˆ å¹´ = 9999ï¼Œ æœˆ = 12ï¼Œ æ—¥ = 31ï¼‰ã€‚ä¸èƒ½ä½¿ç”¨å®ƒæ¥è¿›è¡Œå’Œå†å²æˆ–è€…å¤©æ–‡ç›¸å…³çš„è®¡ç®—ã€‚


```
from datetime import date
from datetime import timedelta
one_day = timedelta(days=1)
now = date.today()
tomorrow = now + one_day
print(tomorrow)
print(now + 17*one_day)
yesterday = now - one_day
print(yesterday)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pyth.py"
2022-09-09
2022-09-25
2022-09-07
```

å…¶ä½™æ¡ˆä¾‹


```
import datetime
halloween = datetime.date(2014, 10, 31)
print(halloween)
halloween = datetime.date(2014,10,31)
print(halloween.day)
print(halloween.month)
print(halloween.year)
print(halloween.isoformat())
now = datetime.datetime.today()
print(now)
print(now.strftime("%Y:%m:%d %H:%M:%S"))

strdate = "2022:10:08 17:15:39";
data = datetime.datetime.strptime(strdate, "%Y:%m:%d %H:%M:%S");
print(data)

[huawei@n161 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/ccc/1.py"
2014-10-31
31
10
2014
2014-10-31
2022-10-08 17:17:43.038717
2022:10:08 17:17:43
2022-10-08 17:15:39
```
## timeæ¨¡å—
ä¸ datetime æ¨¡å—æœ‰æ‰€ä¸åŒï¼Œtime æ¨¡å—ä¸»è¦åŠŸèƒ½æ˜¯è¯»å–ç³»ç»Ÿæ—¶é’Ÿçš„å½“å‰æ—¶é—´ã€‚å…¶ä¸­ï¼Œtime.time() å’Œ time.sleep() æ˜¯ä¸¤ä¸ªæœ€å¸¸ç”¨çš„æ¨¡å—ã€‚


### timeå‡½æ•°

å‡½æ•°è¿”å›çš„å€¼æ˜¯å¸¦å°æ•°ç‚¹çš„ï¼Œå®ƒè¡¨ç¤ºä» Unix çºªå…ƒï¼ˆ1970å¹´1æœˆ1æ—¥0ç‚¹ï¼‰åˆ°æ‰§è¡Œä»£ç é‚£ä¸€åˆ»æ‰€ç»å†çš„æ—¶é—´çš„ç§’æ•°ï¼Œè¿™ä¸ªæ•°å­—ç§°ä¸ºUNIXçºªå…ƒæ—¶é—´æˆ³ã€‚

```
import time
print ("å½“å‰æ—¶é—´æˆ³ä¸º:", time.time())

å½“å‰æ—¶é—´æˆ³ä¸º: 1569770357.6496012
```
æˆ‘ä»¬ç»å¸¸éœ€è¦è®¡ç®—ä¸€æ®µä»£ç çš„æ‰§è¡Œæ—¶é—´ï¼Œå°±å¯ä»¥ç”¨çºªå…ƒæ—¶é—´æˆ³æ¥å®ç°ã€‚åœ¨ä»£ç ä¸­ï¼Œå‡½æ•°calculateTime()æ˜¯éœ€è¦æ‰§è¡Œçš„ä»£ç å—ï¼Œå˜é‡ startTime è¡¨ç¤ºå¼€å§‹æ—¶é—´ï¼Œå˜é‡ endTime è¡¨ç¤ºç»“æŸæ—¶é—´ï¼ŒendTime-startTimeè¡¨ç¤ºä»£ç å—è¿è¡Œçš„é—´éš”æ—¶é—´ã€‚
```
import time
def calculateTime():
    item = 1
    for i in range(1,100000):
        item = item + i
    return item

startTime = time.time()
result = calculateTime()
endTime = time.time()
print('è®¡ç®—ç»“æœï¼š'+ str(result))
print('æ‰§è¡Œæ—¶é—´ï¼š'+ str(endTime - startTime))

è®¡ç®—ç»“æœï¼š4999950001
æ‰§è¡Œæ—¶é—´ï¼š0.020943403244018555
```
å¦ä¸€ä¸ªè®¡æ—¶å™¨è§[å•çº¿ç¨‹æ¡ˆä¾‹](#å•çº¿ç¨‹æ¡ˆä¾‹)

å…¶ä½™æ¡ˆä¾‹
```
import time
now = time.time()
print(now)
print(time.ctime(now))
print(time.localtime(now))
print(time.gmtime(now))

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pyth.py"
1662626412.5671046
Thu Sep  8 16:40:12 2022
time.struct_time(tm_year=2022, tm_mon=9, tm_mday=8, tm_hour=16, tm_min=40, tm_sec=12, tm_wday=3, tm_yday=251, tm_isdst=0)
time.struct_time(tm_year=2022, tm_mon=9, tm_mday=8, tm_hour=8, tm_min=40, tm_sec=12, tm_wday=3, tm_yday=251, tm_isdst=0)
```

### sleepå‡½æ•°

å¦‚æœéœ€è¦è®©ç¨‹åºæš‚åœä¸€ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨time.sleep()å‡½æ•°ã€‚sleep()å‡½æ•°æœ‰ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºéœ€è¦æš‚åœçš„ç§’æ•°ã€‚æ‰“å°oneå’Œæ‰“å°twoä¹‹é—´æ¯æ¬¡éƒ½é—´éš”äº†ä¸€ç§’ï¼Œå› ä¸ºtime.time()å‡½æ•°è¾“å‡ºç»“æœçš„ç²¾ç¡®åº¦æ¯”è¾ƒé«˜ï¼Œä¼šå­˜åœ¨äº›è®¸è¯¯å·®ã€‚time.sleep()å‡½æ•°ä¼šé˜»å¡ä»£ç ï¼Œåªæœ‰å½“time.sleep()ä¸­çš„ç§’æ•°æµé€åï¼Œæ‰ä¼šæ‰§è¡Œåç»­ä»£ç 
```
import time
for i in range(2):
    print('one')
    print(time.time())
    time.sleep(1)
    print('two')
    print(time.time())
    time.sleep(1)
print('è¿è¡Œå®Œæˆ')

one
1569772121.6350794
two
1569772122.637142
one
1569772123.639813
two
1569772124.6423109
è¿è¡Œå®Œæˆ

```



# ç®¡é“
## ç®€å•ä½¿ç”¨
ä¾ç„¶æ˜¯ä½¿ç”¨ç®¡é“ç¬¦å·è¿›è¡Œæ“ä½œï¼Œpythonä»stdinä¸­è¿›è¡Œè¯»å–
```
import sys 
text = sys.stdin.read() 
words = text.split() 
wordcount = len(words) 
print('Wordcount:', wordcount) 

[huawei@n148 pytest]$ cat alice.txt | python3 pyth.py
Wordcount: 29465
```
ä¹Ÿå¯ä»¥è¿­ä»£stdin
```
import sys 
for line in sys.stdin: 
	process(line) 
```
## ä½¿ç”¨fileinputè¯»å–stdin

å¤šç§ä¸åŒçš„è°ƒç”¨æ–¹å¼å‡å¯è¿è¡Œï¼Œå¹¶ä¸”è¿˜æ”¯æŒå¤šæ–‡ä»¶

```
import os 
import sys 
import fileinput 

def main (): 
    for line in fileinput.input():
        meta = [fileinput.filename(), fileinput.fileno(), fileinput.filelineno(), fileinput.isfirstline(), fileinput.isstdin()]
        print (*meta , end="")
        print(line , end="") 

if __name__ == "__main__":
    main()



[huawei@n161 ccc]$ cat test2.csv|python3 1.py
<stdin> 0 1 True Trueid,name,age
<stdin> 0 2 False True1001,å¼ ä¸‰,222
<stdin> 0 3 False True1001,å¼ ä¸‰,21
<stdin> 0 4 False True1002,æå››,31
[huawei@n161 ccc]$ python3 1.py < test2.csv
<stdin> 0 1 True Trueid,name,age
<stdin> 0 2 False True1001,å¼ ä¸‰,222
<stdin> 0 3 False True1001,å¼ ä¸‰,21
<stdin> 0 4 False True1002,æå››,31
[huawei@n161 ccc]$ python3 1.py  test2.csv
test2.csv 3 1 True Falseid,name,age
test2.csv 3 2 False False1001,å¼ ä¸‰,222
test2.csv 3 3 False False1001,å¼ ä¸‰,21
test2.csv 3 4 False False1002,æå››,31


[huawei@n161 ccc]$ python3 1.py  test2.csv 1.json
test2.csv 3 1 True Falseid,name,age
test2.csv 3 2 False False1001,å¼ ä¸‰,222
test2.csv 3 3 False False1001,å¼ ä¸‰,21
test2.csv 3 4 False False1002,æå››,31
1.json 3 1 True False[{"vegetable":"cauliflower","drink":"orange juice","fruit":"banana"},{"å­˜å‚¨è®¡ç®—åˆ†ç¦»":"lettuce","å­˜å‚¨":"è®¡ç®—","fruit":"æ¦‚å¿µæ‰‹å†Œ"}]Add new textAdd new textAdd new text
1.json 3 2 False False
1.json 3 3 False False
1.json 3 4 False False
```

## è¾“å‡ºåˆ°sys.stdoutä¸sys.stderr


```
import os 
import sys 
def main (): 
    sys.stdout.write('hello\n')
    sys.stderr.write('error\n')

if __name__ == "__main__":
    main()


é»˜è®¤2ä¸ªéƒ½è¾“å‡ºäº†
[huawei@n161 ccc]$ python3 1.py  
hello
error

å°†stdouté‡å®šå‘åˆ°nullååªå‰©erroräº†
[huawei@n161 ccc]$ python3 1.py  > /dev/null
error


[huawei@n161 ccc]$ python3 1.py  2 > /dev/null
error
```

é€šå¸¸å¦‚ä¸‹ä½¿ç”¨stderrè¿”å›é”™è¯¯ç 

```
import os 
import sys 

def main (): 
    sys.stderr.write('error\n')
    sys.exit(3)

if __name__ == "__main__":
    main()

[huawei@n161 ccc]$ python3 1.py  
error
[huawei@n161 ccc]$ echo $?
3
```

# æ­£åˆ™ re
å»ºè®®å­—ç¬¦ä¸²éƒ½ä½¿ç”¨åŸå§‹å­—ç¬¦ä¸²å³r""  

## åŒ¹é… match
ä½¿ç”¨matchï¼ˆpattern ,string ,flags ï¼‰å‡½æ•°è¿›è¡Œå­—ç¬¦ä¸²åŒ¹é…ï¼Œre.match()æ–¹æ³•è¦æ±‚å¿…é¡»ä»å­—ç¬¦ä¸²çš„å¼€å¤´è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœå­—ç¬¦ä¸²çš„å¼€å¤´ä¸åŒ¹é…ï¼Œæ•´ä¸ªåŒ¹é…å°±å¤±è´¥äº†

- pattern : æ˜¯åŒ¹é…çš„è§„åˆ™å†…å®¹
- string : è¦åŒ¹é…çš„å­—ç¬¦ä¸²
- flag : å¯é€‰ï¼Œè¡¨ç¤ºåŒ¹é…æ¨¡å¼ï¼Œæ¯”å¦‚å¿½ç•¥å¤§å°å†™ï¼Œå¤šè¡Œæ¨¡å¼ç­‰ï¼Œå…·ä½“å‚æ•°ä¸ºï¼š
	- re.I å¿½ç•¥å¤§å°å†™
	- re.L è¡¨ç¤ºç‰¹æ®Šå­—ç¬¦é›† \w, \W, \b, \B, \s, \S ä¾èµ–äºå½“å‰ç¯å¢ƒ
	- re.M å¤šè¡Œæ¨¡å¼
	- re.S å³ä¸º . å¹¶ä¸”åŒ…æ‹¬æ¢è¡Œç¬¦åœ¨å†…çš„ä»»æ„å­—ç¬¦ï¼ˆ. ä¸åŒ…æ‹¬æ¢è¡Œç¬¦ï¼‰
	- re.U è¡¨ç¤ºç‰¹æ®Šå­—ç¬¦é›† \w, \W, \b, \B, \d, \D, \s, \S ä¾èµ–äº Unicode å­—ç¬¦å±æ€§æ•°æ®åº“
	- re.X ä¸ºäº†å¢åŠ å¯è¯»æ€§ï¼Œå¿½ç•¥ç©ºæ ¼å’Œ # åé¢çš„æ³¨é‡Š
- å¦‚æœåŒ¹é…æˆåŠŸï¼Œåˆ™è¿”å›ä¸€ä¸ªMatchå¯¹è±¡ï¼ˆåŒ¹é…å¯¹è±¡ï¼‰ï¼Œå¦åˆ™è¿”å›Noneã€‚

```
import re
str_content = "Python is a good language"  # è¦åŒ¹é…çš„å†…å®¹, å¯¹åº”match é‡Œé¢çš„string
str_pattern = "Python"  # pattern åŒ¹é…çš„è§„åˆ™
re_content = re.match("Python", str_content)
print(re_content)

re_content = re.match("Python", str_content).span()
print(re_content)

re_content = re.match("PYTHON", str_content, re.I)
if re_content:
    print(re_content.group())
else:
    print("æ²¡æœ‰åŒ¹é…åˆ°å†…å®¹")

[huawei@n161 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/ccc/1.py"
<_sre.SRE_Match object; span=(0, 6), match='Python'>
(0, 6)
Python
```
## æŸ¥æ‰¾ search
ä½¿ç”¨re.search(pattern, string, flags=0)æ–¹æ³•æ‰«ææ•´ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›ç¬¬ä¸€ä¸ªæˆåŠŸçš„åŒ¹é…ã€‚å¦‚æœåŒ¹é…å¤±è´¥ï¼Œåˆ™è¿”å›Noneã€‚
- pattern : æ­£åˆ™ä¸­çš„æ¨¡å¼å­—ç¬¦ä¸²ã€‚
- string : è¦è¢«æŸ¥æ‰¾æ›¿æ¢çš„åŸå§‹å­—ç¬¦ä¸²ã€‚
- flags : æ ‡å¿—ä½ï¼Œç”¨äºæ§åˆ¶æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…æ–¹å¼ï¼Œå¦‚ï¼šæ˜¯å¦åŒºåˆ†å¤§å°å†™ï¼Œå¤šè¡ŒåŒ¹é…ç­‰ç­‰ã€‚
```
import re
content = 'Hello 123456789 Word_This is just a test 666 Test'
result = re.search('(\d+).*?(\d+).*', content)  
 
print(result)
print(result.group())    # print(result.group(0)) åŒæ ·æ•ˆæœå­—ç¬¦ä¸²
print(result.groups())
print(result.group(1))
print(result.group(2))

[huawei@n161 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/ccc/1.py"
<_sre.SRE_Match object; span=(6, 49), match='123456789 Word_This is just a test 666 Test'>
123456789 Word_This is just a test 666 Test
('123456789', '666')
123456789
666

```

## æŸ¥æ‰¾ findall
findallï¼ˆpï¼Œtextï¼‰ï¼šåœ¨textå­—ç¬¦ä¸²ä¸­æŸ¥æ‰¾æ‰€æœ‰åŒ¹é…çš„å†…å®¹ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œåˆ™è¿”å›æ‰€æœ‰åŒ¹é…çš„å­—ç¬¦ä¸²åˆ—è¡¨ï¼›å¦‚æœä¸€ä¸ªéƒ½æ²¡æœ‰åŒ¹é…ï¼Œåˆ™è¿”å›Noneã€‚pæ˜¯æ­£åˆ™è¡¨è¾¾å¼ã€‚

- findall()è¿”å›çš„æ˜¯æ‹¬å·æ‰€åŒ¹é…åˆ°çš„ç»“æœï¼Œå¤šä¸ªæ‹¬å·å°±ä¼šè¿”å›å¤šä¸ªæ‹¬å·åˆ†åˆ«åŒ¹é…åˆ°çš„ç»“æœï¼Œ
- å¦‚æœæ²¡æœ‰æ‹¬å·å°±è¿”å›å°±è¿”å›æ•´æ¡è¯­å¥æ‰€åŒ¹é…åˆ°çš„ç»“æœã€‚
- è¿™ä¸ªç‰¹æ€§æ˜¯æ­£åˆ™è¡¨è¾¾å¼ç‰¹æœ‰çš„ï¼Œè€Œä¸ä»…ä»…åªæ˜¯pythonè¯­è¨€ã€‚
```
import re
kk = re.compile(r'\d+')
print(kk.findall('one1two2three3four4'))
#[1,2,3,4]
 
#æ³¨æ„æ­¤å¤„findall()çš„ç”¨æ³•ï¼Œå¯ä¼ ä¸¤ä¸ªå‚æ•°;
kk = re.compile(r'\d+')
print(re.findall(kk,"one123"))
#[1,2,3]



string="abcdefg  acbdgef  abcdgfe  cadbgfe"
#å¸¦æ‹¬å·ä¸ä¸å¸¦æ‹¬å·çš„åŒºåˆ«
#ä¸å¸¦æ‹¬å·,regex ä¸­å¸¦æœ‰2ä¸ªæ‹¬å·ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶è¾“å‡ºæ˜¯ä¸€ä¸ªlistä¸­åŒ…å«2ä¸ªtupleã€‚
regex=re.compile("((\w+)\s+\w+)")
print(regex.findall(string))
#è¾“å‡ºï¼š[('abcdefg  acbdgef', 'abcdefg'), ('abcdgfe  cadbgfe', 'abcdgfe')]

# regex ä¸­å¸¦æœ‰1ä¸ªæ‹¬å·ï¼Œå…¶è¾“å‡ºçš„å†…å®¹å°±æ˜¯æ‹¬å·åŒ¹é…åˆ°çš„å†…å®¹ï¼Œè€Œä¸æ˜¯æ•´ä¸ªè¡¨è¾¾å¼æ‰€åŒ¹é…åˆ°çš„ç»“æœã€‚
regex1=re.compile("(\w+)\s+\w+")
print(regex1.findall(string))
#è¾“å‡ºï¼š['abcdefg', 'abcdgfe']

# regex ä¸­ä¸å¸¦æœ‰æ‹¬å·ï¼Œå…¶è¾“å‡ºçš„å†…å®¹å°±æ˜¯æ•´ä¸ªè¡¨è¾¾å¼æ‰€åŒ¹é…åˆ°çš„å†…å®¹ã€‚
regex2=re.compile("\w+\s+\w+")
print(regex2.findall(string))
#è¾“å‡ºï¼š['abcdefg  acbdgef', 'abcdgfe  cadbgfe']


[huawei@n161 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/ccc/1.py"
['1', '2', '3', '4']
['123']
[('abcdefg  acbdgef', 'abcdefg'), ('abcdgfe  cadbgfe', 'abcdgfe')]
['abcdefg', 'abcdgfe']
['abcdefg  acbdgef', 'abcdgfe  cadbgfe']
```

## æ›¿æ¢ sub
- re.sub(pattern,repl,string,count) æ›¿æ¢åŒ¹é…çš„å­å­—ç¬¦ä¸²ï¼Œè¿”å›å€¼æ˜¯æ›¿æ¢ä¹‹åçš„å­—ç¬¦ä¸²ã€‚
- å‚æ•°patternæ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼›
- å‚æ•°replæ˜¯ç”¨äºæ›¿æ¢çš„æ–°å­—ç¬¦ä¸²ï¼›
- å‚æ•°stringæ˜¯å³å°†è¢«æ›¿æ¢çš„æ—§å­—ç¬¦ä¸²ï¼›
- å‚æ•°countæ˜¯è¦æ›¿æ¢çš„æœ€å¤§æ•°é‡ï¼Œé»˜è®¤å€¼ä¸ºé›¶ï¼Œè¡¨ç¤ºä¸é™åˆ¶æ›¿æ¢æ•°é‡ã€‚

```
import re  # å¯¼å…¥åº“
str = "umji is the best umji in the world although GFRIEND is so lovely"
pattern = r"umji"
newstr = re.sub(pattern,"sowon",str,2)
print(newstr)

[huawei@n161 ccc]$ python3 1.py
sowon is the best sowon in the world although GFRIEND is so lovely
```

## åˆ†å‰² split

- re.split(pattern, string, maxsplit=0, flags=0)
- æŒ‰ç…§åŒ¹é…çš„å­å­—ç¬¦ä¸²è¿›è¡Œå­—ç¬¦ä¸²åˆ†å‰²ï¼Œè¿”å›å­—ç¬¦ä¸²åˆ—è¡¨å¯¹è±¡ï¼Œ
- å‚æ•°patternæ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼›
- å‚æ•°stringæ˜¯è¦åˆ†å‰²çš„å­—ç¬¦ä¸²ï¼›
- å‚æ•°maxsplitæ˜¯æœ€å¤§åˆ†å‰²æ¬¡æ•°ï¼›maxsplitçš„é»˜è®¤å€¼ä¸ºé›¶ï¼Œè¡¨ç¤ºåˆ†å‰²æ¬¡æ•°æ²¡æœ‰é™åˆ¶ã€‚

```
import re
mystr='www.csdn.com'
print(mystr)
print(re.split('\.',mystr))

[huawei@n161 ccc]$ python3 1.py
www.csdn.com
['www', 'csdn', 'com']
```


## ç»¼åˆå¤§æ¡ˆä¾‹
```
#!/usr/bin/python3

import re  # å¯¼å…¥åº“

# re.match()
#     ä»å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®åŒ¹é…ã€‚å³ç›®æ ‡å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¿…é¡»ç¬¦åˆè§„åˆ™ã€‚
#     å¦‚æœä¸æ˜¯èµ·å§‹ä½ç½®åŒ¹é…æˆåŠŸçš„è¯ï¼Œmatch()å°±è¿”å›noneã€‚
#     å¾—åˆ°ä¸€ä¸ªç»“æœå³è¿”å›ã€‚

# åŒ¹é…å•ä¸ªå­—ç¬¦
#    ?  å·¦è¾¹ç¬¬ä¸€ä¸ªå­—ç¬¦å¯é€‰
#    .  ä»»æ„ä¸€ä¸ªå­—ç¬¦ï¼ˆé™¤äº†\nï¼‰
#    [] æ­¤åˆ—è¡¨ä¸­æŸ1ä¸ªå­—ç¬¦
#    \d 0-9æŸ1ä¸ªæ•°å­—
#    \D ä¸æ˜¯æ•°å­—çš„æŸä¸ªå­—ç¬¦
#    \s ç©ºæ ¼æˆ–tabåˆ¶è¡¨ç¬¦
#    \S éç©ºæ ¼ã€éåˆ¶è¡¨ç¬¦çš„æŸä¸ªå­—ç¬¦
#    \w å¸¸è§„å­—ç¬¦ï¼ša-zã€A-Zã€0-9ã€_ å…±è®¡26+26+10+1ä¸ªå­—ç¬¦ä¸­çš„æŸä¸€ä¸ªï¼ŒåŠæ±‰å­—(python3)
#    \W é™¤äº†a-zã€A-Zã€0-9ã€_ ä¹‹å¤–çš„éå¸¸è§„å­—ç¬¦
hasPython = re.match(r"hello?", "hello") # åŒ¹é…â€œhelloâ€è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œæœ€åçš„å­—ç¬¦â€˜oâ€™å¯æœ‰å¯æ— 
print(hasPython.group() if hasPython else None)  # hello
hasPython = re.match(r"hello?", "hell")  # 'o'å¯é€‰
print(hasPython.group() if hasPython else None)  # hell

hasPython = re.match(r"h.llo", "hello")  # åŒ¹é…ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé¦–å­—ç¬¦æ˜¯â€˜hâ€™ï¼Œç¬¬2ä¸ªå­—ç¬¦éšä¾¿æ˜¯ä»€ä¹ˆï¼Œåé¢æ˜¯â€˜lloâ€™
print(hasPython.group() if hasPython else None)  # hello

hasPython = re.match(r"h[a-f]llo", "hello")  # ç¬¬2ä¸ªå­—ç¬¦æ˜¯ å­—æ¯aåˆ°å­—æ¯fä¸­çš„æŸä¸€ä¸ª
print(hasPython.group() if hasPython else None)  # hello
hasPython = re.match(r"h[a-f1-9ABCDE]llo", "hEllo") # ç¬¬2ä¸ªå­—ç¬¦æ˜¯ å­—æ¯aåˆ°å­—æ¯fä¸­çš„æŸä¸€ä¸ªï¼Œæˆ– æ•°å­—1åˆ°9ä¸­çš„æŸä¸€ä¸ªï¼Œæˆ– â€˜Aâ€™â€˜Bâ€™â€˜Câ€™â€˜Dâ€™â€˜Eâ€™ä¸­çš„æŸä¸€ä¸ª
print(hasPython.group() if hasPython else None)  # hEllo

hasPython = re.match(r"hello\d", "hello98")  # åŒ¹é…ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œâ€˜helloâ€™åç´§è·Ÿ1ä¸ªæ•°å­—.
print(hasPython.group() if hasPython else None)  # hello9
hasPython = re.match(r"hello\D", "helloä¹")  # åŒ¹é…ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œâ€˜helloâ€™åç´§è·Ÿ1ä¸ªéæ•°å­—.
print(hasPython.group() if hasPython else None)  # helloä¹

hasPython = re.match(r"he\sllo", "he llo")  # åŒ¹é…ä¸€ä¸ªå­—ç¬¦ä¸² â€˜heâ€™å’Œâ€˜lloâ€™ä¸­é—´æœ‰ä¸ªç©ºæ ¼
print(hasPython.group() if hasPython else None)  # he llo

hasPython = re.match(r"hello\w", "hello_9") # åŒ¹é…ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œâ€˜helloâ€™åç´§è·Ÿ1ä¸ªä¸‹åˆ’çº¿
print(hasPython.group() if hasPython else None)  # hello_ 


# åŒ¹é…å¤šä¸ªå­—ç¬¦
#    {3}    é™åˆ¶å·¦ä¾§ç¬¬ä¸€ä¸ªå­—ç¬¦çš„æ•°é‡é¡»æ˜¯3ä¸ª
#    {1, 3} é™åˆ¶å·¦ä¾§ç¬¬ä¸€ä¸ªå­—ç¬¦çš„æ•°é‡åœ¨1åˆ°3ä¸ª
#    *      è¡¨ç¤ºå·¦ä¾§ç¬¬ä¸€ä¸ªå­—ç¬¦å¯ä»¥æœ‰ä»»æ„ä¸ªæ•°
#    +      é™åˆ¶å·¦ä¾§ç¬¬ä¸€ä¸ªå­—ç¬¦è‡³å°‘å‡ºç°ä¸€æ¬¡
hasPython = re.match(r"æŠ¥è­¦ç”µè¯\d{3}\D", "æŠ¥è­¦ç”µè¯110æ­£ç¡®ï¼ŒæŠ¥è­¦ç”µè¯110987é”™è¯¯") # é™åˆ¶æ•°å­—å¿…é¡»æ˜¯3ä¸ª
print(hasPython.group() if hasPython else None)  # æŠ¥è­¦ç”µè¯110æ­£

hasPython = re.match(r"æ•°å­—\d{1,5}", "æ•°å­—ï¼Œè¿˜æœ‰1234567890") # åŒ¹é…å­—ç¬¦ä¸²ï¼Œâ€˜æ•°å­—â€™åé¢æœ‰1åˆ°5ä¸ªæ•°å­—
print(hasPython.group() if hasPython else None)  # Noneã€‚æœ€å°‘1ä¸ªæ•°å­—æ‰ç®—åŒ¹é…
hasPython = re.match(r"æ•°å­—\d{1,5}", "æ•°å­—123ï¼Œè¿˜æœ‰4567890") 
print(hasPython.group() if hasPython else None)  # æ•°å­—123
hasPython = re.match(r"æ•°å­—\d{1,5}", "æ•°å­—123456ï¼Œè¿˜æœ‰7890")
print(hasPython.group() if hasPython else None) # æ•°å­—12345ã€‚æ•°å­—æ•°é‡å¤§äº5ä½†æœ€å¤šå–5ä¸ª

hasPython = re.match(r"[A-Z]\d{1,2}-\d{3}", "D3-526æ˜¯é—¨ç‰Œå·")  # ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯A-Zä¸­æŸä¸ªï¼Œç„¶åæ˜¯ä¸€ä¸ªä¸ªä½æˆ–åä½çš„æ•°å­—ï¼Œç„¶åæ˜¯å‡å·ï¼Œæœ€åæ˜¯3ä½çš„æ•°å­—
print(hasPython.group() if hasPython else None)  # D3-526
hasPython = re.match(r"\w*-\d{3}", "é—¨ç‰Œå·æ˜¯D3-526") # å‡å·å‰é¢ä»»æ„ä¸ªå­—ç¬¦ï¼Œåé¢3ä¸ªæ•°å­—
print(hasPython.group() if hasPython else None)  # é—¨ç‰Œå·æ˜¯D3-526
hasPython = re.match(r"\w+-\d{3}", "é—¨ç‰Œå·æ˜¯D3-526") # å‡å·å‰é¢è‡³å°‘1ä¸ªå­—ç¬¦
print(hasPython.group() if hasPython else None)  # é—¨ç‰Œå·æ˜¯D3-526


# åŒ¹é…å¼€å¤´ç»“å°¾
#    ^  è¡¨ç¤ºä»ç›®æ ‡å­—ç¬¦ä¸²å¼€å¤´å¼€å§‹åŒ¹é…ã€‚re.matchæ–¹æ³•é»˜è®¤ä»å¤´å¼€å§‹åˆ¤æ–­
#    $  è¡¨ç¤ºæ¡ä»¶åŒ¹é…åˆ°ç›®æ ‡å­—ç¬¦ä¸²ç»“å°¾
hasPython = re.match(r"[a-z]*$", "hello python !") # ä»å¤´åˆ°å°¾éƒ½æ˜¯a-zä¸­çš„å­—ç¬¦ï¼Œä¸ªæ•°ä»»æ„
print(hasPython.group() if hasPython else None)  # None
hasPython = re.match(r"[a-zA-Z]*$", "HelloPython") # 
print(hasPython.group() if hasPython else None)  # HelloPython
hasPython = re.match(r"^[a-zA-Z]*$", "HelloPython") # ^ å¯ä»¥çœç•¥
print(hasPython.group() if hasPython else None)  # HelloPython


# è½¬ä¹‰
#    \ ä½¿ç”¨æ–œçº¿è½¬ä¹‰å ä½ç¬¦ä¸ºæ™®é€šå­—ç¬¦
hasPython = re.match(r"[a-zA-Z0-9]{4,20}@[a-zA-Z0-9]{2,20}\.com$", "vigiles@163.com") # è½¬ä¹‰â€˜ç‚¹â€™
print(hasPython.group() if hasPython else None)  # vigiles@163.com


# åŒ¹é…åˆ†ç»„ 
#    (|)  å¤šä¸ªåŒ¹é…é¡¹ï¼Œåœ¨å°æ‹¬å·-å…ƒç»„-å†…ä½¿ç”¨ç«–æ åˆ†éš”
#    ()   å°æ‹¬å·ä¹Ÿå¯ä»¥ä¸ºåŒ¹é…è§„åˆ™åˆ†ç»„
hasPython = re.match(r"æˆ‘å–œæ¬¢(java|python|js)", "æˆ‘å–œæ¬¢python") #  å°æ‹¬å·-å…ƒç»„-å†…ç«–æ åˆ†éš”ã€‚æœ¬ä¾‹åªæœ‰ä¸€ç»„å°æ‹¬å·
print(hasPython.group() if hasPython else None)   # æˆ‘å–œæ¬¢python
print(hasPython.group(1) if hasPython else None)  # pythonã€‚ group(1)æ–¹æ³•ä¼ å‚1è¿”å›åŒ¹é…åˆ°çš„å…ƒç»„å†…çš„é¡¹
hasPython = re.match(r"([a-zA-Z0-9]{4,20})@([a-zA-Z0-9]{2,20})\.com$", "vigiles@163.com") # @ç¬¦å·å‰æ”¾åœ¨ä¸€ç»„å°æ‹¬å·å†…ï¼Œ@ç¬¦å·è‡³ç‚¹ä¸­é—´çš„æ”¾åœ¨ç¬¬2ä¸ªå°æ‹¬å·å†…
print(hasPython.group(1) if hasPython else None)  # vigilesã€‚ å–ç¬¬ä¸€ä¸ªæ‹¬å·å†…åŒ¹é…åˆ°çš„æ•°æ®


html = """<h1>pythonæ­£åˆ™å¤§æ³•å¥½</h1>
<h1>pythonæ­£åˆ™å¤§æ³•å¥½</h2> ã€aã€‘
<h3>pythonæ­£åˆ™å¤§æ³•å¥½</h3>
<p>
<b>å•Šï¼Œpython3ï¼Œæ­£åˆ™éš¾</b>
<b>å•Šï¼ŒJavaï¼Œæ­£åˆ™éš¾</b>
--.--
æ•°å­— age = 90
;--
</p>"""

# åŒ¹é…åˆ†ç»„-åˆ†ç»„å‘½å
#    (?P<åç§°>åŒ¹é…è§„åˆ™)  ä¸ºåŒ¹é…è§„åˆ™å‘½å
#    (?P=åç§°)          è°ƒç”¨åŒ¹é…è§„åˆ™
p = r"<h[1-6]>.+</h[1-6]>"    # [a]è¿™é‡Œä¼šå‡ºç° <h1>pythonæ­£åˆ™å¤§æ³•å¥½</h2> çš„é”™è¯¯ç»“æœ
p = r"<(h[1-6])>.+</\1>"      # å°†è§„åˆ™ä¸­é‡å¤å†…å®¹å°è£…åœ¨ä¸€ä¸ªç»„å†…(h[1-6])ï¼Œåé¢çš„æ ¹æ®ç»„é¡ºåºè°ƒç”¨\1
p = r"<(?P<title>h[1-6])>.+</(?P=title)>"  # ä¸ºè§„åˆ™ç»„è®¾ç½®ä¸€ä¸ªåç§°titleï¼Œåé¢ä½¿ç”¨åç§°è°ƒç”¨ï¼Œå®Œæˆå°é—­åŒ¹é…
hasPython = re.match(p, html, re.S)  # re.Sæ”¯æŒæ¢è¡Œã€‚è§ä¸‹æ–‡
print(hasPython.group() if hasPython else None)  # <h1>pythonæ­£åˆ™å¤§æ³•å¥½</h1>


# reé«˜çº§ç”¨æ³•
#    re.I	ä½¿åŒ¹é…å¯¹å¤§å°å†™ä¸æ•æ„Ÿ
#    re.L	åšæœ¬åœ°åŒ–è¯†åˆ«ï¼ˆlocale-awareï¼‰åŒ¹é…
#    re.M	å¤šè¡ŒåŒ¹é…ï¼Œå½±å“ ^ å’Œ $
#    re.S	ä½¿ . ç‚¹ åŒ¹é…åŒ…æ‹¬æ¢è¡Œåœ¨å†…çš„æ‰€æœ‰å­—ç¬¦
#    re.U	æ ¹æ®Unicodeå­—ç¬¦é›†è§£æå­—ç¬¦ã€‚è¿™ä¸ªæ ‡å¿—å½±å“ \w, \W, \b, \B.
#    re.X	è¯¥æ ‡å¿—é€šè¿‡ç»™äºˆä½ æ›´çµæ´»çš„æ ¼å¼ä»¥ä¾¿ä½ å°†æ­£åˆ™è¡¨è¾¾å¼å†™å¾—æ›´æ˜“äºç†è§£ã€‚

hasPython = re.match(r".*", html, re.S)
print(hasPython.group() if hasPython else None)  # htmlå…¨æ–‡
hasPython = re.match(r".*", "")
print(hasPython.group() if hasPython else None)  # è¿”å›ç©ºç™½ã€‚*è¡¨ç¤ºä»»æ„æ•°é‡ï¼Œ0å³æ²¡æœ‰ä¹ŸåŒ¹é…

# re.search()
#     ä»å­—ç¬¦ä¸²ä»»æ„ä½ç½®åŒ¹é…ã€‚å¾—åˆ°ç¬¬1ä¸ªå³è¿”å›ã€‚
hasPython = re.search(r"å•Šï¼Œ(.+)ï¼Œæ­£åˆ™éš¾", html)
print(hasPython.group(1) if hasPython else None) # python3

# re.findall()
#     ä»å­—ç¬¦ä¸²ä»»æ„ä½ç½®åŒ¹é…ã€‚è·å–å…¨éƒ¨åŒ¹é…é¡¹ã€‚
hasPython = re.findall(r"å•Šï¼Œ(.+)ï¼Œæ­£åˆ™éš¾", html)
print(hasPython if hasPython else None) # ['python3', 'Java']

# re.sub()
#     pythonç‰¹æœ‰
#     å¦‚æœåŒ¹é…åˆ°äº†ï¼Œå°±å°†åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²æ›¿æ¢æ‰ã€‚
#     æ›¿æ¢å…¨éƒ¨çš„åŒ¹é…é¡¹
newHtml = re.sub(r"å•Šï¼Œ(.+)ï¼Œæ­£åˆ™éš¾", "C++", html) # è§„åˆ™ï¼Œæ›¿æ¢ç”¨çš„å­—ç¬¦ä¸²ï¼ŒåŸå­—ç¬¦ä¸²
print(newHtml)  # è¿”å›åŸhtmlå­—ç¬¦ä¸²ï¼Œä½†
                #   å°† <b>å•Šï¼Œpython3ï¼Œæ­£åˆ™éš¾</b>
                #      <b>å•Šï¼ŒJavaï¼Œæ­£åˆ™éš¾</b>
                #   ä¸¤å¥æ›¿æ¢ä¸ºäº† <b>C++</b>
                #              <b>C++</b>

def getReplace(language):
    return language + " NB"

newHtml = re.sub(r"å•Šï¼Œ(.+)ï¼Œæ­£åˆ™éš¾", getReplace("C++"), html) # è§„åˆ™ï¼Œæ›¿æ¢ç”¨çš„å­—ç¬¦ä¸²ï¼ŒåŸå­—ç¬¦ä¸²
print(newHtml)  # ... åŸæ–‡ ...
                #     <b>C++ NB</b>
                #     <b>C++ NB</b>
                # ... åŸæ–‡ ...

def changeNumber(tmp):
    age = tmp.group(1) # è¿™é‡Œå–åˆ°çš„ä»…ä»…æ˜¯è§„åˆ™ç»„å†…å®¹ï¼Œå³ç›®æ ‡æ•°å­—
    age = int(age) + 1
    return "age = " + str(age)

newHtml = re.sub(r"age = (\d+)", changeNumber, html) # 90æ˜¯ä¸¤ä½æ•°å­—ï¼Œç”¨+
print(newHtml)  # ... åŸæ–‡ ...
                #     æ•°å­— age = 91
                # ... åŸæ–‡ ...

# re.split()
#     æŒ‰è§„åˆ™æ‰¾åˆ°åŒ¹é…åï¼Œç”¨åŒ¹é…é¡¹åˆ‡åˆ†ç›®æ ‡å­—ç¬¦ä¸²
lst = re.split(r"\.", "å¨æ ¼çµåšå®¢ http://www.gaohaiyan.com")  # ä»…ä½¿ç”¨â€˜ç‚¹â€™åˆ‡åˆ†
print(lst) # ['å¨æ ¼çµåšå®¢ http://www', 'gaohaiyan', 'com']
lst = re.split(r":|\.| ", "å¨æ ¼çµåšå®¢ http://www.gaohaiyan.com") # å†’å·ã€ç‚¹ã€ç©ºæ ¼ï¼Œéƒ½åˆ‡åˆ†
print(lst) # ['å¨æ ¼çµåšå®¢', 'http', '//www', 'gaohaiyan', 'com']
lst = re.split(r"\W{3}", "å¨æ ¼çµåšå®¢ http://www.gaohaiyan.com") # ä¸‰ä¸ªè¿ç»­éå¸¸è§„å­—ç¬¦
print(lst) # ['å¨æ ¼çµåšå®¢ http', 'www.gaohaiyan.com']  


[huawei@n161 ccc]$ python3 1.py
hello
hell
hello
hello
hEllo
hello9
helloä¹
he llo
hello_
æŠ¥è­¦ç”µè¯110æ­£
None
æ•°å­—123
æ•°å­—12345
D3-526
é—¨ç‰Œå·æ˜¯D3-526
é—¨ç‰Œå·æ˜¯D3-526
None
HelloPython
HelloPython
vigiles@163.com
æˆ‘å–œæ¬¢python
python
vigiles
<h1>pythonæ­£åˆ™å¤§æ³•å¥½</h1>
<h1>pythonæ­£åˆ™å¤§æ³•å¥½</h1>
<h1>pythonæ­£åˆ™å¤§æ³•å¥½</h2> ã€aã€‘
<h3>pythonæ­£åˆ™å¤§æ³•å¥½</h3>
<p>
<b>å•Šï¼Œpython3ï¼Œæ­£åˆ™éš¾</b>
<b>å•Šï¼ŒJavaï¼Œæ­£åˆ™éš¾</b>
--.--
æ•°å­— age = 90
;--
</p>

python3
['python3', 'Java']
<h1>pythonæ­£åˆ™å¤§æ³•å¥½</h1>
<h1>pythonæ­£åˆ™å¤§æ³•å¥½</h2> ã€aã€‘
<h3>pythonæ­£åˆ™å¤§æ³•å¥½</h3>
<p>
<b>C++</b>
<b>C++</b>
--.--
æ•°å­— age = 90
;--
</p>
<h1>pythonæ­£åˆ™å¤§æ³•å¥½</h1>
<h1>pythonæ­£åˆ™å¤§æ³•å¥½</h2> ã€aã€‘
<h3>pythonæ­£åˆ™å¤§æ³•å¥½</h3>
<p>
<b>C++ NB</b>
<b>C++ NB</b>
--.--
æ•°å­— age = 90
;--
</p>
<h1>pythonæ­£åˆ™å¤§æ³•å¥½</h1>
<h1>pythonæ­£åˆ™å¤§æ³•å¥½</h2> ã€aã€‘
<h3>pythonæ­£åˆ™å¤§æ³•å¥½</h3>
<p>
<b>å•Šï¼Œpython3ï¼Œæ­£åˆ™éš¾</b>
<b>å•Šï¼ŒJavaï¼Œæ­£åˆ™éš¾</b>
--.--
æ•°å­— age = 91
;--
</p>
['å¨æ ¼çµåšå®¢ http://www', 'gaohaiyan', 'com']
['å¨æ ¼çµåšå®¢', 'http', '//www', 'gaohaiyan', 'com']
['å¨æ ¼çµåšå®¢ http', 'www.gaohaiyan.com']
```
# ç±»
## æ„é€ å‡½æ•° __init__
```
class Dog:
	def __init__(self, name, age):
		self.name = name
		self.age = age
	def sit(self):
 		print(f"{self.name} is now sitting.")
	def roll_over(self):
		print(f"{self.name} rolled over!")

my_dog = Dog('Willie', 6)
your_dog = Dog('Lucy', 3)
print(f"My dog's name is {my_dog.name}.")
print(f"My dog is {my_dog.age} years old.")
my_dog.sit()
print(f"\nYour dog's name is {your_dog.name}.")
print(f"Your dog is {your_dog.age} years old.")
your_dog.sit()

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
My dog's name is Willie.
My dog is 6 years old.
Willie is now sitting.

Your dog's name is Lucy.
Your dog is 3 years old.
Lucy is now sitting.
```
å‚æ•°ä¹Ÿå¯ä»¥æœ‰é»˜è®¤å€¼
```
class FooBar: 
	def __init__(self, v = 1): 
		self.somevar = v

f = FooBar("aaaaaaaaaaaaaaa")  è°ƒç”¨å¯ä»¥ä¼ é€’å‚æ•°
print(f.somevar)
```

## ææ„å‡½æ•° __del__
- å‡½æ•°å__del__ï¼Œé€šå¸¸æ— éœ€æ‰‹åŠ¨è°ƒç”¨
## ä¿®æ”¹æˆå‘˜å˜é‡å€¼
- ç›´æ¥ä¿®æ”¹å±æ€§çš„å€¼ï¼Œå³ç›´æ¥é€šè¿‡å¯¹è±¡è¿›è¡Œèµ‹å€¼ï¼Œå¦‚ my_new_car.odometer_reading = 23
- å°è£…æˆå‘˜æ–¹æ³•æ›´æ”¹å±æ€§å€¼

## ç§æœ‰æ–¹æ³•
```
class Secretive: 
	def __inaccessible(self): 
		print("Bet you can't see me ...") 
	def accessible(self): 
		print("The secret message is:") 
		self.__inaccessible() 

s = Secretive() 
s.accessible()
s.__inaccessible()	ä¸èƒ½è°ƒç”¨ç§æœ‰æ–¹æ³•ï¼Œä¼šå¤±è´¥
```
## ä½¿ç”¨property()æ“ä½œå±æ€§
ä½œç”¨ç±»ä¼¼setterã€getter
```
class Duck():
	def __init__(self, input_name):
		self.hidden_name = input_name
	def get_name(self):
		print('inside the getter')
		return self.hidden_name
	def set_name(self, input_name):
		print('inside the setter')
		self.hidden_name = input_name
	name = property(get_name, set_name)	# æ­¤å¥æ˜¯é‡ç‚¹

fowl = Duck('Howard')
print(fowl.name)	# ä¼šè°ƒç”¨ get_name
fowl.get_name()
fowl.name = 'Daffy'	# ä¼šè°ƒç”¨ set_name
print(fowl.name)
fowl.set_name('Daffy')
print(fowl.name)


[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pyth.py"
inside the getter
Howard
inside the getter
inside the setter
inside the getter
Daffy
inside the setter
inside the getter
Daffy
```

## ä½¿ç”¨setter()ã€@propertyæ“ä½œå±æ€§
```

class Duck():
	def __init__(self, input_name):
		self.hidden_name = input_name
	@property	# @propertyï¼Œç”¨äºæŒ‡ç¤º getter æ–¹æ³•ï¼›
	def name(self):
		print('inside the getter')
		return self.hidden_name
	@name.setter	# @name.setterï¼Œç”¨äºæŒ‡ç¤º setter æ–¹æ³•
	def name(self, input_name):
		print('inside the setter')
		self.hidden_name = input_name

fowl = Duck('Howard')
print(fowl.name)
fowl.name = 'Donald'
print(fowl.name)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pyth.py"
inside the getter
Howard
inside the setter
inside the getter
Donald
```

## __ç§æœ‰å˜é‡
Pythonå¯¹é‚£äº›éœ€è¦åˆ»æ„éšè—åœ¨ç±»å†…éƒ¨çš„ç‰¹æ€§æœ‰å‘½åè§„èŒƒï¼šç”±è¿ç»­çš„ä¸¤ä¸ªä¸‹åˆ’çº¿å¼€å¤´
```
class Duck():
	def __init__(self, input_name):
		self.__name = input_name
	@property
	def name(self):
		print('inside the getter')
		return self.__name
	@name.setter
	def name(self, input_name):
		print('inside the setter')
		self.__name = input_name
 
fowl = Duck('Howard')
print(fowl.name)
fowl.name = 'Donald'
print(fowl.name)
print(fowl.__name)	æ­¤å¥ä¼šerrï¼Œå¤–éƒ¨æ— æ³•è®¿é—®ï¼Œprint(fowl._Duck__name)å°±è¡Œã€‚ã€‚ã€‚
```

## å†…ç½®æ–¹æ³•

Python åˆ›å»ºä»»ä½•ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œéƒ½ä¼šåŒ…å«ä¸€äº›å†…ç½®çš„æ–¹æ³•ï¼Œä¸»è¦åŒ…æ‹¬å¦‚ä¸‹ï¼š

- \_\_init\_\_	æ„é€ å‡½æ•°ï¼Œåœ¨ç”Ÿæˆå¯¹è±¡æ—¶è°ƒç”¨
- \_\_del\_\_	ææ„å‡½æ•°ï¼Œé‡Šæ”¾å¯¹è±¡æ—¶ä½¿ç”¨
- \_\_repr\_\_	æ‰“å°ï¼Œè½¬æ¢
- \_\_setitem\_\_	æŒ‰ç…§ç´¢å¼•èµ‹å€¼
- \_\_getitem\_\_	æŒ‰ç…§ç´¢å¼•è·å–å€¼
- \_\_len\_\_	è·å¾—é•¿åº¦
- \_\_cmp\_\_	æ¯”è¾ƒè¿ç®—
- \_\_call\_\_	å‡½æ•°è°ƒç”¨
- \_\_add\_\_	åŠ è¿ç®—
- \_\_sub\_\_	å‡è¿ç®—
- \_\_mul\_\_	ä¹˜è¿ç®—
- \_\_div\_\_	é™¤è¿ç®—
- \_\_mod\_\_	æ±‚ä½™è¿ç®—
- \_\_pow\_\_	ä¹˜æ–¹

## å®ä¾‹æ–¹æ³•

å®ä¾‹æ–¹æ³•å°±æ˜¯ç±»çš„å®ä¾‹èƒ½å¤Ÿä½¿ç”¨çš„æ–¹æ³•ã€‚ä»¥selfä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°çš„æ–¹æ³•éƒ½æ˜¯å®ä¾‹æ–¹æ³•ã€‚å½“è¢«è°ƒç”¨æ—¶PythonæŠŠè°ƒç”¨è¯¥æ–¹æ³•çš„å¯¹è±¡ä½œä¸ºselfå‚æ•°ä¼ å…¥

```
# å®ä¾‹æ–¹æ³•ï¼ˆå¯è°ƒç±»å˜é‡ã€å¯è°ƒå®ä¾‹å˜é‡ã€å¯è¢«å®ä¾‹è°ƒç”¨ï¼‰
# ç¬¬ä¸€ä¸ªå‚æ•°å¼ºåˆ¶ä¸ºå®ä¾‹å¯¹è±¡ selfã€‚
class Car(object):
    name = 'BMW'
    def __init__(self, name):
        self.name = name
    def run(self,speed):
        print(self.name,speed,'è¡Œé©¶')

# è®¿é—®
c = Car("å®é©¬")
c.run("100è¿ˆ")
```

## ç±»æ–¹æ³•
- åœ¨ç±»å®šä¹‰å†…éƒ¨ï¼Œç”¨å‰ç¼€ä¿®é¥°ç¬¦ @classmethod æŒ‡å®šçš„æ–¹æ³•éƒ½æ˜¯ç±»æ–¹æ³•
- å¯ä»¥ç”¨ç±»åç›´æ¥è°ƒç”¨ï¼Œé»˜è®¤å‚æ•°æ˜¯clsï¼ˆå³classï¼‰ï¼ŒæŒ‡ç±»è‡ªèº«ï¼Œç”±ç³»ç»Ÿè‡ªåŠ¨ä¼ å…¥
- ä½œç”¨äºæ•´ä¸ªç±»ï¼Œå¯¹ç±»ä½œå‡ºçš„ä»»ä½•æ”¹å˜ä¼šå¯¹å®ƒçš„æ‰€æœ‰å®ä¾‹å¯¹è±¡äº§ç”Ÿå½±å“



```
ç±»æ–¹æ³•ï¼ˆå¯è°ƒç±»å˜é‡ã€å¯è¢«å®ä¾‹è°ƒç”¨ã€å¯è¢«ç±»è°ƒç”¨ï¼‰
1ã€ç±»æ–¹æ³•é€šè¿‡@classmethodè£…é¥°å™¨å®ç°ï¼Œåªèƒ½è®¿é—®ç±»å˜é‡ï¼Œä¸èƒ½è®¿é—®å®ä¾‹å˜é‡ï¼›
2ã€é€šè¿‡clså‚æ•°ä¼ é€’å½“å‰ç±»å¯¹è±¡ï¼Œä¸éœ€è¦å®ä¾‹åŒ–ã€‚

class Car(object):
    name = 'BMW'
    def __init__(self, name):
        self.name = name
    @classmethod
    def run(cls,speed):
        print(cls.name,speed,'è¡Œé©¶')
# è®¿é—®æ–¹å¼1
c = Car("å®é©¬")
c.run("100è¿ˆ")
# è®¿é—®æ–¹å¼2
Car.run("100è¿ˆ")
```
æ¡ˆä¾‹
```
class A():
	count = 0	ç±»å˜é‡ï¼Œæ­¤å˜é‡ä¸å±äºself
	def __init__(self):
		A.count += 1	æ³¨æ„è¿™é‡Œçš„è°ƒç”¨æ–¹å¼ä¸æ˜¯self
	def exclaim(self):
		print("I'm an A!")
	@classmethod
	def kids(cls):	ç±»æ–¹æ³•ä½¿ç”¨classmethodè£…é¥°ï¼Œå‚æ•°1ä»£è¡¨å½“å‰ç±»ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æ›´å¤šå‚æ•°
		print("A has", cls.count, "little objects.")

easy_a = A()
breezy_a = A()
wheezy_a = A()
A.kids()

[huawei@n161 aaa]$ python -u "/home/huawei/hwwork/doc/md/aaa/v2.py"
('A has', 3, 'little objects.')
```
å¦ä¸€ä¸ªæ¡ˆä¾‹
```
class Factory:
     
    def __init__(self):
        print("å·¥å‚init==")
 
    @classmethod
    def createMachine(cls, clazz):
        if issubclass(clazz, TV):
            print("åˆ›å»ºç”µè§†æœº")
            return TV("ç†ŠçŒ«")
 
        if issubclass(clazz, Radio):
            print("åˆ›å»ºæ”¶éŸ³æœº")
            return cls().__getRadio() # cls()åˆ›å»ºç±»çš„å®ä¾‹å¯¹è±¡
 
    def __getRadio(self):
        return Radio()
 
 
class TV:
    def __init__(self, brand):
        self.brand = brand
        print("ç”µè§†æœºåˆå§‹åŒ–ï¼Œå“ç‰Œ %s" % self.brand)
 
    def playMovie(self):
        print("æ’­æ”¾ç”µå½±---")
 
 
class Radio:
    def __init__(self):
        print("æ”¶éŸ³æœºåˆå§‹åŒ–")
 
    def playSong(self):
        print("å¼€å§‹å¹¿æ’­---")
 
 
tv = Factory.createMachine(TV)
tv.playMovie()
 
radio = Factory.createMachine(Radio)
radio.playSong()


[huawei@n161 ccc]$ python3 1.py
åˆ›å»ºç”µè§†æœº
ç”µè§†æœºåˆå§‹åŒ–ï¼Œå“ç‰Œ ç†ŠçŒ«
æ’­æ”¾ç”µå½±---
åˆ›å»ºæ”¶éŸ³æœº
å·¥å‚init==
æ”¶éŸ³æœºåˆå§‹åŒ–
å¼€å§‹å¹¿æ’­---

```


## é™æ€æ–¹æ³•

é™æ€æ–¹æ³•æ˜¯ç±»ä¸­çš„å‡½æ•°ï¼Œä¸éœ€è¦å®ä¾‹ã€‚
- é™æ€æ–¹æ³•ä½¿ç”¨@staticmethodè£…é¥°å™¨ï¼Œå®ƒæ—¢ä¸éœ€è¦ self å‚æ•°ä¹Ÿä¸éœ€è¦ class å‚æ•°
- å…¶å®é™æ€æ–¹æ³•å°±æ˜¯æ™®é€šçš„å‡½æ•°ï¼Œåªæ˜¯å®šä¹‰åœ¨äº†ç±»ä½“ä¸­ï¼Œè€Œä¸æ˜¯åœ¨æ¨¡å—é‡Œ

```

é™æ€æ–¹æ³•ï¼ˆå¯è°ƒç±»å˜é‡ã€å¯è¢«å®ä¾‹è°ƒç”¨ã€å¯è¢«ç±»è°ƒç”¨ï¼‰
1ã€ç”¨ @staticmethod è£…é¥°çš„ä¸å¸¦ self å‚æ•°çš„æ–¹æ³•ï¼›
2ã€é™æ€æ–¹æ³•åä¹‰ä¸Šå½’ç±»ç®¡ç†ï¼Œå®é™…ä¸­åœ¨é™æ€æ–¹æ³•ä¸­æ— æ³•è®¿é—®ç±»å’Œå®ä¾‹ä¸­çš„ä»»ä½•å±æ€§ï¼›
3ã€è°ƒç”¨æ—¶å¹¶ä¸éœ€è¦ä¼ é€’ç±»æˆ–å®ä¾‹ã€‚

class Car(object):
    name = 'BMW'
    def __init__(self, name):
        self.name = name
    @staticmethod
    def run(speed):
        print(Car.name,speed,'è¡Œé©¶')
        
# è®¿é—®æ–¹å¼1
c = Car("å®é©¬")
c.run("100è¿ˆ")
# è®¿é—®æ–¹å¼2
Car.run("100è¿ˆ")
```

æ¡ˆä¾‹

```
class Demo:
	@classmethod
	def klassmeth(*args):
		return args
	@staticmethod
	def statmeth(*args):
		return args

print(Demo.klassmeth())		ç¬¬ä¸€ä¸ªå‚æ•°å§‹ç»ˆæ˜¯ Demo ç±»
print(Demo.klassmeth('spam'))
print(Demo.statmeth())		è¡Œä¸ºä¸æ™®é€šçš„å‡½æ•°ç›¸ä¼¼
print(Demo.statmeth('spam'))



[huawei@n161 aaa]$ python -u "/home/huawei/hwwork/doc/md/aaa/v2.py"
(<class __main__.Demo at 0x7fbaf2b19530>,)
(<class __main__.Demo at 0x7fbaf2b19530>, 'spam')
()
('spam',)
```
å…¶å®ƒæ¡ˆä¾‹

```
class MyClass: 
	@staticmethod 
	def smeth(): 
 		print('This is a static method') 
	@classmethod 
	def cmeth(cls): 
		print('This is a class method of', cls) 
  
MyClass.smeth() 
MyClass.cmeth()

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
This is a static method
This is a class method of <class '__main__.MyClass'>
```
åƒåœ¾å·¥å‚æ¡ˆä¾‹
```
class Person(object):
     
    @staticmethod
    #é™æ€â½…æ³•
    def getPerson(clazz):
        if issubclass(clazz, Student):
            print("åˆ›å»ºå­¦ç”Ÿ")
            return Student()
 
        if issubclass(clazz, Worker):
            print("åˆ›å»ºå·¥äºº")
            return Worker()
 
class Student:
    def study(self):
        print("å­¦ä¹ ")
 
class Worker:
    def work(self):
        print("å·¥ä½œ")
 
student=Person.getPerson(Student)
student.study()
 
worker=Person.getPerson(Worker)
worker.work()

[huawei@n161 ccc]$ python3 1.py
åˆ›å»ºå­¦ç”Ÿ
å­¦ä¹ 
åˆ›å»ºå·¥äºº
å·¥ä½œ
```
## ç»¼åˆå¤§æ¡ˆä¾‹
ä½¿ç”¨ç‰¹æ®Šæ–¹æ³•å’Œçº¦å®šçš„ç»“æ„ï¼Œå®šä¹‰è¡Œä¸ºè‰¯å¥½ä¸”ç¬¦åˆ Python é£æ ¼çš„ç±»ã€‚

```
from array import array
import math

class Vector2d:
	typecode = 'd'
	def __init__(self, x, y):
    # æŠŠxå’Œyè½¬æ¢æˆæµ®ç‚¹æ•°ï¼ŒæŠŠå±æ€§æ ‡è®°ä¸ºç§æœ‰çš„ï¼ˆå³__å¼€å¤´ï¼‰
		self.__x = float(x)
		self.__y = float(y)
	@property
	# propertyè£…é¥°å™¨æŠŠè¯»å€¼æ–¹æ³•æ ‡è®°ä¸ºç‰¹æ€§ï¼Œè¯»å€¼æ–¹æ³•ä¸å…¬å¼€å±æ€§åŒåï¼Œéƒ½æ˜¯xï¼Œç›´æ¥è¿”å›self.__x
	def x(self):
		return self.__x
	@property
	def y(self):
		return self.__y
	def __iter__(self):
    # æŠŠå®ä¾‹å˜æˆå¯è¿­ä»£çš„å¯¹è±¡ï¼Œè¿™æ ·æ‰èƒ½æ‹†åŒ…,å¦‚x,y=my_vector
    # é€šè¿‡ self.x å’Œ self.y è¯»å–å…¬å¼€ç‰¹æ€§ï¼Œè€Œä¸å¿…è¯»å–ç§æœ‰å±æ€§
    # è°ƒç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼ä¸€ä¸ªæ¥ä¸€ä¸ªäº§å‡ºåˆ†é‡
    # ä¹Ÿå¯ä»¥å†™æˆ yield self.x; yield.self.y
		return (i for i in (self.x, self.y))	
	def __repr__(self):
    # ä½¿ç”¨ {!r} è·å–å„ä¸ªåˆ†é‡çš„è¡¨ç¤ºå½¢å¼ï¼Œç„¶åæ’å€¼ï¼Œæ„æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼›å› ä¸º
    # Vector2d å®ä¾‹æ˜¯å¯è¿­ä»£çš„å¯¹è±¡ï¼Œæ‰€ä»¥ *self ä¼šæŠŠ x å’Œ y åˆ†é‡æä¾›ç»™ format å‡½æ•°ã€‚
		class_name = type(self).__name__
		return '{}({!r}, {!r})'.format(class_name, *self)
	def __str__(self):
    # ä»å¯è¿­ä»£çš„ Vector2d å®ä¾‹ä¸­å¯ä»¥è½»æ¾åœ°å¾—åˆ°ä¸€ä¸ªå…ƒç»„ï¼Œæ˜¾ç¤ºä¸ºä¸€ä¸ªæœ‰åºå¯¹
		return str(tuple(self))
	def __bytes__(self):
    # æŠŠtypecodeè½¬æ¢æˆå­—èŠ‚åºåˆ—ï¼Œå¹¶è¿­ä»£Vector2då®ä¾‹ï¼Œå¾—åˆ°ä¸€ä¸ªæ•°ç»„ï¼Œå†æŠŠæ•°ç»„è½¬æ¢æˆå­—èŠ‚åºåˆ—
		return (bytes([ord(self.typecode)]) + bytes(array(self.typecode, self)))
	def __eq__(self, other):
    # æ­¤å®ç°æ¯”è¾ƒå…ƒç»„ï¼Œä½†å‰¯ä½œç”¨æ˜¯Vector(3, 4)==[3, 4]ä¹Ÿä¼šè¿”å›æ­£ç¡®
		return tuple(self) == tuple(other)
	# ä¸ºäº†æŠŠ Vector2d å®ä¾‹å˜æˆå¯æ•£åˆ—çš„ï¼Œè¦æœ‰__hash__ã€__eq__ï¼Œè¿˜è¦è®©å‘é‡ä¸å¯å˜
	# ä½¿ç”¨ä½è¿ç®—ç¬¦å¼‚æˆ–ï¼ˆ^ï¼‰æ··åˆå„åˆ†é‡çš„æ•£åˆ—å€¼
	def __hash__(self):
 		return hash(self.x) ^ hash(self.y)
	def __abs__(self):
    # æ¨¡æ˜¯ x å’Œ y åˆ†é‡æ„æˆçš„ç›´è§’ä¸‰è§’å½¢çš„æ–œè¾¹é•¿
		return math.hypot(self.x, self.y)
	def __bool__(self):
    # è®¡ç®—æ¨¡ç„¶åæŠŠç»“æœè½¬æ¢æˆå¸ƒå°”å€¼
		return bool(abs(self))
	def __format__(self, fmt_spec=''):
    # å¦‚æœæ ¼å¼ä»£ç ä»¥ 'p' ç»“å°¾ï¼Œä½¿ç”¨æåæ ‡
		if fmt_spec.endswith('p'):
    # ä» fmt_spec ä¸­åˆ é™¤ 'p' åç¼€ã€‚
			fmt_spec = fmt_spec[:-1]
	# æ„å»ºä¸€ä¸ªå…ƒç»„ï¼Œè¡¨ç¤ºæåæ ‡ï¼š(magnitude, angle)ã€‚
			coords = (abs(self), self.angle())
			outer_fmt = '<{}, {}>'
		else:
    # å¦‚æœä¸ä»¥ 'p' ç»“å°¾ï¼Œä½¿ç”¨ self çš„ x å’Œ y åˆ†é‡æ„å»ºç›´è§’åæ ‡ã€‚
			coords = self
			outer_fmt = '({}, {})'
	# ä½¿ç”¨formatå‡½æ•°æŠŠfmt_specåº”ç”¨åˆ°å„ä¸ªåˆ†é‡ä¸Šï¼Œæ„å»ºä¸€ä¸ªå¯è¿­ä»£çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²
		components = (format(c, fmt_spec) for c in coords)
		return outer_fmt.format(*components)
	@classmethod
	# ç±»æ–¹æ³•è£…é¥°å™¨ï¼Œä»å­—èŠ‚åºåˆ—è½¬æ¢æˆ Vector2då®ä¾‹
	def frombytes(cls, octets):
    # è¯»å–ç¬¬ä¸€ä¸ªå­—èŠ‚èµ‹å€¼ç»™typecode
		typecode = chr(octets[0])
	# ä½¿ç”¨ä¼ å…¥çš„ octets å­—èŠ‚åºåˆ—åˆ›å»ºä¸€ä¸ª memoryviewï¼Œç„¶åä½¿ç”¨ typecode è½¬æ¢
		memv = memoryview(octets[1:]).cast(typecode)
	# æ‹†åŒ…è½¬æ¢åçš„ memoryviewï¼Œå¾—åˆ°æ„é€ æ–¹æ³•æ‰€éœ€çš„ä¸€å¯¹å‚æ•°
		return cls(*memv)

	# è®¡ç®—è§’åº¦
	def angle(self):
		return math.atan2(self.y, self.x)


v1 = Vector2d(3, 4)
print(v1.x, v1.y)
x, y = v1	# æ‹†åŒ…
print(x, y)
v1_clone = eval(repr(v1))
print(v1 == v1_clone)	# è°ƒç”¨æ¯”è¾ƒ__eq__
print(v1)	# ä¼šè°ƒç”¨__str__
octets = bytes(v1)	# è°ƒç”¨ __bytes__
print(octets)
print(abs(v1))	# è°ƒç”¨ __abs__
print(bool(v1), bool(Vector2d(0, 0))) # è°ƒç”¨ __bool__

v1_clone = Vector2d.frombytes(bytes(v1))
print(v1_clone)
print(v1 == v1_clone)

print(format(v1))
print(format(v1, '.2f'))	# è°ƒç”¨__format__
print(format(v1, '.3e'))

print(Vector2d(0, 0).angle())
print(Vector2d(1, 0).angle())
epsilon = 10**-8
print(abs(Vector2d(0, 1).angle() - math.pi/2) < epsilon)
print(abs(Vector2d(1, 1).angle() - math.pi/4) < epsilon)

print(format(Vector2d(1, 1), 'p'))
print(format(Vector2d(1, 1), '.3ep'))
print(format(Vector2d(1, 1), '0.5fp'))


print(v1.x, v1.y)
# v1.x = 123	ä¸èƒ½ä¿®æ”¹å±æ€§

v1 = Vector2d(3, 4)
v2 = Vector2d(3.1, 4.2)
print(hash(v1), hash(v2))
print(len(set([v1, v2])))

print(v1.__dict__)
print(v1._Vector2d__x)

[huawei@n161 aaa]$ python3 v2.py
3.0 4.0
3.0 4.0
True
(3.0, 4.0)
b'd\x00\x00\x00\x00\x00\x00\x08@\x00\x00\x00\x00\x00\x00\x10@'
5.0
True False
(3.0, 4.0)
True
(3.0, 4.0)
(3.00, 4.00)
(3.000e+00, 4.000e+00)
0.0
0.0
True
True
<1.4142135623730951, 0.7853981633974483>
<1.414e+00, 7.854e-01>
<1.41421, 0.78540>
3.0 4.0
7 384307168202284039
2
{'_Vector2d__x': 3.0, '_Vector2d__y': 4.0}
3.0

```
## __slots__å±æ€§
- é»˜è®¤æƒ…å†µä¸‹ï¼ŒPython åœ¨å„ä¸ªå®ä¾‹ä¸­åä¸º __dict__ çš„å­—å…¸é‡Œå­˜å‚¨å®ä¾‹å±æ€§ã€‚
- é€šè¿‡ __slots__ ç±»å±æ€§ï¼Œèƒ½èŠ‚çœå¤§é‡å†…å­˜ï¼Œæ–¹æ³•æ˜¯è®©è§£é‡Šå™¨åœ¨å…ƒç»„ä¸­å­˜å‚¨å®ä¾‹å±æ€§ï¼Œè€Œä¸ç”¨å­—å…¸
- å…·ä½“è§æµç•…çš„Python9.8
## æ“ä½œç¬¦é‡è½½ __eq__
æ¼”ç¤ºäº†é‡è½½ç­‰å·ï¼Œè¿˜æœ‰å¾ˆå¤šå…¶å®ƒç¬¦å·ï¼Œè¯¦è§pythonè¯­è¨€åŠå…¶åº”ç”¨6.12
```
class Word():
	def __init__(self, text):
		self.text = text
	def __eq__(self, word2):
		return self.text.lower() == word2.text.lower()

first = Word('ha')
second = Word('HA')
third = Word('eh')
print(first == second)
print(first == third)
```
## ç”¨æˆ·å®šä¹‰çš„å¯è°ƒç”¨ç±»å‹ __call__
- ä¸ä»… Python å‡½æ•°æ˜¯çœŸæ­£çš„å¯¹è±¡ï¼Œä»»ä½• Python å¯¹è±¡éƒ½å¯ä»¥è¡¨ç°å¾—åƒå‡½æ•°ã€‚ä¸ºæ­¤ï¼Œåªéœ€å®ç°å®ä¾‹æ–¹æ³• __call__ã€‚
- å…¶å®å°±æ˜¯å¯¹è±¡åç§°åæ¥ï¼ˆï¼‰è¿›è¡Œå‡½æ•°è°ƒç”¨ï¼Œå¯ä»¥ç†è§£ä¸ºç±»ä¼¼é‡è½½æ“ä½œç¬¦ï¼ˆï¼‰
```
import random
class BingoCage:
	def __init__(self, items):
		self._items = list(items)	# æ¥å—ä»»ä½•å¯è¿­ä»£å¯¹è±¡ï¼›åœ¨æœ¬åœ°æ„å»ºä¸€ä¸ªå‰¯æœ¬
		random.shuffle(self._items)
	def pick(self):
		try:
			return self._items.pop()
		except IndexError:	# å¦‚æœ self._items ä¸ºç©ºï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼Œå¹¶è®¾å®šé”™è¯¯æ¶ˆæ¯ã€‚
			raise LookupError('pick from empty BingoCage')
	def __call__(self):
		return self.pick()	# bingo.pick() çš„å¿«æ·æ–¹å¼æ˜¯ bingo()ã€‚

bingo = BingoCage(range(3))
print(bingo.pick())
print(bingo())

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/bbb/src/pyth.py"
0
2
```

# ç»§æ‰¿
## ç®€å•ç»§æ‰¿
```
class A: 
	def hello(self): 
		print("Hello, I'm A.") 
class B(A):
	pass

a = A() 
b = B() 
a.hello() 
b.hello() 

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
Hello, I'm A.
Hello, I'm A.
```
## å¤šç»§æ‰¿
å½“å­ç±»ç»§æ‰¿å¤šä¸ªçˆ¶ç±»æ—¶ï¼Œå¦‚æœåœ¨å¤šä¸ªçˆ¶ç±»ä¸­æœ‰ç›¸åŒçš„æˆå‘˜æ–¹æ³•æˆ–æˆå‘˜å˜é‡ï¼Œåˆ™å­ç±»ä¼˜å…ˆç»§æ‰¿å·¦è¾¹çˆ¶ç±»ä¸­çš„æˆå‘˜æ–¹æ³•æˆ–æˆå‘˜å˜é‡ï¼Œä»å·¦åˆ°å³ç»§æ‰¿çº§åˆ«ä»é«˜åˆ°ä½ã€‚

æ¡ˆä¾‹è§çœ‹æ¼«ç”»å­¦python9.6.2

## æ·»åŠ æ–°æ–¹æ³•
```
class Car():
	def exclaim(self):
		print("I'm a Car!")

class Yugo(Car):
	def exclaim(self):
		print("I'm a Yugo! Much like a Car, but more Yugoï¿¾ish.")
	def need_a_push(self):
		print("A little help here?")

give_me_a_car = Car()
give_me_a_yugo = Yugo()
give_me_a_yugo.need_a_push()
# give_me_a_car.need_a_push()	çˆ¶ç±»æ²¡æœ‰æ­¤æ–¹æ³•ï¼Œä¼šæŠ¥é”™
```

## é‡å†™çˆ¶ç±»æ–¹æ³• override

```
class A: 
	def hello(self): 
		print("Hello, I'm A.") 
class B(A): 
	def hello(self): 	åœ¨å­ç±»ä¸­ï¼Œå¯ä»¥è¦†ç›–ä»»ä½•çˆ¶ç±»çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬ __init__()ï¼Œè§ä¸‹ä¾‹
 		print("Hello, I'm B.") 

a = A() 
b = B() 
a.hello() 
b.hello() 

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
Hello, I'm A.
Hello, I'm B.
```

- å¦‚æœæ²¡æœ‰è¦†ç›–çˆ¶ç±»çš„ __init__() æ–¹æ³•ï¼ŒPython ä¼šè‡ªåŠ¨è°ƒç”¨çˆ¶ç±»çš„åˆå§‹åŒ–å‡½æ•° __init__()
- å¦‚æœå­ç±»é‡å†™äº†initï¼Œåˆ™ä¸ä¼šè‡ªåŠ¨è°ƒç”¨çˆ¶ç±»çš„initï¼Œä½†å¯ä»¥æ‰‹åŠ¨è°ƒç”¨ï¼Œè§superæ¡ˆä¾‹

```
#!/usr/bin/python3
class Person():
	def __init__(self, name):
		self.name = name

class MDPerson(Person):
	def __init__(self, name):
		self.name = "Doctor " + name

class JDPerson(Person):
	def __init__(self, name):
		self.name = name + ", Esquire"

person = Person('Fudd')
doctor = MDPerson('Fudd')
lawyer = JDPerson('Fudd')
print(person.name)
print(doctor.name)
print(lawyer.name)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pyth.py"
Fudd
Doctor Fudd
Fudd, Esquire
```
## è°ƒç”¨çˆ¶ç±»æ–¹æ³• super
æ³¨æ„æ²¡æœ‰super()é‚£å¥åˆ™ä¼šå¤±è´¥ï¼Œå› ä¸ºå­ç±»é‡æ–°å®ç°äº†è‡ªå·±çš„æ„é€ ï¼Œä¸”æœªè°ƒç”¨çˆ¶ç±»æ„é€ ï¼Œæ‰€ä»¥æ²¡æœ‰å¯¹åº”çš„æˆå‘˜hungry
```
class Bird: 
	def __init__(self): 
		self.hungry = True 
	def eat(self): 
		if self.hungry: 
 			print('Aaaah ...') 
 			self.hungry = False 
		else:
 			print('No, thanks!') 
    
class SongBird(Bird): 
	def __init__(self): 
		super().__init__()
		self.sound = 'Squawk!' 
	def sing(self): 
		print(self.sound)

sb = SongBird() 
sb.sing() 
sb.eat() 
sb.eat() 

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
Squawk!
Aaaah ...
No, thanks!
```
å¦ä¸€ä¸ªåœ¨å­ç±»æ„é€ ä¸­è°ƒç”¨çˆ¶ç±»æ„é€ çš„æ¡ˆä¾‹
```
class Person():
	def __init__(self, name):
		self.name = name

class EmailPerson(Person):
	def __init__(self, name, email):
		super().__init__(name)
		self.email = email

bob = EmailPerson('Bob Frapples', 'bob@frapples.com')
print(bob.name)
print(bob.email)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pyth.py"
Bob Frapples
bob@frapples.com
```

## ç»„åˆ
æ¡ˆä¾‹æ¼”ç¤ºäº†ç»„åˆç±»çš„ä½¿ç”¨æ–¹å¼ï¼Œæ±½è½¦çˆ¶ç±»ã€ç”µåŠ¨è½¦å­ç±»ï¼Œå¹¶ä¸”ç”µåŠ¨è½¦ç±»ç»„åˆäº†ç”µæ± ç±»
```
#!/usr/bin/python3

class Car:
	def __init__(self, make, model, year):
		self.make = make
		self.model = model
		self.year = year
		self.odometer_reading = 0

	def get_descriptive_name(self):
		long_name = f"{self.year} {self.make} {self.model}"
		return long_name.title()
	def read_odometer(self):
		print(f"This car has {self.odometer_reading} miles on it.")
	def update_odometer(self, mileage):
		if mileage >= self.odometer_reading:
			self.odometer_reading = mileage
		else:
			print("You can't roll back an odometer!")
	def increment_odometer(self, miles):
		self.odometer_reading += miles

class Battery:
	def __init__(self, battery_size=75):
		self.battery_size = battery_size
	def describe_battery(self):
		print(f"This car has a {self.battery_size}-kWh battery.")
	def get_range(self):
		if self.battery_size == 75:
			range = 260
		elif self.battery_size == 100:
			range = 315
		print(f"This car can go about {range} miles on a full charge.")


class ElectricCar(Car):
	def __init__(self, make, model, year):
		super().__init__(make, model, year)
		self.battery = Battery()
	def describe_battery(self):
		print(f"This car has a {self.battery_size}-kWh battery.")


my_tesla = ElectricCar('tesla', 'model s', 2019)
print(my_tesla.get_descriptive_name())
my_tesla.battery.describe_battery()
my_tesla.battery.get_range()

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
2019 Tesla Model S
This car has a 75-kWh battery.
This car can go about 260 miles on a full charge.

```
å¦ä¸€ä¸ªæ¡ˆä¾‹
```
class Bill():
	def __init__(self, description):
		self.description = description
class Tail():
	def __init__(self, length):
		self.length = length
class Duck():
	def __init__(self, bill, tail):
		self.bill = bill
		self.tail = tail
	def about(self):
		print('This duck has a', self.bill.description, 'bill and a', self.tail.length, 'tail')

tail = Tail('long')
bill = Bill('wide orange')
duck = Duck(bill, tail)
duck.about()

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pyth.py"
This duck has a wide orange bill and a long tail
```
## æ£€æµ‹å­ç±»
- issubclass(class, classinfo) å‡½æ•°çš„ä¸»è¦ä½œç”¨æ˜¯åˆ¤æ–­ç±»æ˜¯å¦ä¸ºå¦ä¸€ä¸ªç±»çš„çš„å­ç±»ï¼Œæ— è®ºæ˜¯ç›´æ¥ã€é—´æ¥ã€è™šæ‹Ÿçš„å­ç±»éƒ½ä¼šTureã€‚ç±»ä¹Ÿæ˜¯è‡ªå·±çš„å­ç±»ã€‚ä¸€ä¸ªç±»å¯ä»¥åŒæ—¶ä¸å¤šä¸ªç±»è¿›è¡Œæ¯”è¾ƒï¼Œåªè¦å…¶ä¸­ä¸€ä¸ªå±äºå…¶çˆ¶ç±»ï¼Œéƒ½ä¼šè¿”å›Trueã€‚
- class - å­ç±»å
- classinfo - å¯¹æ¯”ç±»ï¼ˆä¸€èˆ¬ä¸ºçˆ¶ç±»åŠæ›´æ·±å±‚çš„ç±»åï¼‰ï¼Œå¯¹æ¯”å¤šä¸ªç±»å¯ä»¥ä½¿ç”¨å…ƒç»„å¡«å†™ã€‚
- å¦‚æœclassæ˜¯classinfoçš„å­ç±»ï¼ˆç›´æ¥ã€é—´æ¥æˆ–è™šæ‹Ÿï¼‰ï¼Œåˆ™è¿”å›Trueï¼Œå¦åˆ™è¿”å›Falseã€‚
```
#!/usr/bin/python3

#ç±»æœ¬èº«æ˜¯è‡ªå·±çš„å­ç±»
class A:
    pass
print(issubclass(A, A))

#ç›´æ¥ - Bæ˜¯Açš„å­ç±»ã€‚
class B(A):
    pass
print(issubclass(B, A))

#é—´æ¥ - Cæ˜¯Bçš„å­ç±»ï¼Œè€ŒBæ˜¯Açš„å­ç±»ã€‚æ•…Cä¹ŸåŒæ—¶ç»§æ‰¿äº†Aã€‚
class C(B):
    pass
print(issubclass(C, A))

#è™šæ‹Ÿ - æŠ½è±¡ç±»çš„è™šæ‹Ÿå­ç±»
import abc
class A(abc.ABC):
    @abc.abstractmethod
    def run(self):
        pass
@A.register
class B:
    pass
print(issubclass(B, A))


[huawei@n161 ccc]$ python3 1.py
True
True
True
True
```

# å¤šæ€
## åƒåœ¾å®ç°
è¿™ç§æ–¹å¼æœ‰æ—¶è¢«ç§°ä½œé¸­å­ç±»å‹ï¼ˆduck typingï¼‰ï¼Œè¿™ä¸ªå‘½åæºè‡ªä¸€å¥åè¨€ï¼šå¦‚æœå®ƒåƒé¸­å­ä¸€æ ·èµ°è·¯ï¼Œåƒé¸­å­ä¸€æ ·å«ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸€åªé¸­å­ã€‚

```
#!/usr/bin/python3

class Quote():
	def __init__(self, person, words):
		self.person = person
		self.words = words
	def who(self):
		return self.person
	def says(self):
		return self.words + '.'
class QuestionQuote(Quote):
	def says(self):
		return self.words + '?'
class ExclamationQuote(Quote):
	def says(self):
		return self.words + '!'

hunter = Quote('Elmer Fudd', "I'm hunting wabbits")
print(hunter.who(), 'says:', hunter.says())
hunted1 = QuestionQuote('Bugs Bunny', "What's up, doc")
print(hunted1.who(), 'says:', hunted1.says())
hunted2 = ExclamationQuote('Daffy Duck', "It's rabbit season")
print(hunted2.who(), 'says:', hunted2.says())




class BabblingBrook():
	def who(self):
		return 'Brook'
	def says(self):
		return 'Babble'

def who_says(obj):
		print(obj.who(), 'says', obj.says())

brook = BabblingBrook()
who_says(hunter)
who_says(hunted1)
who_says(hunted2)
who_says(brook)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pyth.py"
Elmer Fudd says: I'm hunting wabbits.
Bugs Bunny says: What's up, doc?
Daffy Duck says: It's rabbit season!
Elmer Fudd says I'm hunting wabbits.
Bugs Bunny says What's up, doc?
Daffy Duck says It's rabbit season!
Brook says Babble

```

# å¼‚å¸¸å¤„ç†

## æŠ›å‡ºå¼‚å¸¸
- ä½¿ç”¨raiseè¯­å¥ï¼Œå¹¶å°†ä¸€ä¸ªç±»ï¼ˆå¿…é¡»æ˜¯Exceptionçš„å­ç±»ï¼‰æˆ–å®ä¾‹ä½œä¸ºå‚æ•°ã€‚
- å°†ç±»ä½œä¸ºå‚æ•°æ—¶ï¼Œå°†è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œæ•è·åˆ°çš„å³æ˜¯æ­¤å¯¹è±¡
```
raise Exception('hyperdrive overload') 
ä¹Ÿå¯ä¸æŒ‡å®šç±»å‹ï¼Œé‚£æ ·ä¸‹é¢çš„ä¿¡æ¯å°±ä¼šå‡å°‘ä¸€äº›


[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
Traceback (most recent call last):
  File "/home/huawei/playground/pythontest/pyth.py", line 2, in <module>
    raise Exception('hyperdrive overload') 
Exception: hyperdrive overload
```

## æ–­è¨€

assertè¯­å¥åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š
- assert å…³é”®å­—ï¼›
- æ¡ä»¶ï¼ˆå³æ±‚å€¼ä¸º True æˆ– False çš„è¡¨è¾¾å¼ï¼‰ï¼›
- é€—å·ï¼›
- å½“æ¡ä»¶ä¸º False æ—¶æ˜¾ç¤ºçš„å­—ç¬¦ä¸²ã€‚
- åœ¨è¿è¡Œ Python æ—¶ä¼ å…¥-O é€‰é¡¹ï¼Œå¯ä»¥ç¦ç”¨æ–­è¨€
```
age = 10 
assert 0 < age < 100 
age = -1 
assert 0 < age < 100, 'The age must be realistic'  # å¯ä»¥è‡ªå®šä¹‰è¾“å‡ºï¼Œå¦åˆ™å°±æ˜¯é»˜è®¤
assert 0 < age < 100 
```

## å¼‚å¸¸ç±»å‹
è§pythonåŸºç¡€æ•™ç¨‹ç¬¬ä¸‰ç‰ˆp133
## è‡ªå®šä¹‰çš„å¼‚å¸¸ç±»
ç»§æ‰¿è‡ªException

class SomeCustomException(Exception): pass 
## tryã€exceptã€elseã€finally
- elseæ˜¯æœªè§¦å‘å¼‚å¸¸çš„è·¯å¾„
- finally å­å¥ä¸­çš„ä»£ç é€šå¸¸ç”¨äºé‡Šæ”¾é‡è¦çš„èµ„æºï¼Œæˆ–è€…è¿˜åŸä¸´æ—¶å˜æ›´çš„çŠ¶æ€
```
#!/usr/bin/python3
filename = 'alice.txt'
try:
	with open(filename, encoding='utf-8') as f:
		contents = f.read()
except FileNotFoundError:
	print(f"Sorry, the file {filename} does not exist.")
else:
	print("loaded")

[huawei@n148 pythontest]$ /usr/bin/python3 "/home/huawei/playground/pythontest/pyth.py"
Sorry, the file alice.txt does not exist.
```
ä¹Ÿå¯ä»¥æœ‰å¤šä¸ªæ•è·
```
try: 
 	x = int(input('Enter the first number: ')) 
	y = int(input('Enter the second number: ')) 
	print(x / y) 
except ZeroDivisionError: 
	print("The second number can't be zero!") 
except TypeError: 
	print("That wasn't a number, was it?") 
```
è¿™æ ·æ›´ç²¾ç®€
```
try: 
	x = int(input('Enter the first number: ')) 
	y = int(input('Enter the second number: ')) 
	print(x / y) 
except (ZeroDivisionError, TypeError, NameError): 
 	print('Your numbers were bogus ...') 
```
å¸¦æœ‰finally
```
#!/usr/bin/python3
try: 
	1 / 0 
except NameError: 
	print("Unknown variable") 
else: 
	print("That went well!") 
finally: 
	print("Cleaning up.") 
```

## ä¸Šä¸‹æ–‡ç®¡ç†å™¨ä¸with
- ä¸Šä¸‹æ–‡ç®¡ç†å™¨åè®®åŒ…å« __enter__ å’Œ __exit__ ä¸¤ä¸ªæ–¹æ³•ã€‚
- with è¯­å¥å¼€å§‹è¿è¡Œæ—¶ï¼Œä¼šåœ¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨å¯¹è±¡ä¸Šè°ƒç”¨ __enter__ æ–¹æ³•ã€‚
- with è¯­å¥è¿è¡Œç»“æŸåï¼Œä¼šåœ¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨å¯¹è±¡ä¸Šè°ƒç”¨ __exit__ æ–¹æ³•
- with è¯­å¥çš„ç›®çš„æ˜¯ç®€åŒ– try/finally æ¨¡å¼ã€‚
- è¿™ç§æ¨¡å¼ç”¨äºä¿è¯ä¸€æ®µä»£ç è¿è¡Œå®Œæ¯•åæ‰§è¡ŒæŸé¡¹æ“ä½œï¼Œå³ä¾¿é‚£æ®µä»£ç ç”±äºå¼‚å¸¸ã€return è¯­å¥æˆ– sys.exit() è°ƒç”¨è€Œä¸­æ­¢ï¼Œä¹Ÿä¼šæ‰§è¡ŒæŒ‡å®šçš„æ“ä½œã€‚

## æ•è·å¯¹è±¡
ä¸‹é¢çš„eå³æ˜¯å¼‚å¸¸å¯¹è±¡
```
try: 
	x = int(input('Enter the first number: ')) 
	y = int(input('Enter the second number: ')) 
	print(x / y) 
except (ZeroDivisionError, TypeError) as e: 
	print(e) 
```
## æ•è·æ‰€æœ‰
- åœ¨exceptè¯­å¥ä¸­ä¸æŒ‡å®šä»»ä½•å¼‚å¸¸ç±»å³å¯
- æ›´å¥½çš„é€‰æ‹©æ˜¯ä½¿ç”¨except Exception as eå¹¶å¯¹å¼‚å¸¸å¯¹è±¡è¿›è¡Œæ£€æŸ¥ã€‚è¿™æ ·åšå°†è®©ä¸æ˜¯ä»Exceptionæ´¾ç”Ÿè€Œæ¥çš„ä¸ºæ•°ä¸å¤šçš„å¼‚å¸¸æˆä¸ºæ¼ç½‘ä¹‹é±¼ï¼Œå…¶ä¸­åŒ…æ‹¬SystemExitå’ŒKeyboardInterruptï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä»BaseExceptionï¼ˆExceptionçš„è¶…ç±»ï¼‰æ´¾ç”Ÿè€Œæ¥çš„ã€‚

```
try: 
	x = int(input('Enter the first number: ')) 
	y = int(input('Enter the second number: ')) 
	print(x / y) 
except: 
	print('Something wrong happened ...') 
```

# æ—¥å¿—

## logging æ¨¡å—

- åˆ›å»º

```
import logging
logging.basicConfig(level=logging.DEBUG, format=' %(asctime)s - %(levelname)s- %(message)s')
logging.debug('Start of program')
def factorial(n):
    logging.debug('Start of factorial(%s%%)' % (n))
    total = 1
    for i in range(n + 1):
        total *= i
        logging.debug('i is ' + str(i) + ', total is ' + str(total))
        logging.debug('End of factorial(%s%%)' % (n))
    return total
print(factorial(5))
logging.debug('End of program')

[huawei@n161 ccc]$ python3 1.py
 2022-10-19 14:25:05,962 - DEBUG- Start of program
 2022-10-19 14:25:05,962 - DEBUG- Start of factorial(5%)
 2022-10-19 14:25:05,962 - DEBUG- i is 0, total is 0
 2022-10-19 14:25:05,962 - DEBUG- End of factorial(5%)
 2022-10-19 14:25:05,962 - DEBUG- i is 1, total is 0
 2022-10-19 14:25:05,962 - DEBUG- End of factorial(5%)
 2022-10-19 14:25:05,962 - DEBUG- i is 2, total is 0
 2022-10-19 14:25:05,962 - DEBUG- End of factorial(5%)
 2022-10-19 14:25:05,962 - DEBUG- i is 3, total is 0
 2022-10-19 14:25:05,962 - DEBUG- End of factorial(5%)
 2022-10-19 14:25:05,962 - DEBUG- i is 4, total is 0
 2022-10-19 14:25:05,962 - DEBUG- End of factorial(5%)
 2022-10-19 14:25:05,962 - DEBUG- i is 5, total is 0
 2022-10-19 14:25:05,962 - DEBUG- End of factorial(5%)
0
 2022-10-19 14:25:05,962 - DEBUG- End of program
```

- çº§åˆ«è®¾ç½®

```
import logging
logging.basicConfig(level=logging.DEBUG, format=' %(asctime)s - %(levelname)s - %(message)s')
logging.debug('Some debugging details.')
logging.info('The logging module is working.')
logging.warning('An error message is about to be logged.')
logging.error('An error has occurred.')
logging.critical('The program is unable to recover!')

```

- å…³é—­ï¼Œlogging.disable() å°†ç¦ç”¨å®ƒä¹‹åçš„æ‰€æœ‰æ¶ˆæ¯
```
import logging
logging.basicConfig(level=logging.INFO, format=' %(asctime)s - %(levelname)s - %(message)s')
logging.critical('Critical error! Critical error!')
logging.disable(logging.CRITICAL)
logging.critical('Critical error! Critical error!')
logging.error('Error! Error!')
```

- å°†æ—¥å¿—è®°å½•åˆ°æ–‡ä»¶

```
import logging
logging.basicConfig(filename='myProgramLog.txt', level=logging.DEBUG, format=' %(asctime)s - %(levelname)s - %(message)s')
logging.critical('Critical error! Critical error!')
logging.error('Error! Error!')
```

# è¿›ç¨‹
## è¿›ç¨‹ä¿¡æ¯
```
import os
os.getpid()		# å½“å‰Pythonè§£é‡Šå™¨çš„è¿›ç¨‹å·
os.getuid()		# ç”¨æˆ· ID 
os.getgid()		# ç”¨æˆ·ç»„ ID
```
## åˆ›å»ºè¿›ç¨‹
- getoutput
	- åªæ˜¯åœ¨shellä¸­è¿è¡Œå…¶ä»–ç¨‹åºå¹¶è¿”å›è¾“å‡ºï¼ˆæ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºï¼‰
	- å‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥è¡¨ç¤ºä¸€ä¸ªå®Œæ•´çš„shellå‘½ä»¤
	- å¯ä»¥ä½¿ç”¨å‚æ•°ã€ç®¡é“ã€I/O é‡å®šå‘ç­‰
- check_output
	- æ¥å—ä¸€ä¸ªå‘½ä»¤å’Œå‚æ•°åˆ—è¡¨ã€‚
	- é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒè¿”å›çš„ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯å­—èŠ‚ç±»å‹çš„æ ‡å‡†è¾“å‡ºã€‚
	- å¹¶æ²¡æœ‰ä½¿ç”¨ shell
- getstatusoutput
	- å¯ä»¥è·å–é€€å‡ºçŠ¶æ€ï¼Œè¿”å›ä¸€ä¸ªåŒ…å«çŠ¶æ€ç å’Œè¾“å‡ºçš„å…ƒç»„
- call
	- ç¨‹åºçš„è¾“å‡ºä¼šæ‰“å°åˆ°å¯¹åº”çš„stdä¸­ï¼Œåªè¿”å›é€€å‡ºçŠ¶æ€
	- åœ¨ Unix ç±»æ“ä½œç³»ç»Ÿä¸­ï¼Œé€€å‡ºçŠ¶æ€ 0 é€šå¸¸è¡¨ç¤ºè¿è¡ŒæˆåŠŸ
- Popen

```
import subprocess
subprocess.Popen('ps')


ret = subprocess.getoutput('date')
print(ret)	# Thu Sep  8 15:43:03 CST 2022
ret = subprocess.getoutput('date -u | wc')
print(ret)	#       1       6      29
ret = subprocess.check_output(['date', '-u'])	
print(ret)	# b'Thu Sep  8 07:51:23 UTC 2022\n'

ret = subprocess.getstatusoutput('date')
print(ret)	# (0, 'Thu Sep  8 15:53:54 CST 2022')

ä¸‹é¢3ç§æ•ˆæœä¸€æ ·
ret = subprocess.call('date')
ret = subprocess.call('date -u', shell=True)
ret = subprocess.call(['date', '-u'])
print(ret)
```

## ç®€å•å¤šè¿›ç¨‹
```
import multiprocessing
import os
def do_this(what):
	whoami(what)
def whoami(what):
	print("Process %s says: %s" % (os.getpid(), what))

if __name__ == "__main__":
	whoami("I'm the main program")
	for n in range(4):
		p = multiprocessing.Process(target=do_this, args=("I'm function %s" % n,))
		p.start()

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pyth.py"
Process 54726 says: I'm the main program
Process 54727 says: I'm function 0
Process 54728 says: I'm function 1
Process 54729 says: I'm function 2
Process 54730 says: I'm function 3
```

## ç»ˆæ­¢è¿›ç¨‹
- ä½¿ç”¨terminate()ç»ˆæ­¢è¿›ç¨‹
- æ³¨æ„æ²¡æœ‰ç”¨äºçº¿ç¨‹çš„ç»ˆæ­¢æ–¹æ³•ï¼
```
import multiprocessing
import time
import os
def whoami(name):
	print("I'm %s, in process %s" % (name, os.getpid()))
def loopy(name):
	whoami(name)
	start = 1
	stop = 1000000
	for num in range(start, stop):
 		print("\tNumber %s of %s. Honk!" % (num, stop))
 		time.sleep(1)

if __name__ == "__main__":
	whoami("main")
	p = multiprocessing.Process(target=loopy, args=("loopy",))
	p.start()
	time.sleep(5)
	p.terminate()


[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pyth.py"
I'm main, in process 54825
I'm loopy, in process 54826
        Number 1 of 1000000. Honk!
        Number 2 of 1000000. Honk!
        Number 3 of 1000000. Honk!
        Number 4 of 1000000. Honk!
        Number 5 of 1000000. Honk!
```

## å¤šè¿›ç¨‹å¹¶è¡Œ
![](å¹¶è¡Œ.png)  
å¹¶è¡Œæ˜¯æŒ‡ä¸¤ä¸ªæˆ–è€…å¤šä¸ªäº‹ä»¶åœ¨åŒä¸€æ—¶åˆ»å‘ç”Ÿï¼ŒPython ä¸­çš„è¿›ç¨‹å±äºå¹¶è¡Œï¼Œèƒ½å……åˆ†åˆ©ç”¨è®¡ç®—æœºèµ„æºï¼Œæ•ˆç‡æœ€é«˜ï¼ŒåŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œå ç”¨å¤šä¸ª CPU èµ„æºï¼›  

ä½¿ç”¨multiprocessingçš„JoinableQueueé˜Ÿåˆ—å®ç°
```
import multiprocessing as mp
def washer(dishes, output):
	for dish in dishes:
		print('Washing', dish, 'dish')
		output.put(dish)

def dryer(input):
	while True:
		dish = input.get()
		print('Drying', dish, 'dish')
		input.task_done()

dish_queue = mp.JoinableQueue()
dryer_proc = mp.Process(target=dryer, args=(dish_queue,))
dryer_proc.daemon = True
dryer_proc.start()
dishes = ['salad', 'bread', 'entree', 'dessert']
washer(dishes, dish_queue)
dish_queue.join()


[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pyth.py"
Washing salad dish
Washing bread dish
Washing entree dish
Washing dessert dish
Drying salad dish
Drying bread dish
Drying entree dish
Drying dessert dish
```
## è¿›ç¨‹é”
https://www.codersrc.com/archives/6854.html

## è¿›ç¨‹é—´é€šä¿¡
pythonè¿›ç¨‹é—´å…±äº«æ•°æ®çš„æ–¹å¼æœ‰ï¼šsocketã€æ–‡ä»¶/æ•°æ®åº“ã€å†…å­˜ã€‚å†…å­˜æ–¹å¼å³pythonä¸­å°è£…çš„ç‰¹å®šåŠŸèƒ½çš„ç±»ã€‚pythonçš„è¿›ç¨‹ä¹Ÿæœ‰åŒçº¿ç¨‹ä¸€æ ·çš„Lockï¼Œé¿å…æ“ä½œåŒä¸€å¯¹è±¡æ—¶å‘ç”Ÿè„è¯»ã€‚

### Managerå…±äº«
æ–‡ä»¶myprocess.py
```
import multiprocessing
import time
 
 
class MyProcess(multiprocessing.Process):
    def __init__(self, name, listor, mngList):
        super().__init__()
        self.name = name
        self.listor = listor
        self.mngList = mngList
 
    def run(self):
        self.show()
 
    def show(self):
        while True:
            print("è¿›ç¨‹1 -%s, é»˜è®¤åˆ—è¡¨ï¼š%sï¼Œ\tMngåˆ—è¡¨ï¼š%sï¼Œ%s" % (self.pid, len(self.listor), len(self.mngList), self.name))
            time.sleep(2)  
```
ä¸»æ–‡ä»¶
```
#!/usr/bin/python3

import multiprocessing
import os
import time
from myprocess import MyProcess
 
# è¿›ç¨‹é—´é»˜è®¤ä¸å…±äº«å…¨å±€å˜é‡
globalList = []
# ä½¿ç”¨Managerå®šä¹‰ å¯åœ¨è¿›ç¨‹é—´å…±äº«çš„å…¨å±€å˜é‡
managerList = multiprocessing.Manager().list()
 
 
# å†™æ“ä½œè¿›ç¨‹
def process2():
    while True:
        print("è¿›ç¨‹2 -%sï¼Œé»˜è®¤åˆ—è¡¨ï¼š%sï¼Œ\tMngåˆ—è¡¨ï¼š%s" % (os.getpid(), len(globalList), len(managerList))) # globalListé€’å¢1
        globalList.append(1)  # æ“ä½œå…¨å±€å˜é‡
        managerList.append(1) # æ“ä½œå…¨å±€å˜é‡
        time.sleep(0.5)
 
 
# è¯»æ“ä½œè¿›ç¨‹
def process3():
    while True:
        print("è¿›ç¨‹3 -%sï¼Œé»˜è®¤åˆ—è¡¨ï¼š%sï¼Œ\tMngåˆ—è¡¨ï¼š%s" % (os.getpid(), len(globalList), len(managerList)))  # globalListä¸å˜ï¼Œä¸€ç›´æ˜¯0
        time.sleep(0.5)
 
 
# ä¸»è¿›ç¨‹
def main():
    MyProcess("MyProcess", globalList, managerList).start()
    p1 = multiprocessing.Process(target=process2) # å®šä¹‰ä¸€ä¸ªè¿›ç¨‹
    p2 = multiprocessing.Process(target=process3)
    p1.start() # å¯åŠ¨è¿›ç¨‹
    p2.start()
 
 
if "__main__" == __name__:
    # é»˜è®¤ä¸»è¿›ç¨‹
    print("ä¸»è¿›ç¨‹å¯åŠ¨")
 
    main() # åˆ›å»ºå­è¿›ç¨‹
 
    while True:
        print("ä¸»ç¨‹0 -%sï¼Œé»˜è®¤åˆ—è¡¨ï¼š%sï¼Œ\tMngåˆ—è¡¨ï¼š%s" % (os.getpid(), len(globalList), len(managerList)))
        time.sleep(0.5)  

æ‰§è¡Œåæ˜¯æ­»å¾ªç¯ï¼Œæ‰‹åŠ¨å…³é—­ä¼šå¼‚å¸¸
[huawei@n161 ccc]$ python3 1.py
ä¸»è¿›ç¨‹å¯åŠ¨
ä¸»ç¨‹0 -42173ï¼Œé»˜è®¤åˆ—è¡¨ï¼š0ï¼Œ     Mngåˆ—è¡¨ï¼š0
è¿›ç¨‹1 -42179, é»˜è®¤åˆ—è¡¨ï¼š0ï¼Œ     Mngåˆ—è¡¨ï¼š0ï¼ŒMyProcess
è¿›ç¨‹2 -42180ï¼Œé»˜è®¤åˆ—è¡¨ï¼š0ï¼Œ     Mngåˆ—è¡¨ï¼š0
è¿›ç¨‹3 -42181ï¼Œé»˜è®¤åˆ—è¡¨ï¼š0ï¼Œ     Mngåˆ—è¡¨ï¼š1
ä¸»ç¨‹0 -42173ï¼Œé»˜è®¤åˆ—è¡¨ï¼š0ï¼Œ     Mngåˆ—è¡¨ï¼š1
è¿›ç¨‹2 -42180ï¼Œé»˜è®¤åˆ—è¡¨ï¼š1ï¼Œ     Mngåˆ—è¡¨ï¼š1
è¿›ç¨‹3 -42181ï¼Œé»˜è®¤åˆ—è¡¨ï¼š0ï¼Œ     Mngåˆ—è¡¨ï¼š2
ä¸»ç¨‹0 -42173ï¼Œé»˜è®¤åˆ—è¡¨ï¼š0ï¼Œ     Mngåˆ—è¡¨ï¼š2
è¿›ç¨‹2 -42180ï¼Œé»˜è®¤åˆ—è¡¨ï¼š2ï¼Œ     Mngåˆ—è¡¨ï¼š2
è¿›ç¨‹3 -42181ï¼Œé»˜è®¤åˆ—è¡¨ï¼š0ï¼Œ     Mngåˆ—è¡¨ï¼š3
ä¸»ç¨‹0 -42173ï¼Œé»˜è®¤åˆ—è¡¨ï¼š0ï¼Œ     Mngåˆ—è¡¨ï¼š3
```
### Queue

Queue é˜Ÿåˆ—ä½¿ç”¨ä¸€ä¸ªç®¡é“å’Œå°‘é‡é”å’Œä¿¡å·é‡å®ç°çš„å…±äº«é˜Ÿåˆ—å®ä¾‹ï¼Œå®ƒæ˜¯çº¿ç¨‹å’Œè¿›ç¨‹å®‰å…¨çš„ï¼Œå¸¸è¢«ç”¨äºä¸¤ä¸ªè¿›ç¨‹ä¹‹é—´çš„é€šè®¯ã€‚ä¾‹å¦‚æœ‰ä¸€ä¸ª wirte è¿›ç¨‹è´Ÿè´£å†™æ•°æ®ï¼Œå¦å¤–ä¸€ä¸ª read è¿›ç¨‹è´Ÿè´£è¯»æ•°æ®ã€‚å½“æˆ‘ä»¬éœ€è¦å°†å†™çš„æ•°æ®äº¤ç»™è¯»çš„è¿›ç¨‹æ—¶ï¼Œå¯ä»¥é€šè¿‡ Queue ä½œä¸ºä¸­é—´æ¡¥æ¢ï¼Œå…ˆæŠŠ write è¿›ç¨‹å†™çš„æ•°æ®äº¤ç»™é˜Ÿåˆ—ï¼Œå†ç”±é˜Ÿåˆ—å°†æ•°æ®ä¼ é€’ç»™ read è¿›ç¨‹ã€‚

```
#!/usr/bin/python3

import multiprocessing
import time
 
# é˜Ÿåˆ—ã€‚å…ˆè¿›å…ˆå‡º
queuer = multiprocessing.Queue(maxsize=5)  # å…ƒç´ æ•°é‡ä¸Šé™ã€‚æœ€å¤§é•¿åº¦5
 
# queue.put(item, block=True, timeout=None)æ–¹æ³•å‚æ•°ï¼š
#   itemï¼Œæ”¾å…¥é˜Ÿåˆ—ä¸­çš„æ•°æ®å…ƒç´ ã€‚
#   blockï¼Œå½“é˜Ÿåˆ—ä¸­å…ƒç´ ä¸ªæ•°è¾¾åˆ°ä¸Šé™(queuer.full()è¿”å›true)ï¼Œç»§ç»­å¾€é‡Œæ”¾æ•°æ®æ—¶ï¼š
#       å¦‚æœ block=Falseï¼Œç›´æ¥å¼•å‘queue.Fullå¼‚å¸¸ï¼›æ•ˆæœåŒput_nowait(item)æ–¹æ³•ã€‚
#       å¦‚æœ block=True-é»˜è®¤ï¼Œtimeout=Noneï¼Œåˆ™ä¸€ç›´ç­‰å¾…,ç›´åˆ°å‡ºç°ç©ºä½æ”¾å…¥æ•°æ®ï¼›
#       å¦‚æœ block=Trueï¼Œtimeout=N(æ­£æ•´æ•°)ï¼Œåˆ™ç­‰å¾…Nç§’ã€‚Nç§’åæ²¡å‡ºç°ç©ºä½åˆ™å¼•å‘queue.Fullå¼‚å¸¸ã€‚
#   timeoutï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ã€‚é»˜è®¤Noneã€‚
 
# queue.get(block=True, timeout=None)æ–¹æ³•å‚æ•°ï¼š
#   blockï¼Œå½“é˜Ÿåˆ—ä¸­æ²¡æœ‰æ•°æ®å…ƒç´ (queuer.empty()è¿”å›true)ï¼Œç»§ç»­å–æ•°æ®æ—¶ï¼š
#       å¦‚æœ block=Falseï¼Œç›´æ¥å¼•å‘queue.Emptyå¼‚å¸¸ï¼›
#       å¦‚æœ block=True-é»˜è®¤ï¼Œtimeout=Noneï¼Œåˆ™ä¸€ç›´ç­‰å¾…å‡ºç°æ•°æ®å¯ä»¥å–å‡ºï¼›
#       å¦‚æœ block=Trueï¼Œtimeout=N(æ­£æ•´æ•°)ï¼Œåˆ™ç­‰å¾…Nç§’ï¼ŒNç§’åæ²¡æœ‰æ•°æ®å¯ä¾›å–å‡ºåˆ™å¼•å‘queue.Emptyå¼‚å¸¸ã€‚
#   timeoutï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ã€‚é»˜è®¤None
 
 
def processPut():
    queuer.put(666)
    while True:
        queuer.put("A") 
        time.sleep(2) #  å»¶è¿Ÿ2ç§’
        # print("æ·»åŠ ï¼š%s" %  queuer.qsize()) # Raises NotImplementedError on Mac OSX because of broken sem_getvalue()
        print("æ·»åŠ äº†")
 
 
def processGet():
    element = queuer.get()
    print(element)
    while True:
        ele = queuer.get() # å¦‚æœå·²ç»ç©ºäº†ï¼Œåˆ™é˜»å¡ç­‰å¾…å‡ºç°å¯ç”¨æ•°æ®
        time.sleep(0.2)
        print("å–å‡ºäº†ï¼š%s" % ele) 
 
 
def main():
    putor = multiprocessing.Process(target=processPut)
    getor = multiprocessing.Process(target=processGet)
    putor.start()
    getor.start()
 
 
if "__main__" == __name__:
    main() 


æ˜¯æ­»å¾ªç¯ï¼Œæ‰‹åŠ¨å…³é—­ä¼šå¼‚å¸¸
[huawei@n161 ccc]$ python3 1.py
666
å–å‡ºäº†ï¼šA
æ·»åŠ äº†
å–å‡ºäº†ï¼šA
æ·»åŠ äº†
å–å‡ºäº†ï¼šA
æ·»åŠ äº†
å–å‡ºäº†ï¼šA
æ·»åŠ äº†
å–å‡ºäº†ï¼šA

```
### Pipe

Pipe å’Œ Queue ä¸€æ ·ï¼Œå¯ä»¥ä½œä¸ºè¿›ç¨‹ä¹‹é—´é€šä¿¡çš„é€šé“ã€‚Pipe()å‡½æ•°è¿”å›ä¸¤ä¸ªå¯¹è±¡ conn1 å’Œ conn2 ï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡è¡¨ç¤ºç®¡é“çš„ä¸¤ç«¯ã€‚Pipe()å‡½æ•°æœ‰ä¸€ä¸ªå¯é€‰å‚æ•° duplexï¼Œå‚æ•° duplex çš„é»˜è®¤å€¼ä¸º Trueï¼Œè¡¨ç¤ºè¯¥ç®¡é“æ˜¯åŒå‘çš„ï¼Œå³ä¸¤ä¸ªå¯¹è±¡éƒ½å¯ä»¥å‘é€å’Œæ¥æ”¶æ¶ˆæ¯ã€‚å¦‚æœæŠŠå‚æ•° duplex è®¾ç½®ä¸º False ï¼Œè¡¨ç¤ºè¯¥ç®¡é“æ˜¯å•å‘çš„ï¼Œå³ conn1 åªèƒ½ç”¨äºæ¥æ”¶æ¶ˆæ¯ï¼Œconn2 åªèƒ½ç”¨äºå‘é€æ¶ˆæ¯ã€‚

```
#!/usr/bin/python3

import multiprocessing
import time
 
# ç®¡é“ã€‚è¿›å‡ºéšæ„ä½†æœ‰æ–¹å‘
piper = multiprocessing.Pipe(True)  # Trueï¼šåŒå·¥-åŒæ—¶æ”¶å‘ã€‚Faseï¼šå·¦æ”¶å³å‘ï¼Œä¸¤ä¸ªå£æ˜¯å…ƒç»„ [0]æ¥æ”¶recvï¼Œ[1]å‘é€send
 
def processPut(): 
    for i in ["a", "b", "c", "d"]:
        piper[1].send(i) 
        print("æ·»åŠ äº† ", i)
        time.sleep(2)
 
 
def processGet(): 
    while True:
        ele = piper[0].recv() # å¦‚æœå·²ç»ç©ºäº†ï¼Œåˆ™é˜»å¡ç­‰å¾…å‡ºç°å¯ç”¨æ•°æ® 
        print("å–å‡ºäº†ï¼š", ele) 
        # time.sleep(3)
 
 
def main():
    putor = multiprocessing.Process(target=processPut)
    getor = multiprocessing.Process(target=processGet)
    putor.start()
    getor.start()
 
    putor.join()       # æ‰§è¡Œsendæ—¶é˜»å¡ç®¡é“ï¼Œä½¿recvæ–¹æ³•ç­‰å¾…æ‰§è¡Œ
    getor.terminate() # å¾ªç¯sendå®Œæ¯•ï¼Œç®¡é“é‡Šæ”¾ã€‚recvå–ä¸åˆ°æ•°æ®æ—¶ï¼Œè‡ªåŠ¨ç»“æŸ
 
 
if "__main__" == __name__:
    main()  

[huawei@n161 ccc]$ python3 1.py
æ·»åŠ äº†  a
å–å‡ºäº†ï¼š a
æ·»åŠ äº†  b
å–å‡ºäº†ï¼š b
æ·»åŠ äº†  c
å–å‡ºäº†ï¼š c
æ·»åŠ äº†  d
å–å‡ºäº†ï¼š d
```

### Lock
ç”±äºå¤šçº¿ç¨‹å…±äº«è¿›ç¨‹çš„èµ„æºå’Œåœ°å€ç©ºé—´ï¼Œå› æ­¤ï¼Œåœ¨å¯¹è¿™äº›å…¬å…±èµ„æºè¿›è¡Œæ“ä½œæ—¶ï¼Œä¸ºäº†é˜²æ­¢è¿™äº›å…¬å…±èµ„æºå‡ºç°å¼‚å¸¸çš„ç»“æœï¼Œå¿…é¡»è€ƒè™‘çº¿ç¨‹çš„åŒæ­¥å’Œäº’æ–¥é—®é¢˜ã€‚ä¸ºäº†ä¿è¯è¿›ç¨‹é—´çš„åŒæ­¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Lock ç±»ç»™çº¿ç¨‹æˆ–è€…è¿›ç¨‹åŠ é”ã€‚Lock è¿”å›çš„æ˜¯ä¸€ä¸ªéé€’å½’é”å¯¹è±¡ï¼ŒLock å®é™…ä¸Šæ˜¯ä¸€ä¸ªå·¥å‚å‡½æ•°ã€‚å®ƒè¿”å›ç”±é»˜è®¤ä¸Šä¸‹æ–‡åˆå§‹åŒ–çš„ multiprocessing.synchronize.Lock å¯¹è±¡ã€‚ä¸€æ—¦æŸä¸€ä¸ªè¿›ç¨‹æˆ–è€…çº¿ç¨‹æ‹¿åˆ°äº†é”ï¼Œåç»­çš„ä»»ä½•å…¶ä»–è¿›ç¨‹æˆ–çº¿ç¨‹çš„å…¶ä»–è¯·æ±‚éƒ½ä¼šè¢«é˜»å¡ç›´åˆ°é”è¢«é‡Šæ”¾ã€‚

```
#!/usr/bin/python3
from multiprocessing import Process, Lock
def f(l, i):
    l.acquire()
    try:
        print('this is', i)
    finally:
        l.release()

if __name__ == '__main__':
    lock = Lock()

    for num in range(10):
        Process(target=f, args=(lock, num)).start()

[huawei@n161 ccc]$ python3 1.py
this is 0
this is 1
this is 2
this is 3
this is 4
this is 5
this is 6
this is 7
this is 8
this is 9
```

# çº¿ç¨‹
## å•çº¿ç¨‹æ¡ˆä¾‹
```
import _thread
import time
from datetime import datetime

def Test(name):
    for i in range(3):
        print(name,datetime.now())
        time.sleep(1)
def main():
    Test("one")
    Test("two")

if __name__=='__main__':
    start=time.time()
    main()
    end=time.time()
    print("è¿è¡Œç¨‹åºèŠ±è´¹äº†%sç§’"%(end-start))


[huawei@n161 ccc]$ python3 1.py
one 2022-10-10 13:50:21.213282
one 2022-10-10 13:50:22.214364
one 2022-10-10 13:50:23.215710
two 2022-10-10 13:50:24.217094
two 2022-10-10 13:50:25.218867
two 2022-10-10 13:50:26.220392
è¿è¡Œç¨‹åºèŠ±è´¹äº†6.008822202682495ç§’
```

## threading

### çº¿ç¨‹å‡½æ•°æ–¹å¼
ä½¿ç”¨ threading æ¨¡å—ä¸­ Thread ç±»çš„æ„é€ å™¨åˆ›å»ºçº¿ç¨‹ï¼Œå³ç›´æ¥å¯¹ç±» threading.Thread è¿›è¡Œå®ä¾‹åŒ–ï¼Œå¹¶è°ƒç”¨å®ä¾‹åŒ–å¯¹è±¡çš„ start æ–¹æ³•åˆ›å»ºçº¿ç¨‹ã€‚è°ƒç”¨ threading.Thread ç±»çš„å¦‚ä¸‹æ„é€ å™¨åˆ›å»ºçº¿ç¨‹ï¼š  

    threading.Thread(group=None, target=None, name=None, args=(), kwargs={}, *, daemon=None)

- Threadå‡½æ•°çš„targetå‚æ•°æŒ‡å‘çº¿ç¨‹ä½“å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰è¯¥çº¿ç¨‹ä½“å‡½æ•°ï¼›é€šè¿‡nameå‚æ•°å¯ä»¥è®¾ç½®çº¿ç¨‹åï¼Œå¦‚æœçœç•¥è¿™ä¸ªå‚æ•°ï¼Œåˆ™ç³»ç»Ÿä¼šä¸ºå…¶åˆ†é…ä¸€ä¸ªåç§°ï¼›argsæ˜¯ä¸ºçº¿ç¨‹ä½“å‡½æ•°æä¾›çš„å‚æ•°ï¼Œæ˜¯ä¸€ä¸ªå…ƒç»„ç±»å‹ã€‚
- groupï¼šæŒ‡å®šè¯¥çº¿ç¨‹æ‰€å±çš„çº¿ç¨‹ç»„ï¼Œç›®å‰è¯¥å‚æ•°è¿˜æœªå®ç°ï¼Œä¸ºäº†æ—¥åæ‰©å±• ThreadGroup ç±»å®ç°è€Œä¿ç•™ã€‚
- targetï¼šç”¨äº run() æ–¹æ³•è°ƒç”¨çš„å¯è°ƒç”¨å¯¹è±¡ï¼Œé»˜è®¤æ˜¯ Noneï¼Œè¡¨ç¤ºä¸éœ€è¦è°ƒç”¨ä»»ä½•æ–¹æ³•ã€‚
- argsï¼šæ˜¯ç”¨äºè°ƒç”¨ç›®æ ‡å‡½æ•°çš„å‚æ•°å…ƒç»„ï¼Œé»˜è®¤æ˜¯ ()ã€‚
- kwargsï¼šæ˜¯ç”¨äºè°ƒç”¨ç›®æ ‡å‡½æ•°çš„å…³é”®å­—å‚æ•°å­—å…¸ï¼Œé»˜è®¤æ˜¯ {}ã€‚
- daemonï¼šå¦‚æœ daemon ä¸æ˜¯ Noneï¼Œçº¿ç¨‹å°†è¢«æ˜¾å¼çš„è®¾ç½®ä¸ºå®ˆæŠ¤æ¨¡å¼ï¼Œä¸ç®¡è¯¥çº¿ç¨‹æ˜¯å¦æ˜¯å®ˆæŠ¤æ¨¡å¼ï¼Œå¦‚æœæ˜¯ None (é»˜è®¤å€¼)ï¼Œçº¿ç¨‹å°†ç»§æ‰¿å½“å‰çº¿ç¨‹çš„å®ˆæŠ¤æ¨¡å¼å±æ€§ã€‚


threading.Thread å®ä¾‹çš„æ–¹æ³•ã€å±æ€§
- start()	å¯åŠ¨çº¿ç¨‹æ´»åŠ¨ï¼Œå®ƒåœ¨ä¸€ä¸ªçº¿ç¨‹é‡Œæœ€å¤šåªèƒ½è¢«è°ƒç”¨ä¸€æ¬¡ã€‚
- run()	è¡¨ç¤ºçº¿ç¨‹æ´»åŠ¨çš„æ–¹æ³•ã€‚
- join(timeout=None)	ç­‰å¾…è‡³çº¿ç¨‹ä¸­æ­¢ã€‚
- getName()	è¿”å›çº¿ç¨‹åã€‚
- setName()	è®¾ç½®çº¿ç¨‹åã€‚
- is_alive()	è¿”å›çº¿ç¨‹æ˜¯å¦æ˜¯æ´»åŠ¨çš„ã€‚
- daemon	æ˜¯å¦ä¸ºå®ˆæŠ¤çº¿ç¨‹çš„æ ‡å¿—ã€‚
- ident	çº¿ç¨‹æ ‡è¯†ç¬¦ï¼Œçº¿ç¨‹å°šæœªå¼€å§‹è¿”å› Noneï¼Œå·²å¯åŠ¨è¿”å›éé›¶æ•´æ•°ã€‚


```
import time
import threading
def work(num):
    print('çº¿ç¨‹åç§°ï¼š',threading.current_thread().getName(),'å‚æ•°ï¼š',num,'å¼€å§‹æ—¶é—´ï¼š',time.strftime('%Y-%m-%d %H:%M:%S'))
if __name__ == '__main__':
    print('ä¸»çº¿ç¨‹å¼€å§‹æ—¶é—´ï¼š',time.strftime('%Y-%m-%d %H:%M:%S'))
    t1 = threading.Thread(target=work,args=(3,))
    t2 = threading.Thread(target=work,args=(2,))
    t3 = threading.Thread(target=work,args=(1,))
    t1.start()
    t2.start()
    t3.start()
    t1.join()
    t2.join()
    t3.join()
    print('ä¸»çº¿ç¨‹ç»“æŸæ—¶é—´ï¼š', time.strftime('%Y-%m-%d %H:%M:%S'))


[huawei@n161 ccc]$ python3 1.py
ä¸»çº¿ç¨‹å¼€å§‹æ—¶é—´ï¼š 2022-10-13 14:00:54
çº¿ç¨‹åç§°ï¼š Thread-1 å‚æ•°ï¼š 3 å¼€å§‹æ—¶é—´ï¼š 2022-10-13 14:00:54
çº¿ç¨‹åç§°ï¼š Thread-2 å‚æ•°ï¼š 2 å¼€å§‹æ—¶é—´ï¼š 2022-10-13 14:00:54
çº¿ç¨‹åç§°ï¼š Thread-3 å‚æ•°ï¼š 1 å¼€å§‹æ—¶é—´ï¼š 2022-10-13 14:00:54
ä¸»çº¿ç¨‹ç»“æŸæ—¶é—´ï¼š 2022-10-13 14:00:54
```

å¦ä¸€ä¸ªæ¡ˆä¾‹

```
#!/usr/bin/python3
import threading
import time
from datetime import datetime

def Test(name):
    for i in range(3):
        print(name,datetime.now())
        time.sleep(1)
def main():
        t1=threading.Thread(target=Test,args=("one",))  #è°ƒç”¨threading.Threadå‡½æ•°ï¼Œtargetå‚æ•°æ˜¯è¦æ‰§è¡Œçš„å‡½æ•°ï¼Œargsæ˜¯è¦ä¼ å…¥çš„å‚æ•°ï¼Œä¸ºå…ƒç»„ç±»å‹
        t2=threading.Thread(target=Test,args=("two",))
        t1.start()        #å¯åŠ¨çº¿ç¨‹
        t2.start()
        t1.join()       #å¿…é¡»ç­‰å­çº¿ç¨‹è¿è¡Œå®Œäº†çˆ¶çº¿ç¨‹æ‰å¯ä»¥è¿è¡Œ
        t2.join()
if __name__=='__main__':
    start=time.time()
    main()
    end=time.time()
    print("è¿è¡Œç¨‹åºèŠ±è´¹äº†%sç§’"%(end-start))


[huawei@n161 ccc]$ python3 1.py
one 2022-10-10 14:05:59.340984
two 2022-10-10 14:05:59.341188
two 2022-10-10 14:06:00.342355
one 2022-10-10 14:06:00.342422
two 2022-10-10 14:06:01.343655
one 2022-10-10 14:06:01.343718
è¿è¡Œç¨‹åºèŠ±è´¹äº†3.0045223236083984ç§’
```

å¦ä¸€ä¸ªæ¡ˆä¾‹

```
import threading
def do_this(what):
	whoami(what)
def whoami(what):
	print("Thread %s says: %s" % (threading.current_thread(), what))

if __name__ == "__main__":
	whoami("I'm the main program")
	for n in range(4):
 		p = threading.Thread(target=do_this, args=("I'm function %s" % n,))
 		p.start()

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pyth.py"
Thread <_MainThread(MainThread, started 140689071798080)> says: I'm the main program
Thread <Thread(Thread-1, started 140688941364992)> says: I'm function 0
Thread <Thread(Thread-2, started 140688932972288)> says: I'm function 1
Thread <Thread(Thread-3, started 140688924579584)> says: I'm function 2
Thread <Thread(Thread-4, started 140688916186880)> says: I'm function 3
```



```
# å¯¼å…¥çº¿ç¨‹threadingæ¨¡å—
import threading
# å¯¼å…¥å†…ç½®æ¨¡å—time
import time

def wash_clothes(*args,**kargcs):
    time.sleep(2)
    print("wash_clothes:",args)
    time.sleep(2)
    print("wash_clothes:", kargcs)

def clean_room(*args,**kargcs):
    time.sleep(2)
    print("clean_room:",args)
    time.sleep(2)
    print("clean_room:", kargcs)

if __name__ == "__main__":
        # args ä¼ é€’å…ƒç»„ï¼Œå¯ä»¥åŒæ—¶ä¼ é€’å¤šä¸ªæ•°æ®
        # kwargs ä¼ é€’å­—å…¸ï¼Œå¯ä»¥åŒæ—¶ä¼ é€’å¤šä¸ªé”®å€¼å¯¹
    t1 = threading.Thread(target=wash_clothes,args=(1,"çŒ¿è¯´python"),kwargs={"a":1,"b":False})
    t2 = threading.Thread(target=clean_room,args=(2,False),kwargs={"c":0.2,"d":False})
    # setDaemon(True)æ„å‘³ç€ä¸»çº¿ç¨‹é€€å‡ºï¼Œä¸ç®¡å­çº¿ç¨‹æ‰§è¡Œåˆ°å“ªä¸€æ­¥ï¼Œå­çº¿ç¨‹è‡ªåŠ¨ç»“æŸ
    # t1.setDaemon(True)
    # t2.setDaemon(True)
    t1.start()
    t2.start()
    print("threading.enumerate():",threading.enumerate())
    print("threading.activeCount():", threading.activeCount())
    print("t1.isAlive():",t1.isAlive())
    print("t1.getName():", t1.getName())
    print("t2.isAlive():", t2.isAlive())
    t2.setName("my_custom_thread_2")
    print("t2.getName():", t2.getName())

[huawei@n161 ccc]$ python3 1.py
threading.enumerate(): [<_MainThread(MainThread, started 139909790644032)>, <Thread(Thread-1, started 139909660210944)>, <Thread(Thread-2, started 139909651818240)>]
threading.activeCount(): 3
t1.isAlive(): True
t1.getName(): Thread-1
t2.isAlive(): True
t2.getName(): my_custom_thread_2
wash_clothes: (1, 'çŒ¿è¯´python')
clean_room: (2, False)
wash_clothes: {'a': 1, 'b': False}
clean_room: {'c': 0.2, 'd': False}
```

### çº¿ç¨‹ç±»æ–¹å¼
ç»§æ‰¿ threading æ¨¡å—ä¸­çš„ Thread ç±»åˆ›å»ºçº¿ç¨‹ç±»ï¼Œå³ç”¨ threading.Thread æ´¾ç”Ÿå‡ºä¸€ä¸ªæ–°çš„å­ç±»ï¼Œå°†æ–°å»ºç±»å®ä¾‹åŒ–ï¼Œå¹¶è°ƒç”¨å…¶ start æ–¹æ³•åˆ›å»ºçº¿ç¨‹ã€‚

threading ç›´æ¥è°ƒç”¨çš„æ–¹æ³•ï¼š
- active_count()	è¿”å›å½“å‰å­˜æ´»çš„çº¿ç¨‹ç±» Thread å¯¹è±¡ï¼Œè¿”å›ä¸ªæ•°ç­‰äº enumerate() è¿”å›çš„åˆ—è¡¨é•¿åº¦ã€‚
- current_thread()	è¿”å›å½“å‰å¯¹åº”è°ƒç”¨è€…çš„ Thread å¯¹è±¡ã€‚
- get_ident()	è¿”å›å½“å‰çº¿ç¨‹çš„çº¿ç¨‹æ ‡è¯†ç¬¦ï¼Œå®ƒæ˜¯ä¸€ä¸ªéé›¶çš„æ•´æ•°ã€‚
- enumerate()	ä»¥åˆ—è¡¨å½¢å¼è¿”å›å½“å‰æ‰€æœ‰å­˜æ´»çš„ Thread å¯¹è±¡ã€‚
- main_thread()	è¿”å›ä¸» Thread å¯¹è±¡ã€‚
- settrace(func)	ä¸ºæ‰€æœ‰ threading æ¨¡å—å¼€å§‹çš„çº¿ç¨‹è®¾ç½®è¿½è¸ªå‡½æ•°ã€‚
- setprofile(func)	ä¸ºæ‰€æœ‰ threading æ¨¡å—å¼€å§‹çš„çº¿ç¨‹è®¾ç½®æ€§èƒ½æµ‹è¯•å‡½æ•°ã€‚
- stack_size([size])	è¿”å›åˆ›å»ºçº¿ç¨‹æ—¶ç”¨çš„å †æ ˆå¤§å°ã€‚

```
import time
import threading
class MyThread(threading.Thread):
    def __init__(self,num):
        super().__init__()
        self.num = num
    def run(self):
        print('çº¿ç¨‹åç§°ï¼š', threading.current_thread().getName(), 'å‚æ•°ï¼š', self.num, 'å¼€å§‹æ—¶é—´ï¼š', time.strftime('%Y-%m-%d %H:%M:%S'))
if __name__ == '__main__':
    print('ä¸»çº¿ç¨‹å¼€å§‹æ—¶é—´ï¼š',time.strftime('%Y-%m-%d %H:%M:%S'))
    t1 = MyThread(3)
    t2 = MyThread(2)
    t3 = MyThread(1)
    t1.start()
    t2.start()
    t3.start()
    t1.join()
    t2.join()
    t3.join()
    print('ä¸»çº¿ç¨‹ç»“æŸæ—¶é—´ï¼š', time.strftime('%Y-%m-%d %H:%M:%S'))
```

å¦ä¸€ä¸ªæ¡ˆä¾‹ï¼Œé€šè¿‡åˆ›å»ºä¸€ä¸ªå­ç±»ç»§æ‰¿äº threading.Thread ï¼Œå¹¶å®ä¾‹åŒ–åè°ƒç”¨ start() æ–¹æ³•å¯åŠ¨æ–°çº¿ç¨‹ï¼Œå³å®ƒè°ƒç”¨äº†çº¿ç¨‹çš„ run() æ–¹æ³•ã€‚è¿™é‡Œä½¿ç”¨äº† join()æ–¹æ³•æ¥é˜»å¡çˆ¶çº¿ç¨‹ï¼Œè®©å…¶ç­‰å¾…å­çº¿ç¨‹è¿è¡Œå®Œå†è¿è¡Œï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæœ€åèŠ±è´¹äº†ï¼“ç§’çš„æ—¶é—´ï¼Œæ˜¯[å•çº¿ç¨‹æ¡ˆä¾‹](#å•çº¿ç¨‹æ¡ˆä¾‹)çš„ä¸€åŠã€‚

```
#!/usr/bin/python3
import threading
import time
from datetime import datetime

class myThread(threading.Thread):
    def __init__(self,name):
        threading.Thread.__init__(self)
        self.name=name
    def run(self):
        for i in range(3):
            print(self.name,datetime.now())
            time.sleep(1)
def main():
    thread1=myThread("one ")
    thread2=myThread("two ")
    thread1.start()           #å¯åŠ¨çº¿ç¨‹ï¼Œä»£ç”¨äº†è¯¥çº¿ç¨‹çš„ run() æ–¹æ³•
    thread2.start()
    thread1.join()       #å¿…é¡»ç­‰å­çº¿ç¨‹è¿è¡Œå®Œäº†çˆ¶çº¿ç¨‹æ‰å¯ä»¥è¿è¡Œ
    thread2.join()   
if __name__=='__main__':
    start=time.time()
    main()
    end=time.time()
    print("è¿è¡Œç¨‹åºèŠ±è´¹äº†%sç§’"%(end-start))


[huawei@n161 ccc]$ python3 1.py
one  2022-10-10 14:00:31.487769
two  2022-10-10 14:00:31.487972
two  2022-10-10 14:00:32.488338
one  2022-10-10 14:00:32.489280
two  2022-10-10 14:00:33.489747
one  2022-10-10 14:00:33.490600
è¿è¡Œç¨‹åºèŠ±è´¹äº†3.004295587539673ç§’
```

### å®ˆæŠ¤çº¿ç¨‹
å®ˆæŠ¤çº¿ç¨‹ï¼ˆä¹Ÿç§°åå°çº¿ç¨‹ï¼‰æ˜¯åœ¨åå°è¿è¡Œçš„ï¼Œå®ƒçš„ä»»åŠ¡æ˜¯ä¸ºå…¶ä»–çº¿ç¨‹æä¾›æœåŠ¡ï¼Œå¦‚ Python è§£é‡Šå™¨çš„åƒåœ¾å›æ”¶çº¿ç¨‹å°±æ˜¯å®ˆæŠ¤çº¿ç¨‹ã€‚å¦‚æœæ‰€æœ‰çš„å‰å°çº¿ç¨‹éƒ½æ­»äº¡äº†ï¼Œå®ˆæŠ¤çº¿ç¨‹ä¹Ÿä¼šè‡ªåŠ¨æ­»äº¡ã€‚

å¦‚æœä½ è®¾ç½®ä¸€ä¸ªçº¿ç¨‹ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œå°±è¡¨ç¤ºè¿™ä¸ªçº¿ç¨‹æ˜¯ä¸é‡è¦çš„ï¼Œåœ¨è¿›ç¨‹é€€å‡ºçš„æ—¶å€™ï¼Œä¸ç”¨ç­‰å¾…è¿™ä¸ªçº¿ç¨‹é€€å‡ºï¼›å¦‚æœä½ çš„ä¸»çº¿ç¨‹åœ¨é€€å‡ºçš„æ—¶å€™ï¼Œä¸ç”¨ç­‰å¾…å“ªäº›å­çº¿ç¨‹å®Œæˆï¼Œé‚£å°±è®¾ç½®è¿™äº›çº¿ç¨‹ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼›å¦‚æœä½ æƒ³ç­‰å¾…å­çº¿ç¨‹å®Œæˆåå†é€€å‡ºï¼Œé‚£å°±ä»€ä¹ˆéƒ½ä¸ç”¨åšï¼Œæˆ–è€…æ˜¾ç¤ºåœ°å°† daemon å±æ€§è®¾ç½®ä¸º falseã€‚

ä½¿ç”¨äº†å®ˆæŠ¤çº¿ç¨‹çš„ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¼”ç¤º
```
join() å‡½æ•°æ˜¯é˜»å¡çš„ã€‚å½“æ¶ˆè´¹è€…é€šè¿‡ get() ä»é˜Ÿåˆ—è·å–ä¸€é¡¹ä»»åŠ¡å¹¶å¤„ç†å®Œæˆä¹‹åï¼Œéœ€è¦è°ƒç”¨ä¸”åªå¯ä»¥è°ƒç”¨ä¸€æ¬¡ task_done()ï¼Œè¯¥æ–¹æ³•ä¼šç»™é˜Ÿåˆ—å‘é€ä¸€ä¸ªä¿¡å·ï¼Œjoin()å‡½æ•°åˆ™åœ¨ç›‘å¬è¿™ä¸ªä¿¡å·ã€‚å¯ä»¥ç®€å•ç†è§£ä¸ºé˜Ÿåˆ—å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªè®¡æ•°å™¨ï¼Œè¯¥è®¡æ•°å™¨æ ‡è¯†æœªå®Œæˆçš„ä»»åŠ¡æ•°ï¼Œæ¯å½“æ·»åŠ ä»»åŠ¡æ—¶ï¼Œè®¡æ•°å™¨ä¼šå¢åŠ ï¼Œè°ƒç”¨ task_done()æ—¶è®¡æ•°å™¨åˆ™ä¼šå‡å°‘ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸ºç©ºã€‚è€Œ join() å°±æ˜¯åœ¨ç›‘å¬é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºï¼Œä¸€æ—¦æ¡ä»¶æ»¡è¶³åˆ™ç»“æŸé˜»å¡çŠ¶æ€ã€‚


from queue import Queue
from threading import Thread

class Producer(Thread):
    def __init__(self, q):
        super().__init__()
        self.count = 5
        self.q = q

    def run(self):
        while self.count > 0:
            print("ç”Ÿäº§")
            if self.count == 1:
                self.count -= 1
                self.q.put(2)
            else:
                self.count -= 1
                self.q.put(1)


class Consumer(Thread):

    def __init__(self, q):
        super().__init__()
        self.q = q

    def run(self):
        while True:
            print("æ¶ˆè´¹")
            data = self.q.get()
            if data == 2:
                print("stop because data=", data)
                # ä»»åŠ¡å®Œæˆï¼Œä»é˜Ÿåˆ—ä¸­æ¸…é™¤ä¸€ä¸ªå…ƒç´ 
                self.q.task_done()
                break
            else:
                print("data is good,data=", data)
                # ä»»åŠ¡å®Œæˆï¼Œä»é˜Ÿåˆ—ä¸­æ¸…é™¤ä¸€ä¸ªå…ƒç´ 
                self.q.task_done()

if __name__ == '__main__':
    q = Queue()
    p = Producer(q)
    c = Consumer(q)
    p.setDaemon(True)
    c.setDaemon(True)
    p.start()
    c.start()
    # ç­‰å¾…é˜Ÿåˆ—æ¸…ç©º
    p.join()
    c.join()
    print("queue is complete")
```

### TLS çº¿ç¨‹å±€éƒ¨å­˜å‚¨

Python çš„ threading æ¨¡å—æä¾›äº† local æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›å¾—åˆ°ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œä¸åŒçº¿ç¨‹ä½¿ç”¨è¿™ä¸ªå¯¹è±¡å­˜å‚¨çš„æ•°æ®ï¼Œå…¶å®ƒçº¿ç¨‹æ˜¯ä¸å¯è§çš„(æœ¬è´¨ä¸Šå°±æ˜¯ä¸åŒçš„çº¿ç¨‹ä½¿ç”¨è¿™ä¸ªå¯¹è±¡æ—¶ä¸ºå…¶åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„å­—å…¸)

```
num æ˜¯å…¨å±€å˜é‡ï¼Œä½†æ¯ä¸ªçº¿ç¨‹å®šä¹‰çš„å±æ€§ num.x æ˜¯å„è‡ªçº¿ç¨‹ç‹¬æœ‰çš„ï¼Œå…¶å®ƒçº¿ç¨‹æ˜¯ä¸å¯è§çš„ï¼Œå› æ­¤æ¯ä¸ªçº¿ç¨‹çš„è®¡ç®—ç»“æœæœªå‡ºç°ç›¸äº’å¹²æ‰°çš„æƒ…å†µã€‚

import threading
import time

# ä½¿ç”¨ threading.local
num = threading.local()
def work():
    num.x = 0
    for i in range(10):
        num.x += 1
    print(threading.current_thread().getName(), num.x)
    time.sleep(0.0001)
for i in range(5):
    threading.Thread(target=work).start()

[huawei@n161 ccc]$ python3 1.py
Thread-1 10
Thread-2 10
Thread-3 10
Thread-4 10
Thread-5 10
```

## å¹¶å‘
![](å¹¶å‘.png)  
å¹¶å‘æ˜¯æŒ‡ä¸¤ä¸ªæˆ–å¤šä¸ªäº‹ä»¶åœ¨åŒä¸€æ—¶é—´é—´éš”å‘ç”Ÿï¼ŒPython ä¸­çš„çº¿ç¨‹å±äºå¹¶å‘ï¼Œä¸ç®¡è®¡ç®—æœºæœ‰å¤šå°‘ä¸ª CPU ï¼Œä¸ç®¡ä½ å¼€äº†å¤šå°‘ä¸ªçº¿ç¨‹ï¼ŒåŒä¸€æ—¶é—´å¤šä¸ªä»»åŠ¡ä¼šåœ¨å…¶ä¸­ä¸€ä¸ª CPU æ¥å›åˆ‡æ¢ï¼Œåªå ç”¨ä¸€ä¸ª CPU ï¼Œæ•ˆç‡å¹¶ä¸é«˜ï¼›

### Lock
    äº’æ–¥é” Lock ä¸»è¦é’ˆå¯¹å¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œåŒä¸€ä¸ªæ•°æ®ï¼ˆå³å¹¶è¡Œè®¿é—®å…±äº«èµ„æºï¼‰ï¼Œä½¿ç”¨äº’æ–¥é”å¯ä»¥ä¿è¯ä¿æŠ¤å…±äº«èµ„æºï¼Œé˜²æ­¢å‡ºç°è„æ•°æ®ã€‚
    äº’æ–¥é”å°±å¥½æ¯”æ’é˜Ÿä¸Šå•æ‰€ï¼Œä¸€ä¸ªå‘ä½åªèƒ½è¹²ä¸€ä¸ªäººï¼Œåªæœ‰å ç”¨å‘ä½çš„äººå®Œäº‹äº†ï¼Œå¦å¤–ä¸€ä¸ªäººæ‰èƒ½ä¸Šï¼
Lockæ˜¯å¯ç”¨çš„æœ€ä½çº§çš„åŒæ­¥æŒ‡ä»¤ã€‚Lockå¤„äºé”å®šçŠ¶æ€æ—¶ï¼Œä¸è¢«ç‰¹å®šçš„çº¿ç¨‹æ‹¥æœ‰ã€‚LockåŒ…å«ä¸¤ç§çŠ¶æ€ï¼šé”å®šå’Œéé”å®šï¼Œä»¥åŠä¸¤ä¸ªåŸºæœ¬çš„æ–¹æ³•ï¼š
- acquire([timeout]): ä½¿çº¿ç¨‹è¿›å…¥åŒæ­¥é˜»å¡çŠ¶æ€ï¼Œå°è¯•è·å¾—é”å®šã€‚
- release(): é‡Šæ”¾é”ã€‚ä½¿ç”¨å‰çº¿ç¨‹å¿…é¡»å·²è·å¾—é”å®šï¼Œå¦åˆ™å°†æŠ›å‡ºå¼‚å¸¸ã€‚


ä¸‹é¢çš„æ¡ˆä¾‹å¦‚æœæ²¡æœ‰ä½¿ç”¨lockåˆ™å¾—åˆ°çš„ä¸æ˜¯0
```
import threading
num = 0

def add(lock):
    global num
    for i in range(1000000):
        lock.acquire()
        num += 1
        lock.release()

def reduce(lock):
    global num
    for i in range(1000000):
        lock.acquire()
        num -= 1
        lock.release()

# åˆ›å»ºé”
lock = threading.Lock()
# åˆ›å»ºçº¿ç¨‹
t1 = threading.Thread(target=add, args=(lock, ))
t2 = threading.Thread(target=reduce, args=(lock, ))
t1.start()
t2.start()
# ç­‰å¾…å­è¿›ç¨‹æ‰§è¡Œå®Œ
t1.join()
t2.join()
print(num)

[huawei@n161 ccc]$ python3 1.py
0
```
å¦ä¸€ä¸ªæ¡ˆä¾‹ï¼Œç¡®ä¿äº†åŒæ­¥çš„æ“ä½œ
```
import threading
import time

lock = threading.Lock() #åˆ›å»ºé”

def fun(data):
    try:
        lock.acquire(True) #é”å®š
        print("------> fun 1:",time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(time.time())),data)
        time.sleep(1)
        print("------> fun 2:", time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(time.time())),data)
    finally:
        lock.release()#é‡Šæ”¾
        # lock.release() è¿™é‡Œå¦‚å¤šæ¬¡é‡Šæ”¾ä¼šå´©æºƒï¼Œæ‰€ä»¥è¦æ ¹æ®å®é™…æƒ…å†µä½¿ç”¨æ­¤ç±»é”

threading.Thread(target = fun, name='socket_tcp_server', kwargs={'data':100}).start()
threading.Thread(target = fun, name='socket_tcp_server', kwargs={'data':200}).start()
threading.Thread(target = fun, name='socket_tcp_server', kwargs={'data':300}).start()
threading.Thread(target = fun, name='socket_tcp_server', kwargs={'data':400}).start()

å¦‚æœæ²¡æœ‰ä¸Šé¢çš„lockæ“ä½œï¼Œåˆ™ä¼šé¦–å…ˆ4ä¸ªfun1ï¼Œåå†4ä¸ªfun2ï¼Œä½¿ç”¨äº†lockåˆ™å¯ç¡®ä¿åŒæ­¥
[huawei@n161 ccc]$ python3 1.py
------> fun 1: 2022-10-10 14:51:38 100
------> fun 2: 2022-10-10 14:51:39 100
------> fun 1: 2022-10-10 14:51:39 200
------> fun 2: 2022-10-10 14:51:40 200
------> fun 1: 2022-10-10 14:51:40 300
------> fun 2: 2022-10-10 14:51:41 300
------> fun 1: 2022-10-10 14:51:41 400
------> fun 2: 2022-10-10 14:51:42 400
```

### RLock
åœ¨ä¸€ä¸ªçº¿ç¨‹å‡½æ•°ä¸­ä½¿ç”¨äº†é”lock.acquire()è¿˜æ²¡æœ‰é‡Šæ”¾é”æ—¶ï¼Œè°ƒç”¨äº†å¦ä¸€ä¸ªæ–¹æ³•ï¼Œæ–¹æ³•ä¸­åˆä½¿ç”¨äº†é”ï¼Œè¿™æ ·å¦‚æœä½¿ç”¨åŒä¸€æŠŠæ™®é€šçš„é”å¾ˆå®¹æ˜“å‡ºç°æ­»é”ã€‚æ­¤æ—¶å¯ä»¥ä½¿ç”¨Rlockï¼ˆå¯é‡å…¥çš„é”ï¼‰ï¼Œä½†æ˜¯è¦æ³¨æ„ä½¿ç”¨äº†å‡ æ¬¡Rlock.acquire()ï¼Œå°±å¿…é¡»ä½¿ç”¨å‡ æ¬¡Rlock.release()

```
#!/usr/bin/python3
import threading
num = 0

def add(rlock):
    global num
    for i in range(1000000):
        rlock.acquire()
        num += 1
        dosomething(rlock)
        rlock.release()

def reduce(rlock):
    global num
    for i in range(1000000):
        rlock.acquire()
        num -= 1
        dosomething(rlock)
        rlock.release()


def dosomething(rlock):
    # æ¨¡æ‹Ÿå…¶ä»–æ“ä½œçš„å‡½æ•°
    rlock.acquire()
    # dosomething
    rlock.release()


# åˆ›å»ºé”
rlock = threading.RLock()
# åˆ›å»ºçº¿ç¨‹
t1 = threading.Thread(target=add, args=(rlock,))
t2 = threading.Thread(target=reduce, args=(rlock,))
t1.start()
t2.start()
# ç­‰å¾…å­è¿›ç¨‹æ‰§è¡Œå®Œ
t1.join()
t2.join()
print(num)


[huawei@n161 ccc]$ python3 1.py
0
```
### ä½¿ç”¨é”çš„åå¤„

- å› ä¸ºåˆ›å»ºé”è§£é”éƒ½è¦èŠ±è´¹æ—¶é—´ï¼Œä¼šå½±å“ç¨‹åºæ€§èƒ½ï¼›å¹¶ä¸”åœ¨ä½¿ç”¨é”æ—¶ï¼Œå®¹æ˜“äº§ç”Ÿæ­»é”ã€‚
- äº§ç”Ÿæ­»é”çš„æ–¹å¼ï¼š1.åˆ›å»ºé”ï¼Œæ²¡æœ‰è§£é” ; 2.ä¸¤ä¸ªçº¿ç¨‹äº’ç›¸æœ‰å¯¹æ–¹çš„é”ï¼Œç„¶åäº’ç›¸ç­‰å¾…ã€‚

### çº¿ç¨‹æ­»é”
- å•ä¸ªäº’æ–¥é”çš„æ­»é”ï¼šacquire / release æ˜¯æˆå¯¹å‡ºç°çš„ï¼Œäº’æ–¥é”å¯¹èµ„æºé”å®šä¹‹åå°±ä¸€å®šè¦è§£é”ï¼Œå¦åˆ™èµ„æºä¼šä¸€ç›´å¤„äºé”å®šçŠ¶æ€ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•ä¿®æ”¹ï¼›å°±å¥½æ¯”ä¸Šé¢çš„ä»£ç ï¼Œä»»ä½•ä¸€ä¸ªçº¿ç¨‹æ²¡æœ‰é‡Šæ”¾èµ„æº releaseï¼Œç¨‹åºå°±ä¼šä¸€ç›´å¤„äºé˜»å¡çŠ¶æ€(åœ¨ç­‰å¾…èµ„æºè¢«é‡Šæ”¾)

- å¤šä¸ªäº’æ–¥é”çš„æ­»é”ï¼šåœ¨åŒæ—¶æ“ä½œå¤šä¸ªäº’æ–¥é”çš„æ—¶å€™ä¸€å®šè¦æ ¼å¤–å°å¿ƒï¼Œå› ä¸ºä¸€ä¸å°å¿ƒå°±å®¹æ˜“è¿›å…¥æ­»å¾ªç¯ï¼Œå‡å¦‚æœ‰è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šboss è®©ç¨‹åºå‘˜ä¸€å®ç°åŠŸèƒ½ä¸€çš„å¼€å‘ï¼Œè®©ç¨‹åºå‘˜äºŒå®ç°åŠŸèƒ½äºŒçš„å¼€å‘ï¼ŒåŠŸèƒ½å¼€å‘å®Œæˆä¹‹åä¸€èµ·æ•´åˆä»£ç ï¼

```
#å¯¼å…¥çº¿ç¨‹threadingæ¨¡å—
import threading
#å¯¼å…¥çº¿ç¨‹timeæ¨¡å—
import time


# åˆ›å»ºäº’æ–¥é”
mutex_one = threading.Lock()
mutex_two = threading.Lock()

def programmer_thread1():
    mutex_one.acquire()
    print("æˆ‘æ˜¯ç¨‹åºå‘˜1ï¼Œmodule1å¼€å‘æ­£å¼å¼€å§‹ï¼Œè°ä¹Ÿåˆ«åŠ¨æˆ‘çš„ä»£ç ")
    time.sleep(2)
    # æ­¤æ—¶ä¼šå µå¡ï¼Œå› ä¸ºè¿™ä¸ªmutex_twoå·²ç»è¢«çº¿ç¨‹programmer_thread2æŠ¢å…ˆä¸Šé”äº†,ç­‰å¾…è§£é”
    mutex_two.acquire()
    print("ç­‰å¾…ç¨‹åºå‘˜2é€šçŸ¥æˆ‘åˆå¹¶ä»£ç ")
    mutex_two.release()
    mutex_one.release()

def programmer_thread2():
    mutex_two.acquire()
    print("æˆ‘æ˜¯ç¨‹åºå‘˜2ï¼Œmodule2å¼€å‘æ­£å¼å¼€å§‹ï¼Œè°ä¹Ÿåˆ«åŠ¨æˆ‘çš„ä»£ç ")
    time.sleep(2)
    # æ­¤æ—¶ä¼šå µå¡ï¼Œå› ä¸ºè¿™ä¸ªmutex_oneå·²ç»è¢«çº¿ç¨‹programmer_thread1æŠ¢å…ˆä¸Šé”äº†,ç­‰å¾…è§£é”
    mutex_one.acquire()
    print("ç­‰å¾…ç¨‹åºå‘˜1é€šçŸ¥æˆ‘åˆå¹¶ä»£ç ")
    mutex_one.release()
    mutex_two.release()

def main():
    t1 = threading.Thread(target=programmer_thread1)
    t2 = threading.Thread(target=programmer_thread2)
    # å¯åŠ¨çº¿ç¨‹
    t1.start()
    t2.start()
    # é˜»å¡å‡½æ•°ï¼Œç­‰å¾…çº¿ç¨‹ç»“æŸ
    t1.join()
    t2.join()
    # æ•´åˆä»£ç ç»“æŸ
    print("æ•´åˆä»£ç ç»“æŸ ")

if __name__ == "__main__":
    main()

ä¸¤ä¸ªçº¿ç¨‹éƒ½é™·å…¥é˜»å¡ä¸­ï¼Œå› ä¸ºä¸¤ä¸ªçº¿ç¨‹éƒ½åœ¨ç­‰å¾…å¯¹æ–¹è§£é”ï¼Œè¿™å°±æ˜¯æ­»é”ï¼æ‰€ä»¥åœ¨å¼€å‘ä¸­å¯¹äºæ­»é”çš„é—®é¢˜è¿˜æ˜¯éœ€è¦å¤šå¤šæ³¨æ„ï¼
[huawei@n161 ccc]$ python3 myprocess.py 
æˆ‘æ˜¯ç¨‹åºå‘˜1ï¼Œmodule1å¼€å‘æ­£å¼å¼€å§‹ï¼Œè°ä¹Ÿåˆ«åŠ¨æˆ‘çš„ä»£ç 
æˆ‘æ˜¯ç¨‹åºå‘˜2ï¼Œmodule2å¼€å‘æ­£å¼å¼€å§‹ï¼Œè°ä¹Ÿåˆ«åŠ¨æˆ‘çš„ä»£ç 
^CTraceback (most recent call last):
  File "myprocess.py", line 44, in <module>
    main()
  File "myprocess.py", line 38, in main
    t1.join()
```
### Event
    äº‹ä»¶ Event ä¸»è¦ç”¨äºå”¤é†’æ­£åœ¨é˜»å¡ç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹;
äº‹ä»¶Eventå‡½æ•°ä»‹ç»ï¼š
- setï¼šå…¨å±€å†…ç½®æ ‡å¿— Flagï¼Œå°†æ ‡å¿— Flag è®¾ç½®ä¸º True,é€šçŸ¥åœ¨ç­‰å¾…çŠ¶æ€ ( wait ) çš„çº¿ç¨‹æ¢å¤è¿è¡Œ; - isSetï¼šè·å–æ ‡å¿— Flag å½“å‰çŠ¶æ€ï¼Œè¿”å› True æˆ–è€… False ;
- waitï¼šä¸€æ—¦è°ƒç”¨ï¼Œçº¿ç¨‹å°†ä¼šå¤„äºé˜»å¡çŠ¶æ€ï¼Œç›´åˆ°ç­‰å¾…å…¶ä»–çº¿ç¨‹è°ƒç”¨ set å‡½æ•°æ¢å¤è¿è¡Œ;
- clearï¼šå°†æ ‡å¿—è®¾ç½®ä¸ºFalseï¼›

äº‹ä»¶ event ä¸­æœ‰ä¸€ä¸ªå…¨å±€å†…ç½®æ ‡å¿— Flagï¼Œå€¼ä¸º True æˆ–è€…Falseã€‚ä½¿ç”¨ wait å‡½æ•°çš„çº¿ç¨‹ä¼šå¤„äºé˜»å¡çŠ¶æ€,æ­¤æ—¶ Flag æŒ‡ä¸º Falseï¼Œç›´åˆ°æœ‰å…¶ä»–çº¿ç¨‹è°ƒç”¨ set å‡½æ•°è®©å…¨å±€æ ‡å¿— Flag ç½®ä¸º True ï¼Œå…¶é˜»å¡çš„çº¿ç¨‹ç«‹åˆ»æ¢å¤è¿è¡Œï¼Œè¿˜å¯ä»¥ç”¨ isSet å‡½æ•°æ£€æŸ¥å½“å‰çš„ Flag çŠ¶æ€.

æ¼”ç¤ºå¤šä¸ªçº¿ç¨‹éƒ½åœ¨waitåŒä¸€eventï¼Œå¾…eventå‘å‡ºä¿¡å·ï¼Œè¿™äº›çº¿ç¨‹éƒ½å¯ä»¥ç»§ç»­æ‰§è¡Œäº†ï¼Œä½†å¤šä¸ªçº¿ç¨‹é—´å¹¶æœªåšåŒæ­¥
```

# å¯¼å…¥çº¿ç¨‹æ¨¡å—
import threading

# åˆ›å»ºeventäº‹ä»¶
eEvent = threading.Event()

def get_girl_friend(id):
    print("å•èº«ç‹—{}éƒ½å‡†å¤‡å®Œæ¯•ï¼Œå†…ç½®FlagçŠ¶æ€ï¼š{}.....".format(id,eEvent.isSet()))
    eEvent.wait()
    print("å•èº«ç‹—%då‘Šåˆ«å•èº«....."%id)


if __name__ == "__main__":
    thread_list = list()
    for i in range(1,11):
        # åˆ›å»ºå¹¶åˆå§‹åŒ–çº¿ç¨‹
        t = threading.Thread(target=get_girl_friend,args=(i,))
        # å¯åŠ¨çº¿ç¨‹
        t.start()
        # å°†çº¿ç¨‹å¥æŸ„æ·»åŠ liståˆ—è¡¨ä¸­
        thread_list.append(t)
    # æ‰€æœ‰çº¿ç¨‹å‡†å¤‡å®Œæ¯•ï¼Œå°†eventå†…ç½®Flagè®¾ç½®ä¸ºTrue,æ¢å¤æ­£åœ¨é˜»å¡çš„çº¿ç¨‹
    eEvent.set()
    # éå†åˆ—è¡¨ï¼Œé˜»å¡ä¸»çº¿ç¨‹
    for t in thread_list:
        # é˜»å¡ä¸»çº¿ç¨‹ï¼Œç­‰å¾…æ‰€æœ‰å­çº¿ç¨‹ç»“æŸ
        t.join()
    print("ç¨‹åºç»“æŸï¼")

[huawei@n161 ccc]$ python3 1.py
å•èº«ç‹—1éƒ½å‡†å¤‡å®Œæ¯•ï¼Œå†…ç½®FlagçŠ¶æ€ï¼šFalse.....
å•èº«ç‹—2éƒ½å‡†å¤‡å®Œæ¯•ï¼Œå†…ç½®FlagçŠ¶æ€ï¼šFalse.....
å•èº«ç‹—3éƒ½å‡†å¤‡å®Œæ¯•ï¼Œå†…ç½®FlagçŠ¶æ€ï¼šFalse.....
å•èº«ç‹—4éƒ½å‡†å¤‡å®Œæ¯•ï¼Œå†…ç½®FlagçŠ¶æ€ï¼šFalse.....
å•èº«ç‹—6éƒ½å‡†å¤‡å®Œæ¯•ï¼Œå†…ç½®FlagçŠ¶æ€ï¼šFalse.....
å•èº«ç‹—5éƒ½å‡†å¤‡å®Œæ¯•ï¼Œå†…ç½®FlagçŠ¶æ€ï¼šFalse.....
å•èº«ç‹—7éƒ½å‡†å¤‡å®Œæ¯•ï¼Œå†…ç½®FlagçŠ¶æ€ï¼šFalse.....
å•èº«ç‹—8éƒ½å‡†å¤‡å®Œæ¯•ï¼Œå†…ç½®FlagçŠ¶æ€ï¼šFalse.....
å•èº«ç‹—9éƒ½å‡†å¤‡å®Œæ¯•ï¼Œå†…ç½®FlagçŠ¶æ€ï¼šFalse.....
å•èº«ç‹—10éƒ½å‡†å¤‡å®Œæ¯•ï¼Œå†…ç½®FlagçŠ¶æ€ï¼šFalse.....
å•èº«ç‹—2å‘Šåˆ«å•èº«.....
å•èº«ç‹—4å‘Šåˆ«å•èº«.....
å•èº«ç‹—6å‘Šåˆ«å•èº«.....
å•èº«ç‹—5å‘Šåˆ«å•èº«.....
å•èº«ç‹—9å‘Šåˆ«å•èº«.....
å•èº«ç‹—1å‘Šåˆ«å•èº«.....
å•èº«ç‹—3å‘Šåˆ«å•èº«.....
å•èº«ç‹—7å‘Šåˆ«å•èº«.....
å•èº«ç‹—8å‘Šåˆ«å•èº«.....
å•èº«ç‹—10å‘Šåˆ«å•èº«.....
ç¨‹åºç»“æŸï¼
```

### threading.Timer

çº¿ç¨‹å®šæ—¶å™¨ç”¨äºæŒ‡å®šæ—¶é—´é—´éš”åå¯åŠ¨çº¿ç¨‹ï¼é€‚ç”¨åœºæ™¯ï¼šå®Œæˆå®šæ—¶ä»»åŠ¡ï¼Œä¾‹å¦‚ï¼šå®šæ—¶æé†’-é—¹é’Ÿç­‰ç­‰ã€‚

timer = threading.Timer(interval, function, args=None, kwargs=None)ï¼Œå‚æ•°ä»‹ç»ï¼š
- intervalï¼šå®šæ—¶å™¨é—´éš”ï¼Œé—´éš”å¤šå°‘ç§’ä¹‹åå¯åŠ¨å®šæ—¶å™¨ä»»åŠ¡(å•ä½ï¼šç§’)ï¼›
- functionï¼šçº¿ç¨‹å‡½æ•°ï¼›
- argsï¼šçº¿ç¨‹å‚æ•°ï¼Œå¯ä»¥ä¼ é€’å…ƒç»„ç±»å‹æ•°æ®ï¼Œé»˜è®¤ä¸ºç©º(ç¼ºçœå‚æ•°)ï¼›
- kwargsï¼šçº¿ç¨‹å‚æ•°ï¼Œå¯ä»¥ä¼ é€’å­—å…¸ç±»å‹æ•°æ®ï¼Œé»˜è®¤ä¸ºç©º(ç¼ºçœå‚æ•°)ï¼›


æ­¤æ¡ˆä¾‹åœ¨ä¸»çº¿ç¨‹åˆ›å»ºäº†çº¿ç¨‹å®šæ—¶å™¨ï¼Œåœ¨ 5 ç§’ä¹‹åæ‰§è¡Œ thread_Timer çº¿ç¨‹å‡½æ•°ï¼Œè€Œåœ¨ thread_Timer å‡½æ•°ç»“æŸçš„æ—¶å€™ï¼Œåˆè®¾ç½®äº†å®šæ—¶å™¨çº¿ç¨‹ thread_Timer ï¼Œè¿™å°±å®Œæˆäº†ä¸€ä¸ªé€’å½’çš„æ“ä½œï¼Œé—´éš” 5 ç§’é‡å¤å®šæ—¶ä»»åŠ¡ï¼
```

# å¯¼å…¥çº¿ç¨‹æ¨¡å—
import threading

def thread_Timer():
    print("è¯¥èµ·åºŠå•¦...5ç§’ä¹‹åå†æ¬¡å‘¼å«ä½ èµ·åºŠ...")

    # å£°æ˜å…¨å±€å˜é‡
    global t1
    # åˆ›å»ºå¹¶åˆå§‹åŒ–çº¿ç¨‹
    t1 = threading.Timer(5,thread_Timer)
    # å¯åŠ¨çº¿ç¨‹
    t1.start()


if __name__ == "__main__":
    # åˆ›å»ºå¹¶åˆå§‹åŒ–çº¿ç¨‹
    t1 = threading.Timer(5, thread_Timer)
    # å¯åŠ¨çº¿ç¨‹
    t1.start()

ä¼šæ— é™å¾ªç¯ä¸‹å»ã€‚ã€‚ã€‚
[huawei@n161 ccc]$ python3 1.py
è¯¥èµ·åºŠå•¦...5ç§’ä¹‹åå†æ¬¡å‘¼å«ä½ èµ·åºŠ...
è¯¥èµ·åºŠå•¦...5ç§’ä¹‹åå†æ¬¡å‘¼å«ä½ èµ·åºŠ...
è¯¥èµ·åºŠå•¦...5ç§’ä¹‹åå†æ¬¡å‘¼å«ä½ èµ·åºŠ...

```

### Condition

    æ¡ä»¶å˜é‡ç”¨äºå¤æ‚çš„çº¿ç¨‹é—´åŒæ­¥ã€‚å†…éƒ¨ä½¿ç”¨çš„æ˜¯lockæˆ–è€…Rlockï¼ŒåŒæ—¶ Condition è‡ªèº«æä¾›äº† waitã€notifyã€notifyAll æ–¹æ³•ï¼Œç”¨äºé˜»å¡ã€é€šçŸ¥å¹¶è¡Œçº¿ç¨‹ï¼Œå¯ä»¥è®¿é—®å…±äº«èµ„æºäº†ã€‚å¯ä»¥è¿™ä¹ˆç†è§£ï¼ŒCondition æä¾›äº†ä¸€ç§å¤šçº¿ç¨‹é€šä¿¡æœºåˆ¶ï¼Œå‡å¦‚çº¿ç¨‹ 1 éœ€è¦æ•°æ®ï¼Œé‚£ä¹ˆçº¿ç¨‹ 1 å°±é˜»å¡ç­‰å¾…ï¼Œè¿™æ—¶çº¿ç¨‹ 2 å°±å»åˆ¶é€ æ•°æ®ï¼Œçº¿ç¨‹ 2 åˆ¶é€ å¥½æ•°æ®åï¼Œé€šçŸ¥çº¿ç¨‹ 1 å¯ä»¥å»å–æ•°æ®äº†ï¼Œç„¶åçº¿ç¨‹ 1 å»è·å–æ•°æ®ï¼ˆç”Ÿäº§è€…æ¶ˆè´¹è€…ï¼‰ã€‚

é‡è¦çš„æ–¹æ³•ï¼š
- acquireï¼šçº¿ç¨‹é”ï¼Œæ³¨æ„çº¿ç¨‹æ¡ä»¶å˜é‡ Condition ä¸­çš„æ‰€æœ‰ç›¸å…³å‡½æ•°ä½¿ç”¨å¿…é¡»åœ¨acquire / release å†…éƒ¨æ“ä½œï¼›
- releaseï¼šé‡Šæ”¾é”ï¼Œæ³¨æ„çº¿ç¨‹æ¡ä»¶å˜é‡ Condition ä¸­çš„æ‰€æœ‰ç›¸å…³å‡½æ•°ä½¿ç”¨å¿…é¡»åœ¨acquire / release å†…éƒ¨æ“ä½œï¼›
- wait( timeout )ï¼šçº¿ç¨‹æŒ‚èµ·(é˜»å¡çŠ¶æ€)ï¼Œç›´åˆ°æ”¶åˆ°ä¸€ä¸ª notify é€šçŸ¥æˆ–è€…è¶…æ—¶æ‰ä¼šè¢«å”¤é†’ç»§ç»­è¿è¡Œï¼ˆè¶…æ—¶å‚æ•°é»˜è®¤ä¸è®¾ç½®ï¼Œå¯é€‰å¡«ï¼Œç±»å‹æ˜¯æµ®ç‚¹æ•°ï¼Œå•ä½æ˜¯ç§’ï¼‰ã€‚wait å¿…é¡»åœ¨å·²è·å¾— Lock å‰æä¸‹æ‰èƒ½è°ƒç”¨ï¼Œå¦åˆ™ä¼šè§¦å‘ RuntimeErrorï¼›
- notify(n=1)ï¼šé€šçŸ¥å…¶ä»–çº¿ç¨‹ï¼Œé‚£äº›æŒ‚èµ·çš„çº¿ç¨‹æ¥åˆ°è¿™ä¸ªé€šçŸ¥ä¹‹åä¼šå¼€å§‹è¿è¡Œï¼Œç¼ºçœå‚æ•°ï¼Œé»˜è®¤æ˜¯é€šçŸ¥ä¸€ä¸ªæ­£ç­‰å¾…é€šçŸ¥çš„çº¿ç¨‹,æœ€å¤šåˆ™å”¤é†’ n ä¸ªç­‰å¾…çš„çº¿ç¨‹ã€‚ notify å¿…é¡»åœ¨å·²è·å¾— Lock å‰æä¸‹æ‰èƒ½è°ƒç”¨ï¼Œå¦åˆ™ä¼šè§¦å‘ RuntimeError ï¼Œnotify ä¸ä¼šä¸»åŠ¨é‡Šæ”¾ Lock ï¼›
- notifyAllï¼šå¦‚æœwaitçŠ¶æ€çº¿ç¨‹æ¯”è¾ƒå¤šï¼ŒnotifyAll çš„ä½œç”¨å°±æ˜¯é€šçŸ¥æ‰€æœ‰çº¿ç¨‹ï¼›  

æ³¨æ„äº’æ–¥é”Lockã€äº‹ä»¶Eventã€æ¡ä»¶å˜é‡Condition ä¸‰è€…çš„åŒºåˆ«ï¼Œåœºæ™¯ä¸åŒï¼Œä½¿ç”¨æ–¹å¼ä¹Ÿä¸åŒï¼Œå‰ä¸¤è€…ä¸€èˆ¬å¯ä»¥ä½œä¸ºç®€å•çš„çº¿ç¨‹äº¤äº’ï¼Œçº¿ç¨‹æ¡ä»¶å˜é‡ Condition å¯ä»¥ç”¨äºæ¯”è¾ƒå¤æ‚çš„çº¿ç¨‹äº¤äº’ï¼


ç®€å•çš„æ¡ˆä¾‹ï¼Œæ¼”ç¤ºäº†ä¸¤ä¸ªçº¿ç¨‹å„æ‰§è¡Œä¸€æ¬¡æ‰“å°

```
# å¯¼å…¥çº¿ç¨‹æ¨¡å—
import threading
# åˆ›å»ºæ¡ä»¶å˜é‡condition
con = threading.Condition()

def thread_one(name):
    # æ¡ä»¶å˜é‡condition çº¿ç¨‹ä¸Šé”
    con.acquire()
    print("{}:æˆè¯­æ¥é¾™å‡†å¤‡å¥½äº†å—".format(name))
    # å”¤é†’æ­£åœ¨ç­‰å¾…(wait)çš„çº¿ç¨‹
    con.notify()
    # ç­‰å¾…å¯¹æ–¹å›åº”æ¶ˆæ¯ï¼Œä½¿ç”¨waité˜»å¡çº¿ç¨‹ï¼Œç­‰å¾…å¯¹æ–¹é€šè¿‡notifyå”¤é†’æœ¬çº¿ç¨‹
    con.wait()
    print("{}:ä¸€å¹²äºŒå‡€".format(name))
    # å”¤é†’å¯¹æ–¹
    con.notify()
    # ç­‰å¾…æ¶ˆæ¯ç­”åº”
    con.wait()
    print("{}:ä¸€å¤©å°±çŸ¥é“çœ‹æŠ–éŸ³ç¾å¥³ï¼Œç»™ä½ æ¥ä¸ªç®€å•ç‚¹çš„ï¼Œæ¥äº†ï¼šæ¯›æ‰‹æ¯›è„š".format(name))
    # å”¤é†’å¯¹æ–¹
    con.notify()
    # ç­‰å¾…æ¶ˆæ¯ç­”åº”
    con.wait()
    print("{}:å“Ÿå“Ÿå“Ÿï¼Œä¸é”™ä¸é”™ï¼".format(name))
    # å”¤é†’å¯¹æ–¹
    con.notify()
    # æ¡ä»¶å˜é‡condition çº¿ç¨‹é‡Šæ”¾é”
    con.release()

def thread_two(name):
    # æ¡ä»¶å˜é‡condition çº¿ç¨‹ä¸Šé”
    con.acquire()
    # waité˜»å¡çŠ¶æ€ï¼Œç­‰å¾…å…¶ä»–çº¿ç¨‹é€šè¿‡notifyå”¤é†’æœ¬çº¿ç¨‹
    con.wait()
    print("{}:å‡†å¤‡å¥½äº†~å¼€å§‹å§ï¼".format(name))
    # å”¤é†’å¯¹æ–¹
    con.notify()
    # ç­‰å¾…æ¶ˆæ¯ç­”åº”
    con.wait()
    print("{}:å‡€ä½ å¦¹å•Šï¼Œæ²¡æ³•æ¥...æ¥ä¸ªç®€å•ç‚¹çš„...".format(name))
    # å”¤é†’å¯¹æ–¹
    con.notify()
    # ç­‰å¾…æ¶ˆæ¯ç­”åº”
    con.wait()
    print("{}:å˜¿,è¿™ä¸ªæˆ‘çŸ¥é“ï¼šè„šè¸å®åœ°".format(name))
    # å”¤é†’å¯¹æ–¹
    con.notify()
    con.release()

if __name__ == "__main__":
    # åˆ›å»ºå¹¶åˆå§‹åŒ–çº¿ç¨‹
    t1 = threading.Thread(target=thread_one,args=("A"))
    t2 = threading.Thread(target=thread_two,args=("B"))
    # å¯åŠ¨çº¿ç¨‹ -- æ³¨æ„çº¿ç¨‹å¯åŠ¨é¡ºåºï¼Œå¯åŠ¨é¡ºåºå¾ˆé‡è¦
    t2.start()
    t1.start()
    # é˜»å¡ä¸»çº¿ç¨‹ï¼Œç­‰å¾…å­çº¿ç¨‹ç»“æŸ
    t1.join()
    t2.join()
    print("ç¨‹åºç»“æŸï¼")


[huawei@n161 ccc]$ python3 1.py
A:æˆè¯­æ¥é¾™å‡†å¤‡å¥½äº†å—
B:å‡†å¤‡å¥½äº†~å¼€å§‹å§ï¼
A:ä¸€å¹²äºŒå‡€
B:å‡€ä½ å¦¹å•Šï¼Œæ²¡æ³•æ¥...æ¥ä¸ªç®€å•ç‚¹çš„...
A:ä¸€å¤©å°±çŸ¥é“çœ‹æŠ–éŸ³ç¾å¥³ï¼Œç»™ä½ æ¥ä¸ªç®€å•ç‚¹çš„ï¼Œæ¥äº†ï¼šæ¯›æ‰‹æ¯›è„š
B:å˜¿,è¿™ä¸ªæˆ‘çŸ¥é“ï¼šè„šè¸å®åœ°
A:å“Ÿå“Ÿå“Ÿï¼Œä¸é”™ä¸é”™ï¼
ç¨‹åºç»“æŸï¼
```

å”¤é†’ä¸€ä¸ªä¸å¤šä¸ªçš„æ¡ˆä¾‹
```
#!/usr/bin/python3
import threading
import time

product = [0]
def consumer(cond):
    with cond:
        print('wait for product')
        cond.wait()
        print('get product:{}'.format(product))

def producer(cond):
    product.append(10)
    with cond: 
        cond.notify()	# å”¤èµ·ä¸€ä¸ª
        print('notify !')
    time.sleep(3)
    product.append(20)
    with cond:
        cond.notify()	# å†å”¤èµ·ä¸€ä¸ª
        print('notify !')
    time.sleep(3)
    product.append(30)
    with cond:
        cond.notify_all()	# å…¨éƒ¨å”¤èµ·
        print('notify all!')

condition = threading.Condition()

c1 = threading.Thread(name='c1',target=consumer,args=(condition,))
c2 = threading.Thread(name='c2',target=consumer,args=(condition,))
c3 = threading.Thread(name='c3',target=consumer,args=(condition,))
c4 = threading.Thread(name='c4',target=consumer,args=(condition,))
p = threading.Thread(name='p',target=producer,args=(condition,))

c1.start()
c2.start()
c3.start()
c4.start()

p.start()

[huawei@n161 ccc]$ python3 1.py
wait for product
wait for product
wait for product
wait for product
notify !
get product:[0, 10]
notify !
get product:[0, 10, 20]
notify all!
get product:[0, 10, 20, 30]
get product:[0, 10, 20, 30]
```

ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¡ˆä¾‹
```
# å¯¼å…¥çº¿ç¨‹æ¨¡å—
import threading
import time

# åˆ›å»ºæ¡ä»¶å˜é‡condition
con = threading.Condition()
meat_num = 0

def thread_consumers():
    # æ¡ä»¶å˜é‡condition çº¿ç¨‹ä¸Šé”
    con.acquire()

    # å…¨å±€å˜é‡å£°æ˜å…³é”®å­— global
    global meat_num
    meat_num = 0

    # ç­‰å¾…è‚‰ç‰‡ä¸‹é”…ç…®ç†Ÿ
    con.wait()
    while True:
        print("æˆ‘æ¥ä¸€å—è‚‰ç‰‡...")
        meat_num -= 1
        print("å‰©ä½™è‚‰ç‰‡æ•°é‡ï¼š%d"%meat_num)
        time.sleep(0.5)
        if meat_num == 0:
            # è‚‰ç‰‡åƒå…‰äº†ï¼Œé€šçŸ¥è€æ¿æ·»åŠ è‚‰ç‰‡
            print("è€æ¿ï¼Œå†æ¥ä¸€ä»½è€è‚‰ç‰‡...")
            con.notify()
            # è‚‰ç‰‡åƒå…‰äº†ï¼Œç­‰å¾…è‚‰ç‰‡
            con.wait()

    # æ¡ä»¶å˜é‡condition çº¿ç¨‹é‡Šæ”¾é”
    con.release()


def thread_producer():
    # æ¡ä»¶å˜é‡condition çº¿ç¨‹ä¸Šé”
    con.acquire()
    # å…¨å±€å˜é‡å£°æ˜å…³é”®å­— global
    global meat_num

    # è‚‰ç‰‡ç†Ÿäº†ï¼Œå¯ä»¥å¼€å§‹åƒäº†
    meat_num = 10
    print("è‚‰ç‰‡ç†Ÿäº†ï¼Œå¯ä»¥å¼€å§‹åƒäº†...")
    con.notify()
    while True:
        # é˜»å¡å‡½æ•°,ç­‰å¾…è‚‰ç‰‡åƒå®Œçš„é€šçŸ¥
        con.wait()
        meat_num = 10
        # æ·»åŠ è‚‰ç‰‡å®Œæˆï¼Œå¯ä»¥ç»§ç»­å¼€åƒ
        print("æ·»åŠ è‚‰ç‰‡æˆåŠŸï¼å½“å‰è‚‰ç‰‡æ•°é‡ï¼š%d"%meat_num)
        time.sleep(1)
        con.notify()

    con.release()


if __name__ == "__main__":
    # åˆ›å»ºå¹¶åˆå§‹åŒ–çº¿ç¨‹
    t1 = threading.Thread(target=thread_producer)
    t2 = threading.Thread(target=thread_consumers)

    # å¯åŠ¨çº¿ç¨‹ -- æ³¨æ„çº¿ç¨‹å¯åŠ¨é¡ºåºï¼Œå¯åŠ¨é¡ºåºå¾ˆé‡è¦
    t2.start()
    t1.start()

    # é˜»å¡ä¸»çº¿ç¨‹ï¼Œç­‰å¾…å­çº¿ç¨‹ç»“æŸ
    t1.join()
    t2.join()

    print("ç¨‹åºç»“æŸï¼")

```

### Semaphore
    ä¿¡å·é‡ä¹Ÿæ˜¯ä¸€æŠŠé”ï¼Œå¯ä»¥æŒ‡å®šä¿¡å·é‡ä¸º5ï¼Œå¯¹æ¯”äº’æ–¥é”åŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªä»»åŠ¡æŠ¢åˆ°é”å»æ‰§è¡Œï¼Œä¿¡å·é‡åŒä¸€æ—¶é—´å¯ä»¥æœ‰5ä¸ªä»»åŠ¡æ‹¿åˆ°é”å»æ‰§è¡Œã€‚å¦‚æœè¯´äº’æ–¥é”ï¼ˆå¦‚lockï¼‰æ˜¯åˆç§Ÿæˆ¿å±‹çš„äººå»æŠ¢ä¸€ä¸ªå•æ‰€ï¼Œé‚£ä¹ˆä¿¡å·é‡å°±ç›¸å½“äºä¸€ç¾¤è·¯äººäº‰æŠ¢å…¬å…±å•æ‰€ï¼Œå…¬å…±å•æ‰€æœ‰å¤šä¸ªå‘ä½ï¼Œè¿™æ„å‘³ç€åŒä¸€æ—¶é—´å¯ä»¥æœ‰å¤šä¸ªäººä¸Šå…¬å…±å•æ‰€ï¼Œä½†å…¬å…±å•æ‰€å®¹çº³çš„äººæ•°æ˜¯ä¸€å®šçš„ï¼Œè¿™ä¾¿æ˜¯ä¿¡å·é‡çš„å¤§å°

- æ¦‚è¿°ï¼šä¿¡å·é‡æ˜¯ç”¨æ¥ æ§åˆ¶çº¿ç¨‹å¹¶å‘æ•°çš„ã€‚
- åŸç†ï¼šBoundedSemaphoreå’ŒSemaphoreç®¡ç†ä¸€ä¸ªå†…ç½®çš„è®¡æ•°å™¨ã€‚æ¯å½“ èµ„æºé‡Šæ”¾é€’å¢æ—¶(è°ƒç”¨acquire)è®¡æ•°å™¨-1,èµ„æºæ¶ˆè€—æ—¶é€’å‡(è°ƒç”¨release)è®¡æ•°å™¨+1ã€‚
- è°ƒç”¨æ ¼å¼ï¼š threading.BoundedSemaphore/Semaphore(value);å€¼é»˜è®¤1
- ä½¿ç”¨åœºæ™¯ï¼š åœè½¦ä½(å›ºå®šçš„åœè½¦ä½,è½¦ä½å…¨éƒ¨è¢«å ç”¨åˆ™è¿›ä¸æ¥;åªæœ‰è½¦å­ç¦»å¼€å…¶ä½™è½¦æ‰èƒ½è¿›æ¥)
- BoundedSemaphoreå’ŒSemaphoreåŒºåˆ«ï¼š å‰è€…å°†åœ¨è°ƒç”¨release()æ—¶æ£€æŸ¥è®¡æ•°å™¨çš„å€¼æ˜¯å¦è¶…è¿‡äº†è®¡æ•°å™¨çš„åˆå§‹å€¼,å¦‚æœè¶…è¿‡å°†æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚
- æ³¨æ„äº‹é¡¹ï¼š è®¡æ•°å™¨ä¸èƒ½å°äº0,å½“è®¡æ•°å™¨ä¸º0æ—¶:acquire()å°†é˜»å¡çº¿ç¨‹è‡³åŒæ­¥é”å®šçŠ¶æ€,ç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨release()ã€‚


æ¡ˆä¾‹ï¼šåœè½¦åœºåªæœ‰3ä¸ªåœè½¦ä½ã€‚æ¥äº†5è¾†æ±½è½¦éœ€è¦åœè½¦è¿™æ—¶å€™å°±ä½¿ç”¨Semaphoreæ¥æ§åˆ¶è®¿é—®é‡äº†åªèƒ½åŒæ—¶å…è®¸3è¾†è½¦åŒæ—¶è¿›å…¥åœè½¦åœº,ç¬¬4è¾†è½¦åªæœ‰ç­‰å…ˆè¿›å…¥çš„3è¾†è½¦ä¸­æœ‰è½¦å‡ºæ¥æ‰å¯è¿›å…¥
```
import threading,time,random
semaphore=threading.Semaphore(3)#åŒä¸€æ—¶é—´åªèƒ½æœ‰3ä¸ªçº¿ç¨‹å¤„äºè¿è¡ŒçŠ¶æ€

def run (ii):
    semaphore.acquire() # è·å¾—ä¿¡å·é‡:ä¿¡å·é‡å‡ä¸€
    print(ii,'å·è½¦å¯ä»¥è¿›å…¥')
    time.sleep(random.randint(0,10)*1)
    print(ii,'å·åœè½¦ä½é‡Šæ”¾')
    semaphore.release()# é‡Šæ”¾ä¿¡å·é‡:ä¿¡å·é‡åŠ ä¸€

for i in range(5):#åˆ›å»º5ä¸ªçº¿ç¨‹
    t=threading.Thread(target=run,args=(i,))
    t.start()

[huawei@n161 ccc]$ python3 1.py
0 å·è½¦å¯ä»¥è¿›å…¥
1 å·è½¦å¯ä»¥è¿›å…¥
2 å·è½¦å¯ä»¥è¿›å…¥
1 å·åœè½¦ä½é‡Šæ”¾
3 å·è½¦å¯ä»¥è¿›å…¥
3 å·åœè½¦ä½é‡Šæ”¾
4 å·è½¦å¯ä»¥è¿›å…¥
2 å·åœè½¦ä½é‡Šæ”¾
4 å·åœè½¦ä½é‡Šæ”¾
0 å·åœè½¦ä½é‡Šæ”¾
```
### BoundedSemaphore
BoundedSemaphoreè°ƒç”¨æ—¶å¦‚æœè®¡æ•°å™¨çš„å€¼è¶…è¿‡äº†åˆå§‹å€¼ä¼šæŠ›å‡ºå¼‚å¸¸;ä½†æ˜¯Semaphoreä¸ä¼š
```
import threading,time,random
semaphore=threading.BoundedSemaphore(3)#åŒä¸€æ—¶é—´åªèƒ½æœ‰3ä¸ªçº¿ç¨‹å¤„äºè¿è¡ŒçŠ¶æ€

def run (ii):
    semaphore.acquire() # è·å¾—ä¿¡å·é‡:ä¿¡å·é‡å‡ä¸€
    print(ii,'å·è½¦å¯ä»¥è¿›å…¥')
    time.sleep(random.randint(0,10)*1)
    print(ii,'å·åœè½¦ä½é‡Šæ”¾')
    #***************æ­¤å¤„é«˜èƒ½******************
    semaphore.release()# é‡Šæ”¾ä¿¡å·é‡:ä¿¡å·é‡åŠ ä¸€
    # å†æ¬¡é‡Šæ”¾ä¿¡å·é‡:ä¿¡å·é‡åŠ ä¸€ï¼Œè¿™æ—¶è¶…è¿‡é™å®šçš„ä¿¡å·é‡æ•°ç›®ä¼šæŠ¥é”™ValueError: Semaphore released too many times
    semaphore.release()
    #***************é«˜èƒ½ç»“æŸ******************

for i in range(5):#åˆ›å»º5ä¸ªçº¿ç¨‹
    t=threading.Thread(target=run,args=(i,))
    t.start()

æ‰§è¡Œåˆ°0åå†releaseä¼šå´©æºƒã€‚ã€‚ã€‚
[huawei@n161 ccc]$ python3 1.py
0 å·è½¦å¯ä»¥è¿›å…¥
1 å·è½¦å¯ä»¥è¿›å…¥
2 å·è½¦å¯ä»¥è¿›å…¥
0 å·åœè½¦ä½é‡Šæ”¾
3 å·è½¦å¯ä»¥è¿›å…¥
4 å·è½¦å¯ä»¥è¿›å…¥
3 å·åœè½¦ä½é‡Šæ”¾
1 å·åœè½¦ä½é‡Šæ”¾
Exception in thread Thread-2:
Traceback (most recent call last):
```

### Barrier

ä¿—ç§°éšœç¢å¯¹è±¡ï¼Œä¹Ÿç§°æ …æ ï¼Œä¹Ÿå«å±éšœã€‚ä¸ä¹‹å‰ä»‹ç» äº’æ–¥é” Lockã€äº‹ä»¶ Eventã€å®šæ—¶å™¨ Timer ç­‰ä¸åŒï¼Œå¤šçº¿ç¨‹Barrier ä¼šè®¾ç½®ä¸€ä¸ªçº¿ç¨‹éšœç¢æ•°é‡ parties ï¼Œå¦‚æœç­‰å¾…çš„çº¿ç¨‹æ•°é‡æ²¡æœ‰è¾¾åˆ°éšœç¢æ•°é‡ parties ï¼Œæ‰€æœ‰çº¿ç¨‹ä¼šå¤„äºé˜»å¡çŠ¶æ€ï¼Œå½“ç­‰å¾…çš„çº¿ç¨‹åˆ°è¾¾äº†è¿™ä¸ªæ•°é‡å°±ä¼šå”¤é†’æ‰€æœ‰çš„ç­‰å¾…çº¿ç¨‹ã€‚ï¼ˆå³é˜»å¡çš„çº¿ç¨‹è¾¾åˆ°ç›®æ ‡æ•°é‡æ‰èƒ½ä¸€èµ·è¢«å”¤é†’ï¼‰

- barrier = threading.Barrier(parties, action=None, timeout=None) å‚æ•°ä»‹ç»ï¼š
  - partiesï¼šçº¿ç¨‹è®¡æ•°å™¨ï¼Œè®°å½•çº¿ç¨‹æ•°é‡ï¼Œä¹Ÿç§°çº¿ç¨‹éšœç¢æ•°é‡ï¼›
  - actionï¼šæ˜¯ä¸€ä¸ªå¯è°ƒç”¨å‡½æ•°ï¼Œå½“ç­‰å¾…çš„çº¿ç¨‹åˆ°è¾¾äº†çº¿ç¨‹éšœç¢æ•°é‡partiesï¼Œå…¶ä¸­ä¸€ä¸ªçº¿ç¨‹ä¼šé¦–å…ˆè°ƒç”¨action å¯¹åº”å‡½æ•°ï¼Œä¹‹åå†æ‰§è¡Œçº¿ç¨‹è‡ªå·±å†…éƒ¨çš„ä»£ç ï¼›
  - timeoutï¼šé»˜è®¤çš„è¶…æ—¶æ—¶é—´ï¼›

- wait(timeout=None)ï¼šé˜»å¡å¹¶å°è¯•é€šè¿‡éšœç¢ï¼Œå¦‚æœç­‰å¾…çš„çº¿ç¨‹æ•°é‡å¤§äºæˆ–è€…ç­‰äºçº¿ç¨‹éšœç¢æ•°é‡ parties ï¼Œåˆ™è¡¨ç¤ºéšœç¢é€šè¿‡ï¼Œæ‰§è¡Œ action å¯¹åº”å‡½æ•°å¹¶æ‰§è¡Œçº¿ç¨‹å†…éƒ¨ä»£ç ï¼Œåä¹‹åˆ™ç»§ç»­ç­‰å¾…ï¼›å¦‚æœ wait(timeout=None)  ç­‰å¾…è¶…æ—¶ï¼Œéšœç¢å°†è¿›å…¥æ–­å¼€çŠ¶æ€ï¼å¦‚æœåœ¨çº¿ç¨‹ç­‰å¾…æœŸé—´éšœç¢æ–­å¼€æˆ–é‡ç½®ï¼Œæ­¤æ–¹æ³•ä¼šå¼•å‘ BrokenBarrierError é”™è¯¯ï¼Œæ³¨æ„æ·»åŠ å¼‚å¸¸å¤„ç†ï¼Œæ¼”ç¤ºä»£ç æŸ¥çœ‹æ¡ˆä¾‹ä¸€ï¼›

- resetï¼šé‡ç½®çº¿ç¨‹éšœç¢æ•°é‡ï¼Œè¿”å›é»˜è®¤çš„ç©ºçŠ¶æ€ï¼Œå³å½“å‰é˜»å¡çš„çº¿ç¨‹é‡æ–°æ¥è¿‡ï¼Œå¦‚æœåœ¨çº¿ç¨‹ç­‰å¾…æœŸé—´éšœç¢æ–­å¼€æˆ–é‡ç½®ï¼Œæ­¤æ–¹æ³•ä¼šå¼•å‘ BrokenBarrierError é”™è¯¯ï¼Œæ³¨æ„æ·»åŠ å¼‚å¸¸å¤„ç†ï¼Œæ¼”ç¤ºä»£ç æŸ¥çœ‹æ¡ˆä¾‹äºŒï¼›

ç®€å•ä½¿ç”¨æ¡ˆä¾‹ã€‚å¦‚æœ barrier.wait(timeout=None) ç­‰å¾…è¶…æ—¶ï¼Œä¼šè¿›å…¥æ–­å¼€çŠ¶æ€ï¼Œå¼•å‘ BrokenBarrierError é”™è¯¯ï¼Œä¸ºäº†ç¨‹åºçš„å¥å£®æ€§ï¼Œæœ€å¥½åŠ ä¸Šå¼‚å¸¸å¤„ç†ï¼›

```
# å¯¼å…¥çº¿ç¨‹æ¨¡å—
import threading

def plyer_display():
    print('åˆå§‹åŒ–é€šè¿‡å®Œæˆï¼ŒéŸ³è§†é¢‘åŒæ­¥å®Œæˆï¼Œå¯ä»¥å¼€å§‹æ’­æ”¾....')

# è®¾ç½®3ä¸ªéšœç¢å¯¹è±¡
barrier = threading.Barrier(3, action=plyer_display, timeout=None)


def player_init(statu):
    print(statu)
    try:
        # è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œå¦‚æœ2ç§’å†…ï¼Œæ²¡æœ‰è¾¾åˆ°éšœç¢çº¿ç¨‹æ•°é‡ï¼Œ
        # ä¼šè¿›å…¥æ–­å¼€çŠ¶æ€ï¼Œå¼•å‘BrokenBarrierErroré”™è¯¯
        barrier.wait(2)
    except Exception as e: # æ–­å¼€çŠ¶æ€ï¼Œå¼•å‘BrokenBarrierErroré”™è¯¯
        print("ç­‰å¾…è¶…æ—¶äº†... ")
    else:
        print("xxxooooxxxxxooooxxxoooo")

if __name__ == '__main__':

    statu_list = ["init ready","video ready","audio ready"]
    thread_list = list()
    for i in range(0,3):
        t = threading.Thread(target=player_init,args=(statu_list[i],))
        t.start()
        thread_list.append(t)

    for t in thread_list:
        t.join()

[huawei@n161 ccc]$ python3 1.py
init ready
video ready
audio ready
åˆå§‹åŒ–é€šè¿‡å®Œæˆï¼ŒéŸ³è§†é¢‘åŒæ­¥å®Œæˆï¼Œå¯ä»¥å¼€å§‹æ’­æ”¾....
xxxooooxxxxxooooxxxoooo
xxxooooxxxxxooooxxxoooo
xxxooooxxxxxooooxxxoooo
```
ä¸‹é¢åŠ å…¥äº†resetçš„è°ƒç”¨
```
# å¯¼å…¥çº¿ç¨‹æ¨¡å—
import threading

def plyer_display():
    print('åˆå§‹åŒ–é€šè¿‡å®Œæˆï¼ŒéŸ³è§†é¢‘åŒæ­¥å®Œæˆï¼Œå¯ä»¥å¼€å§‹æ’­æ”¾....')

# è®¾ç½®3ä¸ªéšœç¢å¯¹è±¡
barrier = threading.Barrier(3, action=plyer_display, timeout=None)


def player_init(statu):

    while True:
        print(statu)
        try:
            # è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œå¦‚æœ2ç§’å†…ï¼Œæ²¡æœ‰è¾¾åˆ°éšœç¢çº¿ç¨‹æ•°é‡ï¼Œ
            # ä¼šè¿›å…¥æ–­å¼€çŠ¶æ€ï¼Œå¼•å‘BrokenBarrierErroré”™è¯¯
            barrier.wait(2)
        except Exception as e: # æ–­å¼€çŠ¶æ€ï¼Œå¼•å‘BrokenBarrierErroré”™è¯¯
            # print("æ–­å¼€çŠ¶æ€... ")
            continue
        else:
            print("xxxooyyyxxxooyyyxxxooyyy")
            break

if __name__ == '__main__':

    statu_list = ["init ready","video ready","audio ready"]
    thread_list = list()
    for i in range(0,3):
        t = threading.Thread(target=player_init,args=(statu_list[i],))
        t.start()

        thread_list.append(t)
        if i == 1: # é‡ç½®çŠ¶æ€
            print("ä¸æƒ³çœ‹çˆ±æƒ…ç‰‡ï¼Œæˆ‘è¦çœ‹çˆ±æƒ…åŠ¨ä½œç‰‡....")
            barrier.reset()


    for t in thread_list:
        t.join()

[huawei@n161 ccc]$ python3 1.py
init ready
video ready
ä¸æƒ³çœ‹çˆ±æƒ…ç‰‡ï¼Œæˆ‘è¦çœ‹çˆ±æƒ…åŠ¨ä½œç‰‡....
init ready
audio ready
video ready
åˆå§‹åŒ–é€šè¿‡å®Œæˆï¼ŒéŸ³è§†é¢‘åŒæ­¥å®Œæˆï¼Œå¯ä»¥å¼€å§‹æ’­æ”¾....
xxxooyyyxxxooyyyxxxooyyy
xxxooyyyxxxooyyyxxxooyyy
xxxooyyyxxxooyyyxxxooyyy
```



## çº¿ç¨‹æ±  ThreadPoolExecutor
    å¯¹äº CPU å¯†é›†å‹çš„è®¡ç®—åœºæ™¯ï¼Œç†è®ºä¸Šå°†çº¿ç¨‹çš„æ•°é‡è®¾ç½®ä¸º CPU æ ¸æ•°å°±æ˜¯æœ€åˆé€‚çš„ï¼Œè¿™æ ·å¯ä»¥å°†æ¯ä¸ª CPU æ ¸å¿ƒçš„æ€§èƒ½å‹æ¦¨åˆ°æè‡´ï¼Œä¸è¿‡åœ¨å·¥ç¨‹ä¸Šï¼Œçº¿ç¨‹çš„æ•°é‡ä¸€èˆ¬ä¼šè®¾ç½®ä¸º CPU æ ¸æ•° + 1ï¼Œè¿™æ ·åœ¨æŸä¸ªçº¿ç¨‹å› ä¸ºæœªçŸ¥åŸå› é˜»å¡æ—¶å¤šä½™çš„é‚£ä¸ªçº¿ç¨‹å®Œå…¨å¯ä»¥é¡¶ä¸Šã€‚è€Œå¯¹äº I/O å¯†é›†å‹çš„åº”ç”¨ï¼Œå°±éœ€è¦è€ƒè™‘ CPU è®¡ç®—çš„è€—æ—¶å’Œ I/O çš„è€—æ—¶æ¯”äº†ã€‚å¦‚æœ I/O è€—æ—¶å’Œ CPU è€—æ—¶ ä¸º 1:1ï¼Œé‚£ä¹ˆä¸¤ä¸ªçº¿ç¨‹æ˜¯æœ€åˆé€‚çš„ï¼Œå› ä¸ºå½“ A çº¿ç¨‹åš I/O æ“ä½œæ—¶ï¼ŒB çº¿ç¨‹æ‰§è¡Œ CPU è®¡ç®—ä»»åŠ¡ï¼Œå½“ B çº¿ç¨‹åš I/O æ“ä½œæ—¶ï¼ŒA çº¿ç¨‹æ‰§è¡Œ CPU è®¡ç®—ä»»åŠ¡ï¼ŒCPU å’Œ I/O çš„åˆ©ç”¨ç‡éƒ½å¾—åˆ°äº†ç™¾åˆ†ç™¾ï¼Œå®Œç¾ã€‚æ‰€ä»¥å¯ä»¥è®¤ä¸ºæœ€ä½³çº¿ç¨‹æ•° = CPU æ ¸æ•° * [1 +ï¼ˆI/O è€—æ—¶ / CPU è€—æ—¶]ã€‚

ThreadPoolExecutor æ˜¯ python3 æ–°å¼•å…¥çš„åº“

åˆ›å»ºå®¹é‡ä¸º 2 çš„çº¿ç¨‹æ± ï¼Œæäº¤å››ä¸ªä»»åŠ¡ã€‚é€šè¿‡ submit å’Œ as_completed æ¥æäº¤å’Œè·å–ä»»åŠ¡è¿”å›ç»“æœçš„ã€‚
```
import time
import threading
from concurrent.futures import ThreadPoolExecutor, as_completed

def sayhello(name):
    print("%s say Hello to %s" % (threading.current_thread().getName(), name));
    time.sleep(1)
    return name

name_list =['admin','root','scott','tiger']
start_time = time.time()
with ThreadPoolExecutor(2) as executor: # åˆ›å»º ThreadPoolExecutor 
    future_list = [executor.submit(sayhello, name) for name in name_list] # æäº¤ä»»åŠ¡

for future in as_completed(future_list):
    result = future.result() # è·å–ä»»åŠ¡ç»“æœ
    print("%s get result : %s" % (threading.current_thread().getName(), result))

print('%s cost %d second' % (threading.current_thread().getName(), time.time()-start_time))


[huawei@n161 ccc]$ python3 1.py
ThreadPoolExecutor-0_0 say Hello to admin
ThreadPoolExecutor-0_1 say Hello to root
ThreadPoolExecutor-0_0 say Hello to scott
ThreadPoolExecutor-0_1 say Hello to tiger
MainThread get result : scott
MainThread get result : tiger
MainThread get result : root
MainThread get result : admin
MainThread cost 2 second
```


# åç¨‹
http://www.gaohaiyan.com/2667.html


# å…¶å®ƒå®¹å™¨

## å†…å­˜è§†å›¾ memoryview
## NumPy
## SciPy

## å †
heapq æ¨¡å—æä¾›äº†åŸºäºå¸¸è§„åˆ—è¡¨æ¥å®ç°å †çš„å‡½æ•°ã€‚ æœ€å°å€¼çš„æ¡ç›®æ€»æ˜¯ä¿æŒåœ¨ä½ç½®é›¶ã€‚ è¿™å¯¹äºéœ€è¦é‡å¤è®¿é—®æœ€å°å…ƒç´ è€Œä¸å¸Œæœ›è¿è¡Œå®Œæ•´åˆ—è¡¨æ’åºçš„åº”ç”¨æ¥è¯´éå¸¸æœ‰ç”¨

## Queue é˜Ÿåˆ—

å…ˆè¿›å…ˆå‡º(First In First Out: FIFO)é˜Ÿåˆ—

queue.Queue(maxsize=0) å…¥å‚ maxsize æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œç”¨äºè®¾ç½®é˜Ÿåˆ—çš„æœ€å¤§é•¿åº¦ã€‚ä¸€æ—¦é˜Ÿåˆ—è¾¾åˆ°ä¸Šé™ï¼Œæ’å…¥æ•°æ®å°†ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°æœ‰æ•°æ®å‡ºé˜Ÿåˆ—ä¹‹åæ‰å¯ä»¥ç»§ç»­æ’å…¥ã€‚å¦‚æœ maxsize è®¾ç½®ä¸ºå°äºæˆ–ç­‰äºé›¶ï¼Œåˆ™é˜Ÿåˆ—çš„é•¿åº¦æ²¡æœ‰é™åˆ¶ã€‚

```
import queue
q = queue.Queue()  # åˆ›å»º Queue é˜Ÿåˆ—
for i in range(3):
    q.put(i)  # åœ¨é˜Ÿåˆ—ä¸­ä¾æ¬¡æ’å…¥0ã€1ã€2å…ƒç´ 
for i in range(3):
    print(q.get())  # ä¾æ¬¡ä»é˜Ÿåˆ—ä¸­å–å‡ºæ’å…¥çš„å…ƒç´ ï¼Œæ•°æ®å…ƒç´ è¾“å‡ºé¡ºåºä¸º0ã€1ã€2

[huawei@n161 ccc]$ python3 1.py
0
1
2
```

æ–¹æ³•ï¼š
- Queue.qsize â€”è¿”å›é˜Ÿåˆ—å¤§å°
- Queue.empty â€”åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º
- Queue.full â€”åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦æ»¡äº†
- Queue.get(block=True, timeout=None) ä»é˜Ÿåˆ—ä¸­å–å‡ºæ•°æ®å¹¶è¿”å›è¯¥æ•°æ®å†…å®¹ã€‚
    - blockï¼Œå½“é˜Ÿåˆ—ä¸­æ²¡æœ‰æ•°æ®å…ƒç´ ç»§ç»­å–æ•°æ®æ—¶ï¼šå¦‚æœ block=Falseï¼Œç›´æ¥å¼•å‘ queue.Empty å¼‚å¸¸ï¼›å¦‚æœ block=Trueï¼Œä¸” timeout=Noneï¼Œåˆ™ä¸€ç›´ç­‰å¾…ç›´åˆ°æœ‰æ•°æ®å…¥é˜Ÿåˆ—åå¯ä»¥å–å‡ºæ•°æ®ï¼›å¦‚æœ block=Trueï¼Œä¸” timeout=Nï¼ŒN ä¸ºæŸä¸€æ­£æ•´æ•°æ—¶ï¼Œåˆ™ç­‰å¾… N ç§’ï¼Œå¦‚æœé˜Ÿåˆ—ä¸­è¿˜æ²¡æœ‰æ•°æ®æ”¾å…¥çš„è¯å°±å¼•å‘ queue.Empty å¼‚å¸¸ã€‚
    - timeoutï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ã€‚
- Queue.get_nowait() ç›¸å½“äº Queue.get(block=False)blockï¼Œå½“é˜Ÿåˆ—ä¸­æ²¡æœ‰æ•°æ®å…ƒç´ ç»§ç»­å–æ•°æ®æ—¶ç›´æ¥å¼•å‘ queue.Empty å¼‚å¸¸ã€‚
- Queue.task_done è¡¨ç¤ºé˜Ÿåˆ—å†…çš„æ•°æ®å…ƒç´ å·²ç»è¢«å–å‡ºï¼Œå³æ¯ä¸ª get ç”¨äºè·å–ä¸€ä¸ªæ•°æ®å…ƒç´ ï¼Œ åç»­è°ƒç”¨ task_done å‘Šè¯‰é˜Ÿåˆ—ï¼Œè¯¥æ•°æ®çš„å¤„ç†å·²ç»å®Œæˆã€‚å¦‚æœè¢«è°ƒç”¨çš„æ¬¡æ•°å¤šäºæ”¾å…¥é˜Ÿåˆ—ä¸­çš„å…ƒç´ ä¸ªæ•°ï¼Œå°†å¼•å‘ ValueError å¼‚å¸¸ã€‚
- Queue.put(item, block=True, timeout=None)   
    - itemï¼Œæ”¾å…¥é˜Ÿåˆ—ä¸­çš„æ•°æ®å…ƒç´ ã€‚
    - blockï¼Œå½“é˜Ÿåˆ—ä¸­å…ƒç´ ä¸ªæ•°è¾¾åˆ°ä¸Šé™ç»§ç»­å¾€é‡Œæ”¾æ•°æ®æ—¶ï¼šå¦‚æœ block=Falseï¼Œç›´æ¥å¼•å‘ queue.Full å¼‚å¸¸ï¼›å¦‚æœ block=Trueï¼Œä¸” timeout=Noneï¼Œåˆ™ä¸€ç›´ç­‰å¾…ç›´åˆ°æœ‰æ•°æ®å‡ºé˜Ÿåˆ—åå¯ä»¥æ”¾å…¥æ•°æ®ï¼›å¦‚æœ block=Trueï¼Œä¸” timeout=Nï¼ŒN ä¸ºæŸä¸€æ­£æ•´æ•°æ—¶ï¼Œåˆ™ç­‰å¾… N ç§’ï¼Œå¦‚æœé˜Ÿåˆ—ä¸­è¿˜æ²¡æœ‰ä½ç½®æ”¾å…¥æ•°æ®å°±å¼•å‘ queue.Full å¼‚å¸¸ã€‚
    - timeoutï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ã€‚
- Queue.put_nowait(item) ç›¸å½“äº Queue.put(item, block=False)ï¼Œå½“é˜Ÿåˆ—ä¸­å…ƒç´ ä¸ªæ•°è¾¾åˆ°ä¸Šé™ç»§ç»­å¾€é‡Œæ”¾æ•°æ®æ—¶ç›´æ¥å¼•å‘ queue.Full å¼‚å¸¸ã€‚
- Queue.join ä¸€ç›´é˜»å¡ç›´åˆ°é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰æ•°æ®å…ƒç´ éƒ½è¢«å–å‡ºå’Œæ‰§è¡Œï¼Œåªè¦æœ‰å…ƒç´ æ·»åŠ åˆ° queue ä¸­å°±ä¼šå¢åŠ ã€‚å½“æœªå®Œæˆä»»åŠ¡çš„è®¡æ•°ç­‰äº0ï¼Œjoin å°±ä¸ä¼šé˜»å¡ã€‚

æ¡ˆä¾‹ï¼šç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çº¿ç¨‹åˆ†åˆ«ç”Ÿäº§æ•°æ®å’Œæ¶ˆè´¹æ•°æ®ï¼Œå…ˆç”Ÿäº§åæ¶ˆè´¹ã€‚é‡‡ç”¨ task_done å’Œ join ç¡®ä¿å¤„ç†ä¿¡æ¯åœ¨å¤šä¸ªçº¿ç¨‹é—´å®‰å…¨äº¤æ¢ï¼Œç”Ÿäº§è€…ç”Ÿäº§çš„æ•°æ®èƒ½å¤Ÿå…¨éƒ¨è¢«æ¶ˆè´¹è€…æ¶ˆè´¹æ‰ã€‚
å¦è§æ¡ˆä¾‹[å®ˆæŠ¤çº¿ç¨‹](#å®ˆæŠ¤çº¿ç¨‹)ä¹Ÿæ¼”ç¤ºäº†ç”Ÿäº§è€…æ¶ˆè´¹è€…ï¼Œå¦å¤–[è¿›ç¨‹é—´é€šä¿¡](#è¿›ç¨‹é—´é€šä¿¡)ä¹Ÿæœ‰ä½¿ç”¨
```
from queue import Queue
import random
import threading
import time

#ç”Ÿäº§è€…çº¿ç¨‹
class Producer(threading.Thread):
    def __init__(self, t_name, queue):
        threading.Thread.__init__(self, name=t_name)
        self.data=queue
    def run(self):
        for i in range(5):
            print ("%s: %s is ç”Ÿäº§ %d to the queue!" %(time.ctime(), self.getName(), i))
            self.data.put(i)  # å°†ç”Ÿäº§çš„æ•°æ®æ”¾å…¥é˜Ÿåˆ—
            time.sleep(random.randrange(10)/5)
        print ("%s: %s finished!" %(time.ctime(), self.getName()))

#æ¶ˆè´¹è€…çº¿ç¨‹
class Consumer(threading.Thread):
    def __init__(self, t_name, queue):
        threading.Thread.__init__(self, name=t_name)
        self.data=queue
    def run(self):
        for i in range(5):
            val = self.data.get()  # æ‹¿å‡ºå·²ç»ç”Ÿäº§å¥½çš„æ•°æ®
            print ("%s: %s is æ¶ˆè´¹. %d in the queue is consumed!" %(time.ctime(), self.getName(), val))
            time.sleep(random.randrange(5))
            self.data.task_done() # å‘Šè¯‰é˜Ÿåˆ—æœ‰å…³è¿™ä¸ªæ•°æ®çš„ä»»åŠ¡å·²ç»å¤„ç†å®Œæˆ
        print ("%s: %s finished!" %(time.ctime(), self.getName()))

#ä¸»çº¿ç¨‹
def main():
    queue = Queue()
    producer = Producer('ç”Ÿäº§è€….', queue)
    consumer = Consumer('æ¶ˆè´¹è€….', queue)
    producer.start()
    consumer.start()
    queue.join()  # é˜»å¡ï¼Œç›´åˆ°ç”Ÿäº§è€…ç”Ÿäº§çš„æ•°æ®å…¨éƒ½è¢«æ¶ˆè´¹æ‰
    producer.join() # ç­‰å¾…ç”Ÿäº§è€…çº¿ç¨‹ç»“æŸ
    consumer.join() # ç­‰å¾…æ¶ˆè´¹è€…çº¿ç¨‹ç»“æŸ
    print ('All threads terminate!')
 
if __name__ == '__main__':
    main()

[huawei@n161 ccc]$ python3 1.py
Wed Oct 12 14:20:05 2022: ç”Ÿäº§è€…. is ç”Ÿäº§ 0 to the queue!
Wed Oct 12 14:20:05 2022: æ¶ˆè´¹è€…. is æ¶ˆè´¹. 0 in the queue is consumed!
Wed Oct 12 14:20:06 2022: ç”Ÿäº§è€…. is ç”Ÿäº§ 1 to the queue!
Wed Oct 12 14:20:08 2022: ç”Ÿäº§è€…. is ç”Ÿäº§ 2 to the queue!
Wed Oct 12 14:20:09 2022: ç”Ÿäº§è€…. is ç”Ÿäº§ 3 to the queue!
Wed Oct 12 14:20:09 2022: æ¶ˆè´¹è€…. is æ¶ˆè´¹. 1 in the queue is consumed!
Wed Oct 12 14:20:09 2022: æ¶ˆè´¹è€…. is æ¶ˆè´¹. 2 in the queue is consumed!
Wed Oct 12 14:20:09 2022: ç”Ÿäº§è€…. is ç”Ÿäº§ 4 to the queue!
Wed Oct 12 14:20:09 2022: ç”Ÿäº§è€…. finished!
Wed Oct 12 14:20:12 2022: æ¶ˆè´¹è€…. is æ¶ˆè´¹. 3 in the queue is consumed!
Wed Oct 12 14:20:14 2022: æ¶ˆè´¹è€…. is æ¶ˆè´¹. 4 in the queue is consumed!
Wed Oct 12 14:20:18 2022: æ¶ˆè´¹è€…. finished!
All threads terminate!

```



## LifoQueue æ ˆ

queue.LifoQueue(maxsize=0)  å…¥å‚ maxsize ä¸å…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—çš„å®šä¹‰ä¸€æ ·ã€‚

```
import queue
q = queue.LifoQueue()  # åˆ›å»º LifoQueue é˜Ÿåˆ—
for i in range(3):
    q.put(i)  # åœ¨é˜Ÿåˆ—ä¸­ä¾æ¬¡æ’å…¥0ã€1ã€2å…ƒç´ 
for i in range(3):
    print(q.get())  # ä¾æ¬¡ä»é˜Ÿåˆ—ä¸­å–å‡ºæ’å…¥çš„å…ƒç´ ï¼Œæ•°æ®å…ƒç´ è¾“å‡ºé¡ºåºä¸º2ã€1ã€0

[huawei@n161 ccc]$ python3 1.py
2
1
0

```

## PriorityQueue ä¼˜å…ˆé˜Ÿåˆ—

PriorityQueue(maxsize=0) å…¥å‚ maxsize ä¸å…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—çš„å®šä¹‰ä¸€æ ·ã€‚

ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œæ¯”è¾ƒé˜Ÿåˆ—ä¸­æ¯ä¸ªæ•°æ®çš„å¤§å°ï¼Œå€¼æœ€å°çš„æ•°æ®æ‹¥æœ‰å‡ºé˜Ÿåˆ—çš„ä¼˜å…ˆæƒã€‚æ•°æ®ä¸€èˆ¬ä»¥å…ƒç»„çš„å½¢å¼æ’å…¥ï¼Œå…¸å‹å½¢å¼ä¸º(priority_number, data)ã€‚å¦‚æœé˜Ÿåˆ—ä¸­çš„æ•°æ®æ²¡æœ‰å¯æ¯”æ€§ï¼Œé‚£ä¹ˆæ•°æ®å°†è¢«åŒ…è£…åœ¨ä¸€ä¸ªç±»ä¸­ï¼Œå¿½ç•¥æ•°æ®å€¼ï¼Œä»…ä»…æ¯”è¾ƒä¼˜å…ˆçº§æ•°å­—ã€‚

```
import queue
q = queue.PriorityQueue()  # åˆ›å»º PriorityQueue é˜Ÿåˆ—
data1 = (1, 'python')
data2 = (2, '-')
data3 = (3, '100')
style = (data2, data3, data1)
for i in style:
    q.put(i)  # åœ¨é˜Ÿåˆ—ä¸­ä¾æ¬¡æ’å…¥å…ƒç´  data2ã€data3ã€data1
for i in range(3):
    print(q.get())  # ä¾æ¬¡ä»é˜Ÿåˆ—ä¸­å–å‡ºæ’å…¥çš„å…ƒç´ ï¼Œæ•°æ®å…ƒç´ è¾“å‡ºé¡ºåºä¸º data1ã€data2ã€data3

[huawei@n161 ccc]$ python3 1.py
(1, 'python')
(2, '-')
(3, '100')
```

## SimpleQueue ä½é…é˜Ÿåˆ—

SimpleQueue æ˜¯ Python 3.7 ç‰ˆæœ¬ä¸­æ–°åŠ å…¥çš„ç‰¹æ€§ï¼Œä¸ Queueã€LifoQueue å’Œ PriorityQueue ä¸‰ç§é˜Ÿåˆ—ç›¸æ¯”ç¼ºå°‘äº† task_done å’Œ join çš„é«˜çº§ä½¿ç”¨æ–¹æ³•ï¼Œæ‰€ä»¥æ‰ä¼šå–åå« Simple äº†

## namedtuple å…·åå…ƒç¥–
- å‘½åå…ƒç»„æ˜¯å…ƒç»„çš„å­ç±»ï¼Œæ—¢å¯ä»¥é€šè¿‡åç§°ï¼ˆä½¿ç”¨ .nameï¼‰æ¥è®¿é—®å…¶ä¸­çš„å€¼ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä½ç½®è¿›è¡Œè®¿é—®ï¼ˆä½¿ç”¨[offset]ï¼‰
- å®ƒæ— è®ºçœ‹èµ·æ¥è¿˜æ˜¯ä½¿ç”¨èµ·æ¥éƒ½å’Œä¸å¯å˜å¯¹è±¡éå¸¸ç›¸ä¼¼
- å…·åå…ƒç»„çš„å®ä¾‹ä¹Ÿå¾ˆèŠ‚çœç©ºé—´ï¼Œä¸ä½¿ç”¨å¯¹è±¡ç›¸æ¯”ï¼Œä½¿ç”¨å‘½åå…ƒç»„åœ¨æ—¶é—´å’Œç©ºé—´ä¸Šæ•ˆç‡æ›´é«˜ã€‚
- å¯ä»¥ä½¿ç”¨ç‚¹å·ï¼ˆ.ï¼‰å¯¹ç‰¹æ€§è¿›è¡Œè®¿é—®ï¼Œè€Œä¸éœ€è¦ä½¿ç”¨å­—å…¸é£æ ¼çš„æ–¹æ‹¬å·
- å¯ä»¥æŠŠå®ƒä½œä¸ºå­—å…¸çš„é”®
- ç”¨ä»¥æ„å»ºåªæœ‰å°‘æ•°å±æ€§ä½†æ˜¯æ²¡æœ‰æ–¹æ³•çš„å¯¹è±¡

ç®€å•ä½¿ç”¨
```
from collections import namedtuple
Duck = namedtuple('Duck', 'bill tail')
duck = Duck('wide orange', 'long')
print(duck)
print(duck.bill)
print(duck.tail)

parts = {'bill': 'wide orange', 'tail': 'long'} # ç”¨å­—å…¸æ¥æ„é€ å‘½åå…ƒç»„
duck2 = Duck(**parts) # **ä½œç”¨æ˜¯å°† parts å­—å…¸ä¸­çš„é”®å’Œå€¼æŠ½å–å‡ºæ¥ä½œä¸ºå‚æ•°æä¾›ç»™ Duck() ä½¿ç”¨ã€‚ç­‰åŒäº duck2 = Duck(bill = 'wide orange', tail = 'long')
print(duck2)
duck3 = duck2._replace(tail='magnificent', bill='crushing')	# å‘½åå…ƒç»„æ˜¯ä¸å¯å˜çš„ï¼Œä½†å¯ä»¥æ›¿æ¢å…¶ä¸­æŸäº›åŸŸçš„å€¼å¹¶è¿”å›ä¸€ä¸ªæ–°çš„å‘½åå…ƒç»„
print(duck3)


duck_dict = {'bill': 'wide orange', 'tail': 'long'}
print(duck_dict)
duck_dict['color'] = 'green'	# å¯ä»¥å‘å­—å…¸é‡Œæ·»åŠ æ–°çš„é”®å€¼å¯¹
print(duck_dict)

duck.color = 'green'	# err ä½†æ— æ³•å¯¹å‘½åå…ƒç»„è¿™ä¹ˆåš

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/aaa/pyth.py"
Duck(bill='wide orange', tail='long')
wide orange
long
Duck(bill='wide orange', tail='long')
Duck(bill='crushing', tail='magnificent')
{'bill': 'wide orange', 'tail': 'long'}
{'bill': 'wide orange', 'tail': 'long', 'color': 'green'}
Traceback (most recent call last):
  File "/home/huawei/hwwork/doc/md/aaa/pyth.py", line 22, in <module>
    duck.color = 'green'        # ä½†æ— æ³•å¯¹å‘½åå…ƒç»„è¿™ä¹ˆåš
AttributeError: 'Duck' object has no attribute 'color'
```


é«˜çº§ä½¿ç”¨ï¼Œç±»ä¼¼structï¼Œå¯ä»¥å¿«é€Ÿå®šä¹‰ç»“æ„å¹¶åˆ›å»ºå˜é‡ï¼Œä½†ä»…æœ‰å±æ€§ä¸èƒ½æœ‰æ–¹æ³•
- _fields
- _make()
- _asdict()

```
from collections import namedtuple
City = namedtuple('City', 'name country population coordinates')	# å‚æ•°æ˜¯ç±»åï¼Œå¦ä¸€ä¸ªæ˜¯ç±»çš„å„ä¸ªå­—æ®µçš„åå­—
tokyo = City('Tokyo', 'JP', 36.933, (35.689722, 139.691667))	# åˆ›å»ºå¯¹è±¡
print(tokyo)	# è®¿é—®
print(tokyo.population)
print(tokyo.coordinates)
print(tokyo[1])
print(City._fields)	# _fields å±æ€§æ˜¯ä¸€ä¸ªåŒ…å«è¿™ä¸ªç±»æ‰€æœ‰å­—æ®µåç§°çš„å…ƒç»„ã€‚


LatLong = namedtuple('LatLong', 'lat long')
delhi_data = ('Delhi NCR', 'IN', 21.935, LatLong(28.613889, 77.208889))
delhi = City._make(delhi_data)	# ç”¨_make()é€šè¿‡æ¥å—ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡æ¥ç”Ÿæˆè¿™ä¸ªç±»çš„ä¸€ä¸ªå®ä¾‹ï¼Œå®ƒçš„ä½œç”¨è·ŸCity(*delhi_data)æ˜¯ä¸€æ ·çš„

print(delhi._asdict())	#_asdict()æŠŠå…·åå…ƒç»„ä»¥collections.OrderedDictçš„å½¢å¼è¿”å›ï¼Œä¸‹é¢æ˜¯è¿­ä»£æ¯ä¸€é¡¹
for key, value in delhi._asdict().items():
	print(key + ':', value)



[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/bbb/src/pyth.py"
City(name='Tokyo', country='JP', population=36.933, coordinates=(35.689722, 139.691667))
36.933
(35.689722, 139.691667)
JP
('name', 'country', 'population', 'coordinates')
OrderedDict([('name', 'Delhi NCR'), ('country', 'IN'), ('population', 21.935), ('coordinates', LatLong(lat=28.613889, long=77.208889))])
name: Delhi NCR
country: IN
population: 21.935
coordinates: LatLong(lat=28.613889, long=77.208889)
```
## ChainMap 

ChainMap() å¯ä»¥å°†å¤šä¸ªå­—å…¸é›†åˆåˆ°ä¸€ä¸ªå­—å…¸ä¸­å»ï¼Œå¯¹å¤–æä¾›ä¸€ä¸ªç»Ÿä¸€çš„è§†å›¾ã€‚æ³¨æ„ï¼šè¯¥æ“ä½œå¹¶æ˜¯ä¸å°†æ‰€æœ‰å­—å…¸åšäº†ä¸€æ¬¡æ‹·è´ï¼Œå®é™…ä¸Šæ˜¯åœ¨å¤šä¸ªå­—å…¸çš„ä¸Šå±‚åˆè¿›è¡Œäº†ä¸€æ¬¡å°è£…è€Œå·²ã€‚

```
from collections import ChainMap

user1 = {"name":"admin", "age":"20"}
user2 = {"name":"root", "weight": 65}
users = ChainMap(user1, user2)
print(users.maps)

users.maps[0]["name"] = "tiger"
print(users.maps)

for key, value in users.items():
    print(key, value)

[huawei@n161 ccc]$ python3 1.py
[{'name': 'admin', 'age': '20'}, {'name': 'root', 'weight': 65}]
[{'name': 'tiger', 'age': '20'}, {'name': 'root', 'weight': 65}]
age 20
weight 65
name tiger
```
å¦‚æœ ChainMap() ä¸­çš„å¤šä¸ªå­—å…¸æœ‰é‡å¤ keyï¼ŒæŸ¥çœ‹çš„æ—¶å€™å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„ keyï¼Œä½†éå†çš„æ—¶å€™å´åªä¼šéå† key ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå…¶ä½™çš„å¿½ç•¥ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿”å›çš„æ–°çš„è§†å›¾æ¥æ›´æ–°åŸæ¥çš„çš„å­—å…¸æ•°æ®ã€‚è¿›ä¸€æ­¥éªŒè¯äº†è¯¥æ“ä½œä¸æ˜¯åšçš„æ‹·è´ï¼Œè€Œæ˜¯ç›´æ¥æŒ‡å‘åŸå­—å…¸ã€‚


## deque åŒå‘é˜Ÿåˆ—
dqueue æ˜¯ â€double-ended queueâ€ çš„ç®€ç§°ï¼Œæ˜¯ä¸€ç§ç±»ä¼¼åˆ—è¡¨(list)çš„å®¹å™¨ï¼Œå®ç°äº†åœ¨ä¸¤ç«¯å¿«é€Ÿæ·»åŠ (append)å’Œå¼¹å‡º(pop)æ“ä½œã€‚åœ¨ä¸­é—´æŸ¥æ‰¾çš„é€Ÿåº¦è¾ƒæ…¢ã€‚ æ­¤ç§å¯¹è±¡é€‚ç”¨äºå®ç°é˜Ÿåˆ—å’Œå¹¿åº¦ä¼˜å…ˆæ ‘æœç´¢

- æ˜¯ä¸€ä¸ªçº¿ç¨‹å®‰å…¨ã€å¯ä»¥å¿«é€Ÿä»ä¸¤ç«¯æ·»åŠ æˆ–è€…åˆ é™¤å…ƒç´ çš„æ•°æ®ç±»å‹ã€‚
- ä¸»è¦çš„æ–¹æ³•å‚è§â€œæµç•…çš„python 2.9.4â€

```
from collections import deque
q = deque([1, 2, 3])
q.append('4')
q.appendleft('0')
print(q)
print(q.popleft())

[huawei@n161 ccc]$ python3 1.py
deque(['0', 1, 2, 3, '4'])
0
```
å¦ä¸€ä¸ªæ¡ˆä¾‹
```
from collections import deque
dq = deque(range(10), maxlen=10)	# maxlen æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œä»£è¡¨è¿™ä¸ªé˜Ÿåˆ—å¯ä»¥å®¹çº³çš„å…ƒç´ çš„æ•°é‡ï¼Œè€Œä¸”ä¸€æ—¦è®¾å®šï¼Œè¿™ä¸ªå±æ€§å°±ä¸èƒ½ä¿®æ”¹äº†ã€‚
print(dq)
dq.rotate(3)	# é˜Ÿåˆ—çš„æ—‹è½¬æ“ä½œæ¥å—ä¸€ä¸ªå‚æ•° nï¼Œå½“ n > 0 æ—¶ï¼Œé˜Ÿåˆ—çš„æœ€å³è¾¹çš„ n ä¸ªå…ƒç´ ä¼šè¢«ç§»åŠ¨åˆ°é˜Ÿåˆ—çš„å·¦è¾¹ã€‚å½“ n < 0 æ—¶ï¼Œæœ€å·¦è¾¹çš„ n ä¸ªå…ƒç´ ä¼šè¢«ç§»åŠ¨åˆ°å³è¾¹ã€‚
print(dq)
dq.rotate(-4) 
print(dq)
dq.appendleft(-1)	# å½“è¯•å›¾å¯¹ä¸€ä¸ªå·²æ»¡ï¼ˆlen(d) == d.maxlenï¼‰çš„é˜Ÿåˆ—åšå¤´éƒ¨æ·»åŠ æ“ä½œçš„æ—¶å€™ï¼Œå®ƒå°¾éƒ¨çš„å…ƒç´ ä¼šè¢«åˆ é™¤æ‰ã€‚æ³¨æ„åœ¨ä¸‹ä¸€è¡Œé‡Œï¼Œå…ƒç´  0 è¢«åˆ é™¤äº†ã€‚
print(dq)
dq.extend([11, 22, 33])	# åœ¨å°¾éƒ¨æ·»åŠ  3 ä¸ªå…ƒç´ çš„æ“ä½œä¼šæŒ¤æ‰ -1ã€1 å’Œ 2ã€‚
print(dq)
dq.extendleft([10, 20, 30, 40])	# extendleft(iter) æ–¹æ³•ä¼šæŠŠè¿­ä»£å™¨é‡Œçš„å…ƒç´ é€ä¸ªæ·»åŠ åˆ°åŒå‘é˜Ÿåˆ—çš„å·¦è¾¹ï¼Œå› æ­¤è¿­ä»£å™¨é‡Œçš„å…ƒç´ ä¼šé€†åºå‡ºç°åœ¨é˜Ÿåˆ—é‡Œã€‚
print(dq)

[huawei@n148 doc]$ /usr/bin/python3 "/home/huawei/hwwork/doc/md/bbb/src/pyth.py"
deque([0, 1, 2, 3, 4, 5, 6, 7, 8, 9], maxlen=10)
deque([7, 8, 9, 0, 1, 2, 3, 4, 5, 6], maxlen=10)
deque([1, 2, 3, 4, 5, 6, 7, 8, 9, 0], maxlen=10)
deque([-1, 1, 2, 3, 4, 5, 6, 7, 8, 9], maxlen=10)
deque([3, 4, 5, 6, 7, 8, 9, 11, 22, 33], maxlen=10)
deque([40, 30, 20, 10, 3, 4, 5, 6, 7, 8], maxlen=10)
``` 
## Counter ç»Ÿè®¡é‡å¤ä¸ªæ•°

Counter å¯ä»¥ç®€å•ç†è§£ä¸ºä¸€ä¸ªè®¡æ•°å™¨ï¼Œå¯ä»¥ç»Ÿè®¡æ¯ä¸ªå…ƒç´ å‡ºç°çš„æ¬¡æ•°ï¼ŒåŒæ · Counter() æ˜¯éœ€è¦æ¥å—ä¸€ä¸ªå¯è¿­ä»£çš„å¯¹è±¡çš„ã€‚å…¶å®ä¸€ä¸ª Counter å°±æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œå…¶é¢å¤–æä¾›çš„ most_common() å‡½æ•°é€šå¸¸ç”¨äºæ±‚ Top k é—®é¢˜ã€‚

å¦å¤–è¿˜æœ‰ç»Ÿè®¡æ–‡ä»¶ç±»å‹çš„æ¡ˆä¾‹ï¼Œè§[æ–‡ä»¶ç»Ÿè®¡ä»¥åŠåŒ¹é…æŸ¥æ‰¾](#æ–‡ä»¶ç»Ÿè®¡ä»¥åŠåŒ¹é…æŸ¥æ‰¾)
```
from collections import Counter

animals = ["cat", "dog", "cat", "bird", "horse", "tiger", "horse", "cat"]
animals_counter = Counter(animals)
print(animals_counter)
print(animals_counter.most_common(2))

[huawei@n161 ccc]$ python3 1.py
Counter({'cat': 3, 'horse': 2, 'dog': 1, 'bird': 1, 'tiger': 1})
[('cat', 3), ('horse', 2)]
```

## OrderedDict

OrderedDict æ˜¯å­—å…¸çš„å­ç±»ï¼Œä¿è¯äº†å…ƒç´ çš„æ’å…¥é¡ºåºã€‚åœ¨ 3.7 ç‰ˆæœ¬ä¸‹ï¼Œå­—å…¸åŒæ ·ä¹Ÿä¿è¯äº†å…ƒç´ çš„æ’å…¥é¡ºåºã€‚é‚£ç›¸æ¯”å†…ç½®å­—å…¸ OrderedDict æœ‰å“ªäº›å‡çº§å‘¢ã€‚
- ç®—æ³•ä¸Šï¼Œ OrderedDict å¯ä»¥æ¯” dict æ›´å¥½åœ°å¤„ç†é¢‘ç¹çš„é‡æ–°æ’åºæ“ä½œã€‚åœ¨è·Ÿè¸ªæœ€è¿‘çš„è®¿é—®è¿™ç§åœºæ™¯ï¼ˆä¾‹å¦‚åœ¨ LRU cacheï¼‰ä¸‹éå¸¸é€‚ç”¨ã€‚
- OrderedDict ç±»æœ‰ä¸€ä¸ª move_to_end() æ–¹æ³•ï¼Œå¯ä»¥æœ‰æ•ˆåœ°å°†å…ƒç´ ç§»åŠ¨åˆ°ä»»ä¸€ç«¯ã€‚

```
from collections import OrderedDict

user = OrderedDict()
user["name"] = "admin"
user["age"] = 23
user["weight"] = 65
print(user)
user.move_to_end("name") # å°†å…ƒç´ ç§»åŠ¨è‡³æœ«å°¾
print(user)
user.move_to_end("name", last = False) # å°†å…ƒç´ ç§»åŠ¨è‡³å¼€å¤´
print(user)

[huawei@n161 ccc]$ python3 1.py
OrderedDict([('name', 'admin'), ('age', 23), ('weight', 65)])
OrderedDict([('age', 23), ('weight', 65), ('name', 'admin')])
OrderedDict([('name', 'admin'), ('age', 23), ('weight', 65)])
```

## defaultdict 

defaultdict æ˜¯å†…ç½® dict ç±»çš„å­ç±»ã€‚å®ƒå®ç°äº†å½“ key ä¸å­˜åœ¨æ˜¯è¿”å›é»˜è®¤å€¼çš„åŠŸèƒ½ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œä¸å†…ç½® dict åŠŸèƒ½å®Œå…¨ä¸€æ ·ã€‚
```
from collections import defaultdict

default_dict = defaultdict(int)
default_dict["x"] = 10
print(default_dict["x"])
print(default_dict["y"])

[huawei@n161 ccc]$ python3 1.py
10
0   
```

# ç½‘ç»œé€šä¿¡
## urllib.request

# SQLite
SQLite æ˜¯ä¸€ç§è½»å‹åµŒå…¥å¼å…³ç³»å‹æ•°æ®åº“ï¼Œå®ƒåŒ…å«åœ¨ä¸€ä¸ªç›¸å¯¹å°çš„ C åº“ä¸­ã€‚SQLite å ç”¨èµ„æºä½ï¼Œå¤„ç†é€Ÿåº¦å¿«ï¼Œå®ƒæ”¯æŒ Windowsã€Linuxã€Unix ç­‰å¤šç§ä¸»æµæ“ä½œç³»ç»Ÿï¼Œæ”¯æŒ Pythonã€Javaã€C# ç­‰å¤šç§è¯­è¨€ï¼Œç›®å‰çš„ç‰ˆæœ¬å·²ç»å‘å±•åˆ°äº† SQLite3ã€‚

SQLite æ˜¯ä¸€ä¸ªè¿›ç¨‹å†…çš„åº“ï¼Œå®ƒå®ç°äº†è‡ªç»™è‡ªè¶³ã€æ— æœåŠ¡å™¨ã€æ— éœ€é…ç½®ã€æ”¯æŒäº‹åŠ¡ã€‚Python å¯ä»¥é€šè¿‡ sqlite3 æ¨¡å—ä¸ SQLite3 é›†æˆï¼ŒPython 2.5.x ä»¥ä¸Šç‰ˆæœ¬å†…ç½®äº† sqlite3 æ¨¡å—ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬åœ¨ Python ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨ SQLiteã€‚

æ•°æ®ç±»å‹ä¸å¸¸ç”¨å‡½æ•°è¯¦è§ http://www.ityouknow.com/python/2019/12/03/python-SQLite-077.html
```
# å¯¼å…¥æ¨¡å—
import sqlite3
import os

def create():
    # è¿æ¥æ•°æ®åº“
    conn = sqlite3.connect('test.db')
    # åˆ›å»ºæ¸¸æ ‡
    cs = conn.cursor()
    # åˆ›å»ºè¡¨
    cs.execute("CREATE TABLE student (id varchar(20) PRIMARY KEY, name varchar(20));")
    cs.execute("INSERT INTO student (id, name) VALUES ('1', 'Jhon')")
    cs.execute("INSERT INTO student (id, name) VALUES ('2', 'Alan')")
    cs.execute("INSERT INTO student (id, name) VALUES ('3', 'Bob')")

    # å…³é—­ Cursor
    cs.close()
    # æäº¤å½“å‰äº‹åŠ¡
    conn.commit()
    # å…³é—­è¿æ¥
    conn.close()

def show():
    # è¿æ¥æ•°æ®åº“
    conn = sqlite3.connect('test.db')
    # åˆ›å»ºæ¸¸æ ‡
    cs = conn.cursor()
    # æŸ¥è¯¢æ•°æ®
    cs.execute("SELECT id, name FROM student")
    # è·å–æŸ¥è¯¢ç»“æœé›†ä¸­çš„ä¸‹ä¸€è¡Œ
    print('fetchone-->', cs.fetchone())
    # è·å–æŸ¥è¯¢ç»“æœé›†ä¸­çš„ä¸‹ä¸€è¡Œç»„
    print('fetchmany-->', cs.fetchmany())
    # è·å–æŸ¥è¯¢ç»“æœé›†ä¸­æ‰€æœ‰ï¼ˆå‰©ä½™ï¼‰çš„è¡Œ
    print('fetchall-->', cs.fetchall())
    cs.close()
    conn.close()

def update():
    # è¿æ¥æ•°æ®åº“
    conn = sqlite3.connect('test.db')
    # åˆ›å»ºæ¸¸æ ‡
    cs = conn.cursor()
    # ä¿®æ”¹æ•°æ®
    cs.execute("SELECT id, name FROM student WHERE id = '1'")
    print('ä¿®æ”¹å‰-->', cs.fetchall())
    cs.execute("UPDATE student set name = 'Nicolas' WHERE id = '1'")
    cs.execute("SELECT id, name FROM student WHERE id = '1'")
    print('ä¿®æ”¹å-->', cs.fetchall())
    conn.commit()
    cs.close()
    conn.close()

def remove():
    # è¿æ¥æ•°æ®åº“
    conn = sqlite3.connect('test.db')
    # åˆ›å»ºæ¸¸æ ‡
    cs = conn.cursor()
    # åˆ é™¤
    cs.execute("SELECT id, name FROM student")
    print('åˆ é™¤å‰-->', cs.fetchall())
    cs.execute("DELETE FROM student WHERE id = '1'")
    cs.execute("SELECT id, name FROM student")
    print('åˆ é™¤å-->', cs.fetchall())
    conn.commit()
    cs.close()
    conn.close()

if __name__ == "__main__":
    create()
    show()
    update()
    show()
    remove()
    os.remove('test.db');

[huawei@n161 ccc]$ python3 1.py
fetchone--> ('1', 'Jhon')
fetchmany--> [('2', 'Alan')]
fetchall--> [('3', 'Bob')]
ä¿®æ”¹å‰--> [('1', 'Jhon')]
ä¿®æ”¹å--> [('1', 'Nicolas')]
fetchone--> ('1', 'Nicolas')
fetchmany--> [('2', 'Alan')]
fetchall--> [('3', 'Bob')]
åˆ é™¤å‰--> [('1', 'Nicolas'), ('2', 'Alan'), ('3', 'Bob')]
åˆ é™¤å--> [('2', 'Alan'), ('3', 'Bob')]
```
# åˆ é™¤ã€å®‰è£…pythonä¸pip
## åˆ é™¤ç°æœ‰çš„python

æ³¨æ„ä¸‹é¢ä¼šåˆ é™¤æ‰€æœ‰ç‰ˆæœ¬çš„pythonã€‚ã€‚ã€‚                

```
#å¼ºåˆ¶æ¸…é™¤å·²å®‰è£…çš„ç¨‹åºåŠå…¶å…³è”
sudo rpm -qa|grep python|sudo xargs rpm -e --allmatches --nodeps

#åˆ é™¤æ‰€æœ‰æ®‹ä½™æ–‡,xargsï¼Œå…è®¸ä½ å¯¹è¾“å‡ºæ‰§è¡Œå…¶ä»–æŸäº›å‘½ä»¤
sudo whereis python |sudo xargs rm -frv


#éªŒè¯åˆ é™¤ï¼Œè¿”å›æ— ç»“æœè¯´æ˜æ¸…é™¤å¹²å‡€
whereis python
```

```
yum install gcc patch libffi-devel python-devel zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel -y

ä¸‹è½½æºä»£ç è‡ªå·±ç¼–è¯‘
wget https://www.python.org/ftp/python/3.7.10/Python-3.7.10.tgz
tar -zxvf Python-3.7.10.tgz
cd Python-3.7.10
mkdir /usr/local/python3
./configure --prefix=/usr/local/python3
make && make install
ln -s /usr/local/python3/bin/python3.7 /usr/bin/python3
ln -s /usr/local/python3/bin/pip3.7 /usr/bin/pip3

å®šä¹‰å‘½ä»¤åˆ«å
$ sudo vi ~/.bashrc
åŠ å…¥ alias python='/usr/bin/python3'
åŠ å…¥ alias pip=pip3
. ~/.bashrc

æª¢æŸ¥Python3ç‰ˆæœ¬
python -V
python -m pip -V

å‡çº§pip
python -m pip install -i https://pypi.tuna.tsinghua.edu.cn/simple --upgrade pip
æ”¹pipä¸ºå›½å†…æº
pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple
```

## pipç®€ä»‹


- pip æä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½ï¼Œå…¶ç«äº‰å¯¹æ‰‹easy_installåˆ™åªæ”¯æŒå®‰è£…ï¼Œæ²¡æœ‰æä¾›å¸è½½å’Œæ˜¾ç¤ºå·²å®‰è£…åˆ—è¡¨çš„åŠŸèƒ½ï¼›
- pipèƒ½å¤Ÿå¾ˆå¥½åœ°æ”¯æŒè™šæ‹Ÿç¯å¢ƒï¼›
- pipå¯ä»¥é€šè¿‡requirements.txté›†ä¸­ç®¡ç†ä¾èµ–ï¼›
- pipèƒ½å¤Ÿå¤„ç†äºŒè¿›åˆ¶æ ¼å¼ï¼ˆ.whl); 
- pipæ˜¯å…ˆä¸‹è½½åå®‰è£…ï¼Œå¦‚æœå®‰è£…å¤±è´¥ï¼Œä¹Ÿä¼šæ¸…ç†å¹²å‡€ï¼Œä¸ä¼šç•™ä¸‹ä¸€ä¸ªä¸­é—´çŠ¶æ€

## pipç¦»çº¿å®‰è£…ç¬¬ä¸‰æ–¹åº“

æ‰¹é‡ä¸‹è½½ç¦»çº¿å®‰è£…è¯¦è§â€œPython Linuxç³»ç»Ÿç®¡ç†ä¸è‡ªåŠ¨åŒ–è¿ç»´â€ 2.2.3

```
1 åœ¨æœ‰ç½‘çš„æœºå™¨ä¸Šä¸‹è½½ï¼Œåœ¨cmdä¸‹è¾“å…¥
pip download åŒ…å

2 åœ¨ç¦»çº¿çš„æœºå™¨ä¸Šå®‰è£…ï¼š
pip install --no-index --find-links=file: â€œåŒ…çš„æ–‡ä»¶åâ€
```

## å®‰è£…pipè‡ªåŠ¨è¡¥å…¨

```
[huawei@n161 mdbooks]$ python3 -m pip completion --bash >> ~/.profile
[huawei@n161 mdbooks]$ . ~/.profile

```

## pipå¸¸ç”¨å‘½ä»¤

```
pip list #æŸ¥çœ‹å®‰è£…çš„åŒ…
```